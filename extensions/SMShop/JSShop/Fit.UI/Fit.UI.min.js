!function(t){if("object"==typeof module&&"object"==typeof module.exports){var e=t();module.exports=e,Object.defineProperty(module.exports,"__esModule",{value:!0})}else if("function"==typeof define&&define.amd)define(["require","exports"],t);else if(window){var n=document.scripts[document.scripts.length-1].src,i=n.indexOf("?");if(i>-1){var o=n.substring(i+1,-1===n.indexOf("&")?n.length:n.indexOf("&"));-1===o.indexOf("=")?window[o]=t():window.Fit=t()}else window.Fit=t()}}(function(){var fitInstance=function(){!function(){if(!window.JSON||!window.NodeList)throw navigator.userAgent.indexOf("MSIE")>-1?new Error("Browser not supported - Internet Explorer 8 or newer is required - make sure Compatibility View is not enabled"):new Error("Browser not supported")}(),function(){window.console||(window.console={});for(var t=["log","debug","info","error","warn","trace"],e=0;e<t.length;e++)console[t[e]]||(console[t[e]]=function(){})}();var Fit={Core:{}};return Fit.Core.Extend=function(t,e){return Fit.Validation.ExpectIsSet(t),Fit.Validation.ExpectFunction(e),{Apply:function(){e.apply(t,arguments),t._internal||(t._internal={}),t._internal.Extends||(t._internal.Extends=[]),Fit.Array.Add(t._internal.Extends,e)}}},Fit.Core.Extends=function(t,e){return Fit.Validation.ExpectIsSet(t),Fit.Validation.ExpectFunction(e),t._internal&&t._internal.Extends&&!0===Fit.Array.Contains(t._internal.Extends,e)},Fit.Core.InstanceOf=function(t,e){return t instanceof e||!0===Fit.Core.Extends(t,e)},Fit.Core.CreateOverride=function(t,e){return Fit.Validation.ExpectFunction(t),Fit.Validation.ExpectFunction(e),function(){var n=window.base;window.base=t;var i=null,o=void 0;try{for(var a=[],r=0;r<arguments.length;r++)a[r]=arguments[r];o=a.length>0?e.apply(this,a):e.apply(this)}catch(t){i=t}if(n)window.base=n;else try{delete window.base}catch(t){window.base=void 0}if(null!==i&&Fit.Validation.ThrowError(i),void 0!==o)return o}},Fit.Core.IsEqual=function(t,e){if(typeof t!=typeof e)return!1;if(void 0===t&&void 0===e||null===t&&null===e)return!0;if("string"==typeof t||"boolean"==typeof t)return t===e;if("number"==typeof t)return!0===isNaN(t)&&!0===isNaN(e)||t===e;if(t instanceof Date&&e instanceof Date)return t.getTime()===e.getTime();if(t instanceof Array&&e instanceof Array){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!1===Fit.Core.IsEqual(t[n],e[n]))return!1;return!0}if("object"==typeof t&&"object"==typeof e&&null!==t&&null!==e){var i=!0,o=Fit.Array.Merge(Fit.Array.GetKeys(t),Fit.Array.GetKeys(e));return Fit.Array.ForEach(o,function(n){if(!1===Fit.Core.IsEqual(t[n],e[n]))return i=!1,!1}),i}return"function"==typeof t&&"function"==typeof e&&t===e},Fit.Core.Clone=function(t){var e=JSON.stringify(t),n=void 0!==e?JSON.parse(e):e,i=null;return n=(i=function(t,e){if(t instanceof Date)return new Date(t.getTime());if("function"==typeof t)return t;if("number"==typeof t&&!0===isNaN(t))return parseInt("");if("number"==typeof t&&t===1/0)return 1/0;if(t&&"object"==typeof t)for(var n in t)e[n]=i(t[n],e[n]);return e})(t,n)},Fit._internal={Core:{VersionInfo:{Major:1,Minor:0,Patch:20}}},Fit._internal.Core.EnsureStyles=function(){if(!0!==Fit._internal.Core.StylesEnsured){Fit._internal.Core.StylesEnsured=!0;var t=Fit.Dom.CreateElement("<div class='FitUiStyleCheck'></div>");Fit.Dom.Add(document.body,t),"20px"!==Fit.Dom.GetComputedStyle(t,"width")&&(Fit.Browser.Log("Lazy loading Fit.UI stylesheet. It is recommended to add a stylesheet reference to Fit.UI.min.css to prevent temporarily unstyled content."),Fit.Loader.LoadStyleSheet(Fit.GetUrl()+"/Fit.UI.min.css")),Fit.Dom.Remove(t)}},function(){var t=document.scripts[document.scripts.length-1].src;t||(t=location.href),Fit._internal.BaseUrl=t.substring(0,t.lastIndexOf("/"));var e=Fit._internal.BaseUrl.replace("http://","").replace("https://","");Fit._internal.BasePath=-1!==e.indexOf("/")?e.substring(e.indexOf("/")):"/"}(),Fit.GetVersion=function(){var t=Fit.Core.Clone(Fit._internal.Core.VersionInfo);return t.Version=t.Major+"."+t.Minor+"."+t.Patch,t},Fit.GetUrl=function(){return void 0!==Fit._internal.BaseUrlOverride?Fit._internal.BaseUrlOverride:Fit._internal.BaseUrl},Fit.GetPath=function(){return void 0!==Fit._internal.BasePathOverride?Fit._internal.BasePathOverride:Fit._internal.BasePath},Fit.SetPath=function(t){if(Fit.Validation.ExpectStringValue(null===t?"-":t),null===t)return delete Fit._internal.BasePathOverride,void delete Fit._internal.BaseUrlOverride;"/"!==t&&t.lastIndexOf("/")===t.length-1&&(t=t.substring(0,t.length-1));var e=location.protocol+"//"+location.host;if(Fit._internal.BasePathOverride=t,"/"===t)Fit._internal.BaseUrlOverride=e;else if(0===t.indexOf("/"))Fit._internal.BaseUrlOverride=e+t;else{var n=location.pathname.substring(0,location.pathname.lastIndexOf("/"));Fit._internal.BaseUrlOverride=e+n+"/"+t}},Fit.Validation={},Fit._internal.Validation={},Fit._internal.Validation.DebugMode=!0,Fit._internal.Validation.Clone=null,Fit.Validation.ExpectObject=function(t,e){(!0!==e||void 0!==t&&null!==t)&&t.constructor!==Object&&Fit.Validation.ThrowError("Value '"+t+"' is not a valid object")},Fit.Validation.ExpectNumber=function(t,e){(!0!==e||void 0!==t&&null!==t)&&("number"==typeof t&&!0!==isNaN(t)||Fit.Validation.ThrowError("Value '"+t+"' is not a valid number"))},Fit.Validation.ExpectInteger=function(t,e){(!0!==e||void 0!==t&&null!==t)&&("number"==typeof t&&t%1==0||Fit.Validation.ThrowError("Value '"+t+"' is not a valid integer"))},Fit.Validation.ExpectString=function(t,e){(!0!==e||void 0!==t&&null!==t)&&"string"!=typeof t&&Fit.Validation.ThrowError("Value '"+t+"' is not a valid string")},Fit.Validation.ExpectStringValue=function(t,e){(!0!==e||void 0!==t&&null!==t)&&(Fit.Validation.ExpectString(t),""===t&&Fit.Validation.ThrowError("String cannot be empty"))},Fit.Validation.ExpectBoolean=function(t,e){(!0!==e||void 0!==t&&null!==t)&&"boolean"!=typeof t&&Fit.Validation.ThrowError("Value '"+t+"' is not a valid boolean")},Fit.Validation.ExpectDate=function(t,e){(!0!==e||void 0!==t&&null!==t)&&t instanceof Date==!1&&Fit.Validation.ThrowError("Value '"+t+"' is not an instance of Date")},Fit.Validation.ExpectArray=function(t,e){(!0!==e||void 0!==t&&null!==t)&&t instanceof Array==!1&&Fit.Validation.ThrowError("Value '"+t+"' is not an instance of Array")},Fit.Validation.ExpectTypeArray=function(t,e,n){(!0!==n||void 0!==t&&null!==t)&&(t instanceof Array==!1&&Fit.Validation.ThrowError("Value '"+t+"' is not an instance of Array"),Fit.Validation.ExpectFunction(e),Fit.Array.ForEach(t,function(t){e(t)}))},Fit.Validation.ExpectInstanceArray=function(t,e,n){(!0!==n||void 0!==t&&null!==t)&&(t instanceof Array==!1&&Fit.Validation.ThrowError("Value '"+t+"' is not an instance of Array"),Fit.Array.ForEach(t,function(t){Fit.Validation.ExpectInstance(t,e)}))},Fit.Validation.ExpectCollection=function(t,e){(!0!==e||void 0!==t&&null!==t)&&!1===Fit._internal.Validation.IsCollectionType(t)&&Fit.Validation.ThrowError("Value '"+t+"' is not a valid collection")},Fit.Validation.ExpectRegExp=function(t,e){(!0!==e||void 0!==t&&null!==t)&&t instanceof RegExp==!1&&Fit.Validation.ThrowError("Value '"+t+"' is not an instance of RegExp")},Fit.Validation.ExpectElementNode=function(t,e){(!0!==e||void 0!==t&&null!==t)&&t instanceof Element==!1&&Fit.Validation.ThrowError("Value '"+t+"' is not a DOMElement")},Fit.Validation.ExpectDomElement=Fit.Validation.ExpectElementNode,Fit.Validation.ExpectTextNode=function(t,e){(!0!==e||void 0!==t&&null!==t)&&t instanceof Text==!1&&Fit.Validation.ThrowError("Value '"+t+"' is not a Text node")},Fit.Validation.ExpectCommentNode=function(t,e){(!0!==e||void 0!==t&&null!==t)&&t instanceof Comment==!1&&Fit.Validation.ThrowError("Value '"+t+"' is not a Comment node")},Fit.Validation.ExpectNode=function(t,e){(!0!==e||void 0!==t&&null!==t)&&t instanceof Element==!1&&t instanceof Text==!1&&t instanceof Comment==!1&&Fit.Validation.ThrowError("Value '"+t+"' is not a Node (Element, Text, or Comment)")},Fit.Validation.ExpectWindow=function(t,e){(!0!==e||void 0!==t&&null!==t)&&t instanceof Window==!1&&Fit.Validation.ThrowError("Value '"+t+"' is not an instance of Window")},Fit.Validation.ExpectFunction=function(t,e){(!0!==e||void 0!==t&&null!==t)&&"function"!=typeof t&&Fit.Validation.ThrowError("Value '"+t+"' is not a valid function")},Fit.Validation.ExpectEventTarget=function(t,e){(!0!==e||void 0!==t&&null!==t)&&("undefined"!=typeof EventTarget&&t instanceof EventTarget==!1?Fit.Validation.ThrowError("Value '"+t+"' is not an instance of EventTarget"):t.removeEventListener||t.attachEvent||Fit.Validation.ThrowError("Value '"+t+"' is not an instance of EventTarget"))},Fit.Validation.ExpectEvent=function(t,e){(!0!==e||void 0!==t&&null!==t)&&(window.MSEventObj||(window.MSEventObj=function(){}),t instanceof Event==!1&&t instanceof MSEventObj==!1&&Fit.Validation.ThrowError("Value '"+t+"' is not an instance of Event"))},Fit.Validation.ExpectInstance=function(t,e,n){(!0!==n||void 0!==t&&null!==t)&&t instanceof e!=!0&&!0!==Fit.Core.Extends(t,e)&&Fit.Validation.ThrowError("Unsupported object type passed")},Fit.Validation.ExpectIsSet=function(t){!1===Fit.Validation.IsSet(t)&&Fit.Validation.ThrowError("Value not set")},Fit.Validation.IsSet=function(t){return null!==t&&void 0!==t},Fit.Validation.ThrowError=function(t){if(!0===Fit._internal.Validation.DebugMode){var e=Fit.Validation.GetStackTrace();alert("ThrowError: "+t+(""!==e?"\n\n":"")+e),window.console&&console.trace&&console.trace()}throw new Error(t)},Fit.Validation.GetStackTrace=function(){if(void 0===window.Error||void 0===Error.captureStackTrace)return"";var t={};return Error.captureStackTrace(t,Fit.Validation.GetStackTrace),t.stack},Fit.Validation.Enabled=function(t){if(!0===Fit.Validation.IsSet(t))if(!0===t)Fit._internal.Validation.DebugMode=!0,null!==Fit._internal.Validation.Clone&&(Fit.Validation=Fit.Core.Clone(Fit._internal.Validation.Clone));else{Fit._internal.Validation.DebugMode=!1,null===Fit._internal.Validation.Clone&&(Fit._internal.Validation.Clone=Fit.Core.Clone(Fit.Validation));for(var e in Fit.Validation)0===e.indexOf("Expect")&&(Fit.Validation[e]=function(){})}return!0===Fit._internal.Validation.DebugMode},Fit._internal.Validation.IsCollectionType=function(t){return window.StaticNodeList||(window.StaticNodeList=function(){}),window.FileList||(window.FileList=function(){}),null!==t&&void 0!==t&&(t instanceof Array||(t instanceof NodeList||(t instanceof StaticNodeList||(t instanceof HTMLCollection||(t instanceof FileList||(t instanceof StyleSheetList||(t instanceof CSSRuleList||!(!t.callee||null===t.length||void 0===t.length))))))))},Fit.Array={},Fit.Array.ForEach=function(t,e){if(Fit.Validation.ExpectFunction(e),!0===Fit._internal.Validation.IsCollectionType(t)){for(var n=t.length,i=!1,o=0;o<t.length;o++)if(i=e(t[o]),t.length!==n&&Fit.Validation.ThrowError("Collection was modified while iterating objects"),!1===i)return!1}else if("object"==typeof t)for(var o in t)if(!1===e(o))return!1;return!0},Fit.Array.Count=function(t){if(!0===Fit._internal.Validation.IsCollectionType(t))return t.length;if("object"==typeof t){var e=0;for(var n in t)e++;return e}Fit.Validation.ThrowError("Unsupported collection type passed - unable to determine number of contained elements")},Fit.Array.Recurse=function(t,e,n){if(Fit.Validation.ExpectCollection(t,!0),Fit.Validation.ExpectStringValue(e),Fit.Validation.ExpectFunction(n),!1===Fit.Validation.IsSet(t))return!0;for(var i=t.length,o=0;o<t.length;o++){if(t.length!==i&&Fit.Validation.ThrowError("Collection was modified while iterating objects"),!1===n(t[o]))return!1;if(!1!==Fit.Validation.IsSet(t[o][e]))if(t[o][e]instanceof Function){if(!1===Fit.Array.Recurse(t[o][e](),e,n))return!1}else if(!1===Fit.Array.Recurse(t[o][e],e,n))return!1}return!0},Fit.Array.CustomRecurse=function(t,e){Fit.Validation.ExpectFunction(e),void 0!==t&&null!==t&&!1===Fit._internal.Validation.IsCollectionType(t)&&Fit.Validation.ThrowError("Unexpected collection type passed"),Fit.Array.ForEach(t,function(t){Fit.Array.CustomRecurse(e(t),e)})},Fit.Array.Add=function(t,e){Fit.Validation.ExpectArray(t),t.push(e)},Fit.Array.Insert=function(t,e,n){Fit.Validation.ExpectArray(t),Fit.Validation.ExpectInteger(e),t.splice(e,0,n)},Fit.Array.Merge=function(t,e){return Fit.Validation.ExpectArray(t),Fit.Validation.ExpectArray(e),t.concat(e)},Fit.Array.Remove=function(t,e){Fit.Validation.ExpectArray(t);var n=Fit.Array.GetIndex(t,e);-1!==n&&t.splice(n,1)},Fit.Array.RemoveAt=function(t,e){Fit.Validation.ExpectArray(t),Fit.Validation.ExpectInteger(e),t.splice(e,1)},Fit.Array.Clear=function(t){Fit.Validation.ExpectArray(t),t.length=0},Fit.Array.GetIndex=function(t,e){Fit.Validation.ExpectArray(t);for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1},Fit.Array.GetKeys=function(t){var e=[];if(!0===Fit._internal.Validation.IsCollectionType(t))for(var n=0;n<t.length;n++)e.push(n);else if("object"==typeof t)for(var n in t)e.push(n);return e},Fit.Array.Contains=function(t,e){return Fit.Validation.ExpectArray(t),Fit.Array.GetIndex(t,e)>-1},Fit.Array.Copy=function(t){Fit.Validation.ExpectCollection(t);var e=[];return Fit.Array.ForEach(t,function(t){e.push(t)}),e},Fit.Array.ToArray=function(t){Fit.Validation.ExpectCollection(t);for(var e=[],n=0;n<t.length;n++)e.push(t[n]);return e},Fit.Browser={},Fit._internal.Browser={},Fit.Browser.GetBrowser=function(){var t=navigator.userAgent;return t.indexOf("Edge/")>-1?"Edge":t.indexOf("Chrome")>-1?"Chrome":t.indexOf("Safari")>-1?"Safari":t.indexOf("MSIE")>-1||t.indexOf("Trident")>-1?"MSIE":t.indexOf("Firefox")>-1?"Firefox":t.indexOf("Opera")>-1?"Opera":"Unknown"},Fit.Browser.GetVersion=function(){var t=0,e=0,n=navigator.userAgent;return"Edge"===Fit.Browser.GetBrowser()&&(t=-1!==(t=n.indexOf("Edge/"))?t+5:0,e=-1!==(e=n.indexOf(".",t))?e:0),"Chrome"===Fit.Browser.GetBrowser()&&(t=-1!==(t=n.indexOf("Chrome/"))?t+7:0,e=-1!==(e=n.indexOf(".",t))?e:0),"Safari"===Fit.Browser.GetBrowser()&&(t=-1!==(t=n.indexOf("Version/"))?t+8:0,e=-1!==(e=n.indexOf(".",t))?e:0),"MSIE"===Fit.Browser.GetBrowser()&&(n.indexOf("MSIE")>-1?(t=-1!==(t=n.indexOf("MSIE "))?t+5:0,e=-1!==(e=n.indexOf(".",t))?e:0):n.indexOf("Trident")>-1&&(t=-1!==(t=n.indexOf("rv:"))?t+3:0,e=-1!==(e=n.indexOf(".",t))?e:0)),"Firefox"===Fit.Browser.GetBrowser()&&(t=-1!==(t=n.indexOf("Firefox/"))?t+8:0,e=-1!==(e=n.indexOf(".",t))?e:0),"Opera"===Fit.Browser.GetBrowser()&&(-1===(t=-1!==(t=n.indexOf("Version/"))?t+8:-1)&&(t=-1!==(t=n.indexOf("Opera/"))?t+6:-1),-1===t&&(t=-1!==(t=n.indexOf("Opera "))?t+6:-1),e=-1!==(e=n.indexOf(".",t))?e:0),0!==t&&0!==t?parseInt(n.substring(t,e)):-1},Fit.Browser.GetQueryString=function(t){Fit.Validation.ExpectString(t,!0);var e,n={Url:null,Parameters:{},Anchor:null},i=void 0!==t?t:location.href,o=i.indexOf("?")>-1?i.split("?")[1]:"";return o=o.indexOf("#")>-1?o.split("#")[0]:o,e=i.indexOf("#")>-1?i.split("#")[1]:null,n.Url=i,n.Anchor=e,Fit.Array.ForEach(""!==o?o.split("&"):[],function(t){var e=t.split("=");try{n.Parameters[e[0]]=e.length>1?decodeURIComponent(e[1]):""}catch(t){n.Parameters[e[0]]=e.length>1?e[1]:""}}),n},Fit.Browser.GetLanguage=function(){var t=null;return navigator.language?t=navigator.language.toLowerCase():navigator.browserLanguage&&(t=navigator.browserLanguage.toLowerCase()),null===t||""===t?"en":2===t.length?t:5===t.length?t.substring(0,2):"en"},Fit.Browser.GetPageWidth=function(){var t=0;return window.innerWidth?t=window.innerWidth:document.documentElement&&document.documentElement.clientWidth&&(t=document.documentElement.clientWidth),t},Fit.Browser.GetPageHeight=function(){var t=0;return window.innerHeight?t=window.innerHeight:document.documentElement&&document.documentElement.clientHeight&&(t=document.documentElement.clientHeight),t},Fit.Browser.GetViewPortDimensions=function(){return{Width:Fit.Browser.GetPageWidth(),Height:Fit.Browser.GetPageHeight()}},Fit.Browser.GetScrollPosition=function(){return{X:document.body.scrollLeft||document.documentElement.scrollLeft||window.pageXOffset||0,Y:document.body.scrollTop||document.documentElement.scrollTop||window.pageYOffset||0}},Fit.Browser.GetScreenWidth=function(t){return Fit.Validation.ExpectBoolean(t,!0),!0===t?window.screen.availWidth:window.screen.width},Fit.Browser.GetScreenHeight=function(t){return Fit.Validation.ExpectBoolean(t,!0),!0===t?window.screen.availHeight:window.screen.height},Fit.Browser.GetScreenDimensions=function(t){return Fit.Validation.ExpectBoolean(t,!0),{Width:Fit.Browser.GetScreenWidth(t),Height:Fit.Browser.GetScreenHeight(t)}},Fit.Browser.IsMobile=function(t){Fit.Validation.ExpectBoolean(t,!0);var e=navigator.userAgent||navigator.vendor;return!(!1===t||!/android|ipad|playbook|silk/i.test(e))||(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))},Fit.Browser.Log=function(t){window.console&&console.log(t)},Fit.Browser.GetInfo=function(){return Fit._internal.Browser.Info||(Fit._internal.Browser.Info={},Fit._internal.Browser.Info.Name=Fit.Browser.GetBrowser(),Fit._internal.Browser.Info.Version=Fit.Browser.GetVersion(),Fit._internal.Browser.Info.Language=Fit.Browser.GetLanguage(),Fit._internal.Browser.Info.IsMobile=Fit.Browser.IsMobile(),Fit._internal.Browser.Info.IsPhone=Fit.Browser.IsMobile(!1),Fit._internal.Browser.Info.IsTablet=!0===Fit.Browser.IsMobile()&&!1===Fit.Browser.IsMobile(!1)),Fit.Core.Clone(Fit._internal.Browser.Info)},Fit.Browser.IsStorageSupported=function(){if(void 0===Fit._internal.Browser.StorageSupported){Fit._internal.Browser.StorageSupported=!1;try{if(window.localStorage&&window.sessionStorage){var t="__FITUITEST__";localStorage.setItem(t,t),localStorage.removeItem(t),sessionStorage.setItem(t,t),sessionStorage.removeItem(t),Fit._internal.Browser.StorageSupported=!0}}catch(t){}}return Fit._internal.Browser.StorageSupported},Fit.Controls={},Fit._internal.Controls={},Fit._internal.ControlBase={Controls:{}},Fit.Controls.ControlBase=function(t){Fit.Validation.ExpectStringValue(t),void 0!==Fit._internal.ControlBase.Controls[t]&&Fit.Validation.ThrowError("Control with ID '"+t+"' has already been defined - Control IDs must be unique!"),Fit._internal.ControlBase.Controls[t]=this,this.Value=function(t){Fit.Validation.ThrowError("Not implemented")},this.IsDirty=function(){Fit.Validation.ThrowError("Not implemented")},this.Clear=function(){Fit.Validation.ThrowError("Not implemented")},this.Focused=function(t){Fit.Validation.ThrowError("Not implemented")};var e=this,n=t,i=null,o={Value:200,Unit:"px"},a={Value:-1,Unit:"px"},r=null,l=!1,d=null,u=null,s=null,c=-1,F=null,m=null,f=!1,p=!1,E=!1,h=[],v=[],D=[],y=!1,g=null,V=!1,C=!1,S=null,x=null,w=null,I="MSIE"===Fit.Browser.GetInfo().Name&&8===Fit.Browser.GetInfo().Version;function A(t){null!==g&&(clearTimeout(g),g=null),!0!==C?!0!==y&&(y=!0,V=!0,setTimeout(function(){null!==e&&(V=!1,e._internal.FireOnFocus())},0)):C=!1}function _(t){var n=null;n=function(){if(null!==e){if(!0===V)return C=!0,void(g=setTimeout(n,0));g=null,C=!1,y=!1,e._internal.FireOnBlur()}},g=setTimeout(n,0)}function G(){S.value=e.Value().toString(),x.value=!0===e.IsDirty()?"1":"0",w.value=!0===e.IsValid()?"1":"0",e._internal.Data("dirty",!0===e.IsDirty()?"true":"false")}this.AutoPostBack=function(t){return Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t)&&e._internal.Data("autopost",t.toString()),"true"===e._internal.Data("autopost")},this.GetId=function(){return n},this.GetDomElement=function(){return!1===p&&(p=!0,e._internal.Validate(),G()),i},this.Dispose=function(){Fit.Dom.Remove(i),e=n=i=o=a=r=l=u=s=c=F=m=f=p=E=h=v=D=y=g=V=C=S=x=w=I=null,delete Fit._internal.ControlBase.Controls[t]},this.Width=function(t,e){return Fit.Validation.ExpectNumber(t,!0),Fit.Validation.ExpectStringValue(e,!0),!0===Fit.Validation.IsSet(t)&&(t>-1?(o={Value:t,Unit:!0===Fit.Validation.IsSet(e)?e:"px"},i.style.width=o.Value+o.Unit):(o={Value:200,Unit:"px"},i.style.width="")),o},this.Height=function(t,e){return Fit.Validation.ExpectNumber(t,!0),Fit.Validation.ExpectStringValue(e,!0),!0===Fit.Validation.IsSet(t)&&((a={Value:t,Unit:!0===Fit.Validation.IsSet(e)&&-1!==t?e:"px"}).Value>-1?i.style.height=a.Value+a.Unit:i.style.height=""),a},this.AddCssClass=function(t){Fit.Validation.ExpectStringValue(t),Fit.Dom.AddClass(i,t)},this.RemoveCssClass=function(t){Fit.Validation.ExpectStringValue(t),Fit.Dom.RemoveClass(i,t)},this.HasCssClass=function(t){return Fit.Validation.ExpectStringValue(t),Fit.Dom.HasClass(i,t)},this.Visible=function(t){return Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t)&&(i.style.display=!0===t?"":"none"),"none"!==i.style.display},this.Required=function(t){return Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t)&&(l=t,e._internal.Validate()),l},this.Scope=function(t){return Fit.Validation.ExpectString(t,!0),!0===Fit.Validation.IsSet(t)&&(r=""===t?null:t),r},this.AlwaysDirty=function(t){return Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t)&&(!0===t&&null===d?(d=this.IsDirty,this.IsDirty=function(){return!0},G()):!1===t&&null!==d&&(this.IsDirty=d,d=null,G())),null!==d},this.Render=function(t){if(Fit.Validation.ExpectDomElement(t,!0),!0===Fit.Validation.IsSet(t))Fit.Dom.Add(t,e.GetDomElement());else{var n=document.scripts[document.scripts.length-1];Fit.Dom.InsertBefore(n,e.GetDomElement())}},this.SetValidationExpression=function(t,n){Fit.Validation.ExpectRegExp(t,!0),Fit.Validation.ExpectString(n,!0),u=t||null,s=n||null,e._internal.Validate()},this.SetValidationCallback=function(t,n){Fit.Validation.ExpectFunction(t,!0),Fit.Validation.ExpectString(n,!0),F=t||null,m=n||null,e._internal.Validate()},this.IsValid=function(){if(c=-1,null===u&&null===F&&!1===l)return!0;var t=e.Value(),n=!0===Fit.Validation.IsSet(t)?t.toString():"";return!0===l&&""===n?(c=0,!1):null!==u&&!1===u.test(n)?(c=1,!1):null===F||!1!==F(n)||(c=2,!1)},this.LazyValidation=function(t){return Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t)&&!0===(f=t)&&(e._internal.Data("valid","true"),e._internal.Data("errormessage",null)),f},this.OnChange=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(h,t)},this.OnFocus=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(v,t)},this.OnBlur=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(D,t)},this._internal=this._internal?this._internal:{},this._internal.FireOnChange=function(){p=!0,e._internal.Validate(),G(),Fit.Array.ForEach(h,function(t){t(e)})},this._internal.FireOnFocus=function(){e._internal.Data("focused","true"),e._internal.Repaint(),Fit.Array.ForEach(v,function(t){t(e)})},this._internal.FireOnBlur=function(){e._internal.Data("focused","false"),e._internal.Repaint(),Fit.Array.ForEach(D,function(t){t(e)})},this._internal.ExecuteWithNoOnChange=function(t){Fit.Validation.ExpectFunction(t);var n=e._internal.FireOnChange;e._internal.FireOnChange=function(){};var i=null;try{t()}catch(t){i=t.message}e._internal.FireOnChange=n,null!==i&&Fit.Validation.ThrowError(i)},this._internal.Data=function(t,e){return Fit.Validation.ExpectStringValue(t),Fit.Validation.ExpectString(e,!0),!0!==Fit.Validation.IsSet(e)&&null!==e||Fit.Dom.Data(i,t,e),Fit.Dom.Data(i,t)},this._internal.AddDomElement=function(t){Fit.Validation.ExpectDomElement(t),Fit.Dom.InsertBefore(S,t)},this._internal.RemoveDomElement=function(t){Fit.Validation.ExpectDomElement(t),Fit.Dom.Remove(t)},this._internal.Validate=function(t){if(Fit.Validation.ExpectBoolean(t,!0),!0!==f||!1!==e.Focused()||!0===t){var n=e.IsValid();e._internal.Data("valid",n.toString()),!1===n?0===c?e._internal.Data("errormessage",Fit.Language.Translations.Required):1===c&&null!==s?e._internal.Data("errormessage",s.replace("\r","").replace(/<br.*>/i,"\n")):2===c&&null!==m&&e._internal.Data("errormessage",m.replace("\r","").replace(/<br.*>/i,"\n")):e._internal.Data("errormessage",null),e._internal.Repaint()}},this._internal.Repaint=function(t){Fit.Validation.ExpectFunction(t,!0);var n=!0===Fit.Validation.IsSet(t)?t:function(){};!1===I?n():(Fit.Dom.AddClass(e.GetDomElement(),"FitUi_Non_Existing_ControlBase_Class"),Fit.Dom.RemoveClass(e.GetDomElement(),"FitUi_Non_Existing_ControlBase_Class"),setTimeout(function(){n(),Fit.Dom.AddClass(e.GetDomElement(),"FitUi_Non_Existing_ControlBase_Class"),Fit.Dom.RemoveClass(e.GetDomElement(),"FitUi_Non_Existing_ControlBase_Class")},0))},Fit._internal.Core.EnsureStyles(),(i=document.createElement("div")).id=n,i.style.width=o.Value+o.Unit,Fit.Dom.AddClass(i,"FitUiControl"),e._internal.Data("focused","false"),e._internal.Data("valid","true"),e._internal.Data("dirty","false"),e._internal.Data("device",!1===Fit.Browser.GetInfo().IsMobile?"Desktop":!0===Fit.Browser.GetInfo().IsPhone?"Phone":"Tablet"),(S=document.createElement("textarea")).style.display="none",S.name="FitUIValue"+e.GetId(),Fit.Dom.Add(i,S),(x=document.createElement("input")).type="hidden",x.name="FitUIDirty"+e.GetId(),Fit.Dom.Add(i,x),(w=document.createElement("input")).type="hidden",w.name="FitUIValid"+e.GetId(),Fit.Dom.Add(i,w),e.OnChange(function(t){!1===E&&!0===e.AutoPostBack()&&document.forms.length>0&&setTimeout(function(){E=!0,document.forms[0].submit(),setTimeout(function(){E=!1},500)},0)}),"MSIE"!==Fit.Browser.GetBrowser()||Fit.Browser.GetVersion()>=9?(Fit.Events.AddHandler(i,"focus",!0,A),Fit.Events.AddHandler(i,"blur",!0,_)):(i.onfocusin=A,i.onfocusout=_),e.OnBlur(function(t){!0===f&&e._internal.Validate(!0)})},Fit.Controls.Find=function(t){return Fit.Validation.ExpectStringValue(t),void 0!==Fit._internal.ControlBase.Controls[t]?Fit._internal.ControlBase.Controls[t]:null},Fit.Controls.ValidateAll=function(t){Fit.Validation.ExpectStringValue(t,!0);var e=!0;return Fit.Array.ForEach(Fit._internal.ControlBase.Controls,function(n){var i=Fit._internal.ControlBase.Controls[n];!1!==Fit.Core.InstanceOf(i,Fit.Controls.ControlBase)&&(!0===Fit.Validation.IsSet(t)&&i.Scope()!==t||(i._internal.Validate(!0),!1===i.IsValid()&&(e=!1)))}),e},Fit.Controls.DirtyCheckAll=function(t){Fit.Validation.ExpectStringValue(t,!0);var e=!1;return Fit.Array.ForEach(Fit._internal.ControlBase.Controls,function(n){var i=Fit._internal.ControlBase.Controls[n];if(!1!==Fit.Core.InstanceOf(i,Fit.Controls.ControlBase)&&(!0!==Fit.Validation.IsSet(t)||i.Scope()===t))return!0===i.IsDirty()?(e=!0,!1):void 0}),e},Fit.Cookies=function(){var t=location.pathname.match(/^.*\//)[0],e="";this.Path=function(e){return Fit.Validation.ExpectStringValue(e,!0),!0===Fit.Validation.IsSet(e)&&(t=e),t},this.Prefix=function(t){return Fit.Validation.ExpectString(t,!0),!0===Fit.Validation.IsSet(t)&&(e=t),e},this.Set=function(n,i,o){Fit.Validation.ExpectStringValue(n),Fit.Validation.ExpectString(n),Fit.Validation.ExpectInteger(o,!0),Fit.Cookies.Set(e+n,i,o,t)},this.Get=function(t){return Fit.Validation.ExpectStringValue(t),Fit.Cookies.Get(e+t)},this.Remove=function(n){Fit.Validation.ExpectStringValue(n),Fit.Cookies.Set(e+n,"",-1,t)},t=t.substring(0,t.length-1)},Fit.Cookies.Set=function(t,e,n,i){Fit.Validation.ExpectStringValue(t),Fit.Validation.ExpectString(t),Fit.Validation.ExpectInteger(n,!0),Fit.Validation.ExpectStringValue(i,!0),e.indexOf(";")>-1&&Fit.Validation.ThrowError("Unable to set cookie - value contains illegal character: ';'"),e=e.replace(/\n/g,"\\n");var o=null;!0===Fit.Validation.IsSet(n)&&(o=new Date).setTime(o.getTime()+1e3*n),document.cookie=t+"="+e+(null!==o?"; expires="+o.toGMTString():"")+"; path="+(!0===Fit.Validation.IsSet(i)?i+("/"!==i[i.length-1]?"/":""):"/")},Fit.Cookies.Get=function(t){Fit.Validation.ExpectStringValue(t);for(var e=t+"=",n=document.cookie.split(";"),i=null,o=0;o<n.length;o++){for(i=n[o];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(e))return i.substring(e.length,i.length).replace(/\\n/g,"\n")}return null},Fit.Cookies.Remove=function(t,e){Fit.Validation.ExpectStringValue(t),Fit.Validation.ExpectStringValue(e,!0),Fit.Cookies.Set(t,"",-1,e)},Fit.Data={},Fit.Data.CreateGuid=function(t){Fit.Validation.ExpectBoolean(t,!0);var e="0123456789abcdef".split(""),n=new Array,i=Math.random,o=-1;!1!==t&&(n[8]="-"),!1!==t&&(n[13]="-"),n[14]="4",!1!==t&&(n[18]="-"),!1!==t&&(n[23]="-");for(var a=32+(!1!==t?4:0),r=0;r<a;r++)void 0===n[r]&&(o=0|16*i(),n[r]=e[19===r?3&o|8:15&o]);return n.join("")},Fit.Math={},Fit.Math.Round=function(t,e){Fit.Validation.ExpectNumber(t),Fit.Validation.ExpectInteger(e,!0);for(var n=!0===Fit.Validation.IsSet(e)?e:0,i=1,o=0;o<n;o++)i*=10;return Math.round(t*i)/i},Fit.Math.Format=function(t,e,n){Fit.Validation.ExpectNumber(t),Fit.Validation.ExpectInteger(e,!0),Fit.Validation.ExpectString(n,!0);var i=Fit.Math.Round(t,e);if(e<=0)return i.toString();for(var o=i%1==0?i.toString()+".0":i.toString(),a=o.split(".")[1].length;a<e;a++)o+="0";return!0===Fit.Validation.IsSet(n)?o.replace(".",n):o},Fit.String={},Fit.String.Trim=function(t){return Fit.Validation.ExpectString(t),t.replace(/^\s+|\s+$/g,"")},Fit.String.StripHtml=function(t){return Fit.Validation.ExpectString(t),t.replace(/(<([^>]+)>)/g,"")},Fit.String.EncodeHtml=function(t){return Fit.Validation.ExpectString(t),t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},Fit.String.DecodeHtml=function(t){return Fit.Validation.ExpectString(t),t.replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&#039;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")},Fit.String.Hash=function(t){if(Fit.Validation.ExpectString(t),0==t.length)return 0;for(var e=0,n=0;n<t.length;n++)e=(e<<5)-e+t.charCodeAt(n),e&=e;return e},Fit.String.UpperCaseFirst=function(t){return Fit.Validation.ExpectString(t),""===t?t:t[0].toUpperCase()+t.slice(1)},Fit.Date={},Fit.Date.Format=function(t,e){return Fit.Validation.ExpectDate(t),Fit.Validation.ExpectString(e),e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/YYYY/g,t.getFullYear().toString())).replace(/YY/g,t.getFullYear().toString().substring(2))).replace(/Y/g,parseInt(t.getFullYear().toString().substring(2),10).toString())).replace(/MM/g,(t.getMonth()+1<=9?"0":"")+(t.getMonth()+1))).replace(/M/g,(t.getMonth()+1).toString())).replace(/DD/g,(t.getDate()<=9?"0":"")+t.getDate())).replace(/D/g,t.getDate().toString())).replace(/W/g,Fit.Date.GetWeek(t).toString())).replace(/hh/g,(t.getHours()<=9?"0":"")+t.getHours())).replace(/h/g,t.getHours().toString())).replace(/mm/g,(t.getMinutes()<=9?"0":"")+t.getMinutes())).replace(/m/g,t.getMinutes().toString())).replace(/ss/g,(t.getSeconds()<=9?"0":"")+t.getSeconds())).replace(/s/g,t.getSeconds().toString())},Fit.Date.Parse=function(t,e){Fit.Validation.ExpectString(t),Fit.Validation.ExpectString(e);var n=e;if(n="^"+(n=(n=(n=(n=(n=(n=(n=n.replace(/Y{1,4}/,"\\d{4}")).replace(/M{1,2}/,"\\d{1,2}")).replace(/D{1,2}/,"\\d{1,2}")).replace(/h{1,2}/,"\\d{1,2}")).replace(/m{1,2}/,"\\d{1,2}")).replace(/s{1,2}/,"\\d{1,2}")).replace(/\//g,"\\/"))+"$",!1===new RegExp(n).test(t))throw"InvalidDateFormat - Value '"+t+"' does not match format '"+e+"'";for(var i=/\d+/g,o=null,a=[];null!==(o=i.exec(t));)Fit.Array.Add(a,o[0]);var r=new Date,l=[{Name:"Year",Key:"Y",Index:-1,Value:r.getFullYear()},{Name:"Month",Key:"M",Index:-1,Value:r.getMonth()+1},{Name:"Day",Key:"D",Index:-1,Value:r.getDate()},{Name:"Hours",Key:"h",Index:-1,Value:r.getHours()},{Name:"Minutes",Key:"m",Index:-1,Value:r.getMinutes()},{Name:"Seconds",Key:"s",Index:-1,Value:r.getSeconds()}];l.getVal=function(t){var e=null;return Fit.Array.ForEach(this,function(n){if(t===n.Key)return e=n.Value,!1}),e},Fit.Array.ForEach(l,function(t){t.Index=e.indexOf(t.Key)}),l.sort(function(t,e){return(-1!==t.Index?t.Index:999999)-(-1!==e.Index?e.Index:999999)});var d=-1;Fit.Array.ForEach(l,function(t){if(-1!==t.Index){if(++d>a.length-1)throw"InvalidDateFormat - "+t.Name+" not found in value";if(t.Value=parseInt(a[d],10),"Y"===t.Key&&t.Value<1e3)throw"InvalidDataFormat - value '"+t.Value+"' is not valid for '"+t.Name+"'";if("M"===t.Key&&(t.Value<0||t.Value>12))throw"InvalidDataFormat - value '"+t.Value+"' is not valid for '"+t.Name+"'";if("D"===t.Key&&(t.Value<0||t.Value>31))throw"InvalidDataFormat - value '"+t.Value+"' is not valid for '"+t.Name+"'";if("h"===t.Key&&(t.Value<0||t.Value>23))throw"InvalidDataFormat - value '"+t.Value+"' is not valid for '"+t.Name+"'";if(("m"===t.Key||"s"===t.Key)&&(t.Value<0||t.Value>59))throw"InvalidDataFormat - value '"+t.Value+"' is not valid for '"+t.Name+"'";"M"===t.Key&&(t.Value=t.Value-1)}});var u=new Date(l.getVal("Y"),l.getVal("M"),l.getVal("D",!0),0,0,0);return u.setHours(parseInt(l.getVal("h"),10)),u.setMinutes(parseInt(l.getVal("m"),10)),u.setSeconds(parseInt(l.getVal("s"),10)),u},Fit.Date.GetWeek=function(t){Fit.Validation.ExpectDate(t);var e=new Date(t.getTime());e.setHours(0,0,0),e.setDate(e.getDate()+4-(e.getDay()||7));var n=new Date(e.getFullYear(),0,1);return Math.ceil(((e.getTime()-n.getTime())/864e5+1)/7)},Fit.Color={},Fit.Color.RgbToHex=function(t,e,n){if(Fit.Validation.ExpectNumber(t),Fit.Validation.ExpectNumber(e),Fit.Validation.ExpectNumber(n),t<0||t>255||e<0||e>255||n<0||n>255)return null;var i=t.toString(16),o=e.toString(16),a=n.toString(16);return("#"+(1===i.length?"0":"")+i+(1===o.length?"0":"")+o+(1===a.length?"0":"")+a).toUpperCase()},Fit.Color.HexToRgb=function(t){Fit.Validation.ExpectString(t);var e=Fit.Color.ParseHex(t);return null===e?null:"rgb("+e.Red+", "+e.Green+", "+e.Blue+")"},Fit.Color.ParseHex=function(t){Fit.Validation.ExpectString(t);var e=t.match(/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i);return null===e?null:{Red:parseInt(e[1],16),Green:parseInt(e[2],16),Blue:parseInt(e[3],16)}},Fit.Color.ParseRgb=function(t){Fit.Validation.ExpectString(t);var e=t.match(/(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(\s*,\s*(\d*.*\d+))*/);if(null===e)return null;var n={};return n.Red=parseInt(e[1],10),n.Green=parseInt(e[2],10),n.Blue=parseInt(e[3],10),n.Alpha=void 0!==e[5]?parseFloat(e[5]):1,n},Fit.Dom={},Fit._internal.Dom={},Fit.Dom.AddClass=function(t,e){Fit.Validation.ExpectDomElement(t),Fit.Validation.ExpectStringValue(e),!1===Fit.Dom.HasClass(t,e)&&(t.className+=(""!==t.className?" ":"")+e)},Fit.Dom.RemoveClass=function(t,e){Fit.Validation.ExpectDomElement(t),Fit.Validation.ExpectStringValue(e);var n=t.className.split(" "),i="";Fit.Array.ForEach(n,function(t){t!==e&&(i+=(""!==i?" ":"")+t)}),t.className=i},Fit.Dom.HasClass=function(t,e){Fit.Validation.ExpectDomElement(t),Fit.Validation.ExpectStringValue(e);var n=t.className.split(" "),i=!1;return Fit.Array.ForEach(n,function(t){if(t===e)return i=!0,!1}),i},Fit.Dom.GetComputedStyle=function(t,e){Fit.Validation.ExpectDomElement(t),Fit.Validation.ExpectStringValue(e);var n=null;if(window.getComputedStyle)n=window.getComputedStyle(t)[e];else if(t.currentStyle){if(-1!==e.indexOf("-")){var i=e.split("-");e="",Fit.Array.ForEach(i,function(t){""===e?e=t:e+=Fit.String.UpperCaseFirst(t)})}if(void 0!==(n=t.currentStyle[e])&&null!==n&&!0===/^\d+/.test(n)&&-1===n.toLowerCase().indexOf("px")){var o=t.style.left,a=t.runtimeStyle.left;t.runtimeStyle.left=t.currentStyle.left,t.style.left="fontSize"===e?"1em":n||0,n=t.style.pixelLeft+"px",t.style.left=o,t.runtimeStyle.left=a}}return void 0!==n?n:null},Fit.Dom.GetInnerDimensions=function(t){Fit.Validation.ExpectDomElement(t);var e=t.offsetWidth,n=t.offsetHeight;return 0!==e&&(e-=Fit._internal.Dom.GetPx(Fit.Dom.GetComputedStyle(t,"padding-left")),e-=Fit._internal.Dom.GetPx(Fit.Dom.GetComputedStyle(t,"padding-right")),e-=Fit._internal.Dom.GetPx(Fit.Dom.GetComputedStyle(t,"border-left-width")),e-=Fit._internal.Dom.GetPx(Fit.Dom.GetComputedStyle(t,"border-right-width"))),0!==n&&(n-=Fit._internal.Dom.GetPx(Fit.Dom.GetComputedStyle(t,"padding-top")),n-=Fit._internal.Dom.GetPx(Fit.Dom.GetComputedStyle(t,"padding-bottom")),n-=Fit._internal.Dom.GetPx(Fit.Dom.GetComputedStyle(t,"border-top-width")),n-=Fit._internal.Dom.GetPx(Fit.Dom.GetComputedStyle(t,"border-bottom-width"))),{X:Math.floor(e),Y:Math.floor(n)}},Fit.Dom.GetInnerWidth=function(t){return Fit.Validation.ExpectDomElement(t),Fit.Dom.GetInnerDimensions(t).X},Fit.Dom.IsRooted=function(t){Fit.Validation.ExpectNode(t);for(var e=t.parentElement;null!==e;){if(e===document.body)return!0;e=e.parentElement}return!1},Fit.Dom.InsertBefore=function(t,e){Fit.Validation.ExpectNode(t),Fit.Validation.ExpectNode(e),null===t.parentElement&&Fit.Validation.ThrowError("Unable to insert element - target is not rooted"),t.parentElement.insertBefore(e,t)},Fit.Dom.InsertAfter=function(t,e){Fit.Validation.ExpectNode(t),Fit.Validation.ExpectNode(e),null===t.parentElement&&Fit.Validation.ThrowError("Unable to insert element - target is not rooted"),t.nextSibling?t.parentElement.insertBefore(e,t.nextSibling):t.parentElement.appendChild(e)},Fit.Dom.InsertAt=function(t,e,n){if(Fit.Validation.ExpectDomElement(t),Fit.Validation.ExpectInteger(e),Fit.Validation.ExpectNode(n),0===t.children.length||t.children.length-1<e)t.appendChild(n);else{var i=t.children[e];i&&Fit.Dom.InsertBefore(i,n)}},Fit.Dom.Replace=function(t,e){Fit.Validation.ExpectNode(t),Fit.Validation.ExpectNode(e),null===t.parentElement&&Fit.Validation.ThrowError("Unable to replace element - not rooted"),t.parentElement.replaceChild(e,t)},Fit.Dom.Add=function(t,e){Fit.Validation.ExpectDomElement(t),Fit.Validation.ExpectNode(e),t.appendChild(e)},Fit.Dom.Remove=function(t){Fit.Validation.ExpectNode(t),null!==t.parentElement&&t.parentElement.removeChild(t)},Fit.Dom.Attribute=function(t,e,n){return Fit.Validation.ExpectDomElement(t),Fit.Validation.ExpectStringValue(e),Fit.Validation.ExpectString(n,!0),!0===Fit.Validation.IsSet(n)?t.setAttribute(e,n):null===n&&t.removeAttribute(e),t.getAttribute(e)},Fit.Dom.Data=function(t,e,n){return Fit.Validation.ExpectDomElement(t),Fit.Validation.ExpectStringValue(e),Fit.Validation.ExpectString(n,!0),Fit.Dom.Attribute(t,"data-"+e,n)},Fit.Dom.CreateElement=function(t,e){var n;return Fit.Validation.ExpectString(t),Fit.Validation.ExpectStringValue(e,!0),0===Fit.String.Trim(t).toLowerCase().indexOf("<tr")?(t=Fit.String.Trim(t),(n=document.createElement("div")).innerHTML="<table><tbody>"+t+"</tbody></table>",1===n.firstChild.firstChild.children.length?n.firstChild.firstChild.firstChild:n.firstChild):0===Fit.String.Trim(t).toLowerCase().indexOf("<td")?(t=Fit.String.Trim(t),(n=document.createElement("div")).innerHTML="<table><tbody><tr>"+t+"</tr></tbody></table>",1===n.firstChild.firstChild.firstChild.children.length?n.firstChild.firstChild.firstChild.firstChild:n.firstChild.firstChild.firstChild):((n=document.createElement(!0===Fit.Validation.IsSet(e)?e:"div")).innerHTML=t,1===n.childNodes.length?n.firstChild:n)},Fit.Dom.Text=function(t,e){return Fit.Validation.ExpectDomElement(t),Fit.Validation.ExpectString(e,!0),!0===Fit.Validation.IsSet(e)&&(t.textContent?t.textContent=e:t.innerText=e),t.textContent?t.textContent:t.innerText},Fit.Dom.GetIndex=function(t){if(Fit.Validation.ExpectDomElement(t),!t.parentElement)return-1;for(var e=t.parentElement,n=0;n<e.children.length;n++)if(e.children[n]===t)return n;return-1},Fit.Dom.GetDepth=function(t){Fit.Validation.ExpectNode(t);for(var e=0,n=t.parentElement;n;)e++,n=n.parentElement;return e},Fit.Dom.Contained=function(t,e){Fit.Validation.ExpectDomElement(t),Fit.Validation.ExpectNode(e);for(var n=e.parentElement;n;){if(n===t)return!0;n=n.parentElement}return!1},Fit.Dom.IsVisible=function(t){if(Fit.Validation.ExpectNode(t),8===t.nodeType)return!1;if(3===t.nodeType){if(null===t.parentElement)return!1;t=t.parentElement}if(!0===Fit._internal.Dom.IsOffsetParentSupported()&&"fixed"!==Fit.Dom.GetComputedStyle(t,"position")&&t!==document.body&&t!==document.body.parentElement)return null!==t.offsetParent;for(var e=t,n=null;null!==e;){if("none"===Fit.Dom.GetComputedStyle(e,"display"))return!1;n=e,e=e.parentElement}return n===document.documentElement},Fit.Dom.GetConcealer=function(t){if(Fit.Validation.ExpectNode(t),8===t.nodeType)return t;if(!0===Fit.Dom.IsVisible(t))return null;3===t.nodeType&&(t=t.parentElement);for(var e=t;null!==e;){if("none"===Fit.Dom.GetComputedStyle(e,"display"))return e;e=e.parentElement}return null},Fit.Dom.GetFocused=function(){var t=null;try{(t=document.activeElement).nodeType||(t=document.body)}catch(e){t=document.body}return t},Fit.Dom.GetParentOfType=function(t,e){Fit.Validation.ExpectNode(t),Fit.Validation.ExpectStringValue(e);for(var n=t.parentElement;null!==n;){if(n.tagName.toLowerCase()===e.toLowerCase())return n;n=n.parentElement}return null},Fit.Dom.Wrap=function(t,e){Fit.Validation.ExpectNode(t),Fit.Validation.ExpectDomElement(e);var n=t.parentElement,i=t.nextSibling;e.appendChild(t),null!==n&&(null===i?n.appendChild(e):n.insertBefore(e,i))},Fit.Dom.GetPosition=function(t,e){return Fit._internal.Dom.GetPosition(t,e)},Fit._internal.Dom.GetPosition=function(t,e,n){if(Fit.Validation.ExpectDomElement(t),Fit.Validation.ExpectBoolean(e,!0),Fit.Validation.ExpectBoolean(n,!0),!1===Fit.Dom.IsVisible(t))return null;var i={X:0,Y:0},o=t.getBoundingClientRect();return i.X=o.left,i.Y=o.top,!0!==n&&(i.X-=Fit._internal.Dom.GetPx(Fit.Dom.GetComputedStyle(t,"margin-left")),i.Y-=Fit._internal.Dom.GetPx(Fit.Dom.GetComputedStyle(t,"margin-top"))),!0===e?(i.X=Math.round(i.X),i.Y=Math.round(i.Y),i):(i.X+=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0,i.Y+=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,i.X=Math.round(i.X),i.Y=Math.round(i.Y),i)},Fit.Dom.GetRelativePosition=function(t){if(Fit.Validation.ExpectDomElement(t),"fixed"===Fit.Dom.GetComputedStyle(t,"position"))return Fit.Dom.GetPosition(t);if(!1===Fit.Dom.IsVisible(t))return null;for(var e=Fit.Dom.GetPosition(t),n=t.offsetParent;null!==n&&"static"===Fit.Dom.GetComputedStyle(n,"position");)n=n.offsetParent;if((n=n||document.documentElement)!==document.documentElement){var i=Fit._internal.Dom.GetPosition(n,!1,!0);"Firefox"===Fit.Browser.GetInfo().Name&&"TABLE"===n.tagName||"MSIE"===Fit.Browser.GetInfo().Name&&Fit.Browser.GetInfo().Version>=10&&"TABLE"===n.tagName||"Edge"===Fit.Browser.GetInfo().Name&&"TABLE"===n.tagName?(e.X=e.X-i.X,e.Y=e.Y-i.Y):(e.X=e.X-(i.X+Fit._internal.Dom.GetPx(Fit.Dom.GetComputedStyle(n,"border-left-width"))),e.Y=e.Y-(i.Y+Fit._internal.Dom.GetPx(Fit.Dom.GetComputedStyle(n,"border-top-width"))))}return e},Fit.Dom.GetScrollPosition=function(t){Fit.Validation.ExpectNode(t);var e={X:0,Y:0};for(1!==t.nodeType&&(t=t.parentElement);t;)e.X+=t.scrollLeft,e.Y+=t.scrollTop,t=t.parentElement;return e.X=Math.floor(e.X),e.Y=Math.floor(e.Y),e},Fit._internal.Dom.IsOffsetParentSupported=function(){if(void 0===Fit._internal.Dom.OffsetParentSupported){var t=document.createElement("div"),e=document.createElement("div");t.style.display="none",Fit.Dom.Add(document.body,t),Fit.Dom.Add(t,e),Fit._internal.Dom.OffsetParentSupported=null===e.offsetParent,Fit.Dom.Remove(t)}return Fit._internal.Dom.OffsetParentSupported},Fit._internal.Dom.GetPx=function(t){return t=t?parseInt(t):0,!0===isNaN(t)&&(t=0),t},Fit.DragDrop={},Fit.DragDrop.Draggable=function(t,e){Fit.Validation.ExpectElementNode(t),Fit.Validation.ExpectElementNode(e,!0);var n=t,i=e||null,o=this,a=null,r=null,l=null;this.Reset=function(){n.style.position="",n.style.left="",n.style.top=""},this.GetDomElement=function(){return n},this.GetElement=this.GetDomElement,this.OnDragStart=function(t){Fit.Validation.ExpectFunction(t),a=t},this.OnDragging=function(t){Fit.Validation.ExpectFunction(t),r=t},this.OnDragStop=function(t){Fit.Validation.ExpectFunction(t),l=t},Fit._internal.Core.EnsureStyles(),Fit.Dom.AddClass(n,"FitDragDropDraggable"),Fit.Events.AddHandler(null!==i?i:n,"mousedown",function(t){var e=t||window.event;if(null===Fit.DragDrop.Draggable._internal.active){Fit.Dom.AddClass(n,"FitDragDropDragging");var i=e.clientX||t.pageX,d=e.clientY||t.pageY;Fit.DragDrop.Draggable._internal.zIndex++,n.style.zIndex=Fit.DragDrop.Draggable._internal.zIndex;var u={Draggable:o,Positioning:"absolute"===Fit.Dom.GetComputedStyle(n,"position")?"absolute":"relative",Mouse:{Viewport:{X:-1,Y:-1},Document:{X:-1,Y:-1}},Position:{Viewport:{X:-1,Y:-1},Document:{X:-1,Y:-1},Offset:{X:-1,Y:-1}},Events:{OnDragStart:a,OnDragging:r,OnDragStop:l},OnSelectStart:document.onselectstart};document.onselectstart=function(){return!1},u.Mouse.Viewport.X=i,u.Mouse.Viewport.Y=d;var s=Fit.Dom.GetScrollPosition(n);u.Mouse.Document.X=i+s.X,u.Mouse.Document.Y=d+s.Y,u.Position.Viewport=Fit.Dom.GetPosition(n,!0),u.Position.Document=Fit.Dom.GetPosition(n);var c=Fit.Dom.GetComputedStyle(n,"left"),F=Fit.Dom.GetComputedStyle(n,"top");if(u.Position.Offset.X=c.indexOf("px")>-1?parseInt(c):0,u.Position.Offset.Y=F.indexOf("px")>-1?parseInt(F):0,Fit.DragDrop.Draggable._internal.active=u,!0===Fit.Dom.HasClass(n,"FitDragDropDropZone")){var m=null;Fit.Array.ForEach(Fit.DragDrop.DropZone._internal.dropzones,function(t){if(t.DropZone.GetElement()===n)return m=t,!1}),Fit.Array.Remove(Fit.DragDrop.DropZone._internal.dropzones,m),Fit.Array.Add(Fit.DragDrop.DropZone._internal.dropzones,m)}u.Events.OnDragStart&&u.Events.OnDragStart(n)}}),!1===Fit.DragDrop.Draggable._internal.mouseUpRegistered&&(Fit.DragDrop.Draggable._internal.mouseUpRegistered=!0,Fit.Events.AddHandler(document,"mouseup",function(t){if(null!==Fit.DragDrop.Draggable._internal.active){t||window.event;var e=Fit.DragDrop.Draggable._internal.active,n=Fit.DragDrop.Draggable._internal.active.Draggable,i=Fit.DragDrop.DropZone._internal.active,o=null!==i?i.DropZone:null;Fit.Dom.RemoveClass(n.GetElement(),"FitDragDropDragging"),Fit.DragDrop.Draggable._internal.active=null,null!==i&&(Fit.Dom.RemoveClass(o.GetElement(),"FitDragDropDropZoneActive"),Fit.DragDrop.DropZone._internal.active=null,i.OnDrop&&i.OnDrop(o,n)),e.Events.OnDragStop&&e.Events.OnDragStop(n),document.onselectstart=e.OnSelectStart}})),!1===Fit.DragDrop.Draggable._internal.mouseMoveRegistered&&(Fit.DragDrop.Draggable._internal.mouseMoveRegistered=!0,Fit.Events.AddHandler(document,"mousemove",function(t){if(null!==Fit.DragDrop.Draggable._internal.active){var e=t||window.event,n=Fit.DragDrop.Draggable._internal.active,i=n.Draggable.GetElement(),o=e.clientX||t.pageX,a=e.clientY||t.pageY,r=Fit.Dom.GetScrollPosition(i),l=o+r.X,d=a+r.Y;if("absolute"===Fit.DragDrop.Draggable._internal.active.Positioning){var u=n.Mouse.Viewport.X-n.Position.Viewport.X,s=n.Mouse.Viewport.Y-n.Position.Viewport.Y;i.style.position="absolute",i.style.left=l-u+"px",i.style.top=d-s+"px"}else{var c=l-n.Mouse.Document.X,F=d-n.Mouse.Document.Y,m=n.Position.Offset.X,f=n.Position.Offset.Y;i.style.position="relative",i.style.left=m+c+"px",i.style.top=f+F+"px"}n.Events.OnDragging&&n.Events.OnDragging(i);var p=null,E=null,h=null,v=-1,D=-1,y=Fit.DragDrop.DropZone._internal.active,g=null;Fit.Array.ForEach(Fit.DragDrop.DropZone._internal.dropzones,function(t){if(p=t.DropZone,E=p.GetElement(),!1!==Fit.Dom.IsVisible(E)){h=Fit.Dom.GetPosition(E,!0),v=h.X,D=h.Y;var e=null===g,n=null===g||Fit.Dom.GetDepth(E)>Fit.Dom.GetDepth(g.DropZone.GetElement()),i=!0===Fit.Dom.HasClass(E,"FitDragDropDragging"),r=o>v&&o<v+E.offsetWidth&&a>D&&a<D+E.offsetHeight;!1!==e&&!0!==n||!1!==i||!0!==r||(g=t)}}),null!==y&&g!==y&&(Fit.Dom.RemoveClass(y.DropZone.GetElement(),"FitDragDropDropZoneActive"),Fit.DragDrop.DropZone._internal.active=null,y.OnLeave&&y.OnLeave(y.DropZone)),null!==g&&g!==y&&(Fit.Dom.AddClass(g.DropZone.GetElement(),"FitDragDropDropZoneActive"),Fit.DragDrop.DropZone._internal.active=g,g.OnEnter&&g.OnEnter(g.DropZone))}}))},Fit.DragDrop.Draggable._internal={zIndex:1e4,mouseUpRegistered:!1,mouseMoveRegistered:!1,active:null},Fit.DragDrop.DropZone=function(t){Fit.Validation.ExpectElementNode(t);var e=t,n={DropZone:this,OnEnter:null,OnDrop:null,OnLeave:null};this.GetDomElement=function(){return e},this.GetElement=this.GetDomElement,this.OnEnter=function(t){Fit.Validation.ExpectFunction(t),n.OnEnter=t},this.OnDrop=function(t){Fit.Validation.ExpectFunction(t),n.OnDrop=t},this.OnLeave=function(t){Fit.Validation.ExpectFunction(t),n.OnLeave=t},Fit._internal.Core.EnsureStyles(),Fit.Dom.AddClass(e,"FitDragDropDropZone"),Fit.DragDrop.DropZone._internal.dropzones.push(n)},Fit.DragDrop.DropZone._internal={dropzones:[],active:null},Fit.Events={},Fit.Events.AddHandler=function(){var t=null,e=null,n=!1,i=null;3===arguments.length?(t=arguments[0],e=arguments[1],i=arguments[2]):4===arguments.length&&(t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3]),Fit.Validation.ExpectEventTarget(t),Fit.Validation.ExpectStringValue(e),Fit.Validation.ExpectBoolean(n),Fit.Validation.ExpectFunction(i),"#rooted"===e.toLowerCase()?(!0===n&&Fit.Validation.ThrowError("Event capturing is not supported for Rooted event"),Fit.Array.Add(Fit._internal.Events.OnRootedHandlers,{Element:t,Parent:t.parentElement,Event:e,Callback:i})):t.addEventListener?t.addEventListener(e,i,n):t.attachEvent&&("domcontentloaded"===e.toLowerCase()&&"MSIE"===Fit._internal.Events.Browser.Name&&8===Fit._internal.Events.Browser.Version?t.attachEvent("onreadystatechange",function(e){"complete"===t.readyState&&i(e)}):t.attachEvent("on"+e,i)),t._internal=t._internal||{},t._internal.Events=t._internal.Events||{Handlers:[]};var o=t._internal.Events.Handlers.length;return Fit.Array.Add(t._internal.Events.Handlers,{Event:e,Handler:i,UseCapture:n,Id:o}),"load"===e.toLowerCase()&&9===t.nodeType&&"complete"===t.readyState?i():"load"===e.toLowerCase()&&t.contentDocument&&"complete"===t.contentDocument.readyState?i():"load"===e.toLowerCase()&&t===window&&!0===Fit._internal.Events.OnReadyFired&&i(),o},Fit.Events.RemoveHandler=function(){var t=null,e=null,n=!1,i=null;if(2===arguments.length){if(Fit.Validation.ExpectEventTarget(arguments[0]),Fit.Validation.ExpectInteger(arguments[1]),void 0===(r=(t=arguments[0])._internal&&t._internal.Events&&t._internal.Events.Handlers?t._internal.Events.Handlers[arguments[1]]:void 0)&&Fit.Validation.Throw("No event handler with ID '"+arguments[0]+"' exists for this element"),null===r)return;e=r.Event,i=r.Handler,n=r.UseCapture}else 3===arguments.length?(t=arguments[0],e=arguments[1],i=arguments[2]):4===arguments.length&&(t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3]);if(Fit.Validation.ExpectEventTarget(t),Fit.Validation.ExpectStringValue(e),Fit.Validation.ExpectBoolean(n),Fit.Validation.ExpectFunction(i),"#rooted"===e.toLowerCase()){var o=Fit._internal.Events.OnRootedHandlers;Fit.Array.ForEach(o,function(o){if(t===o.Element&&e.toLowerCase()===o.Event.toLowerCase()&&i===o.Callback&&!1===n)return o.Removed=!0,!1})}else t.removeEventListener?t.removeEventListener(e,i,n):t.detachEvent&&t.detachEvent("on"+e,i);if(2===arguments.length)t._internal.Events.Handlers[arguments[1]]=null;else for(var a=0;a<t._internal.Events.Handlers.length;a++){var r;if(null!==(r=t._internal.Events.Handlers[a])&&e.toLowerCase()===r.Event.toLowerCase()&&i===r.Handler&&n===r.UseCapture){t._internal.Events.Handlers[a]=null;break}}},Fit.Events.PreventDefault=function(t){Fit.Validation.ExpectEvent(t,!0);var e=t||window.event;if(("click"===e.type||"mousedown"===e.type||"mouseup"===e.type)&&2===e.button){var n=Fit.Events.PreventDefault;Fit.Events.AddHandler(document,"contextmenu",!0,n),Fit.Events.AddHandler(document,"contextmenu",n),setTimeout(function(){Fit.Events.RemoveHandler(document,"contextmenu",!0,n),Fit.Events.RemoveHandler(document,"contextmenu",n)},0)}return e.preventDefault&&e.preventDefault(),e.returnValue=!1,!1},Fit.Events.StopPropagation=function(t){Fit.Validation.ExpectEvent(t,!0);var e=t||window.event;return e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0,!1},Fit.Events.Stop=function(t){return Fit.Events.PreventDefault(t),Fit.Events.StopPropagation(t),!1},Fit.Events.GetTarget=function(t){Fit.Validation.ExpectEvent(t,!0);var e=t||window.event,n=e.srcElement||e.target;return n||null},Fit.Events.GetEvent=function(t){return Fit.Validation.ExpectEvent(t,!0),t||window.event},Fit.Events.GetModifierKeys=function(){return!window.event||"keypress"!==window.event.type&&"keydown"!==window.event.type&&"keyup"!==window.event.type||(Fit._internal.Events.KeysDown.Shift=window.event.shiftKey,Fit._internal.Events.KeysDown.Ctrl=window.event.ctrlKey,Fit._internal.Events.KeysDown.Alt=window.event.altKey,Fit._internal.Events.KeysDown.Meta=window.event.metaKey),Fit.Core.Clone(Fit._internal.Events.KeysDown)},Fit.Events.GetPointerState=function(){!window.event||"click"!==window.event.type&&"mousedown"!==window.event.type&&"mouseup"!==window.event.type||("MSIE"===Fit._internal.Events.Browser.Name&&8===Fit._internal.Events.Browser.Version&&1===window.event.button||0===window.event.button?(Fit._internal.Events.Mouse.Buttons.Primary=!0,Fit._internal.Events.Mouse.Buttons.Secondary=!1):2===window.event.button&&(Fit._internal.Events.Mouse.Buttons.Secondary=!0,Fit._internal.Events.Mouse.Buttons.Primary=!1));var t=Fit._internal.Events.Mouse.Target;Fit._internal.Events.Mouse.Target=null;var e=Fit.Core.Clone(Fit._internal.Events.Mouse);return e.Target=t,Fit._internal.Events.Mouse.Target=t,e},Fit._internal.Events={},Fit._internal.Events.Browser=Fit.Browser.GetInfo(),Fit._internal.Events.KeysDown={Shift:!1,Ctrl:!1,Alt:!1,Meta:!1,KeyDown:-1,KeyUp:-1},Fit._internal.Events.Mouse={Buttons:{Primary:!1,Secondary:!1,Touch:!1},Coordinates:{ViewPort:{X:-1,Y:-1},Document:{X:-1,Y:-1}},Target:null},Fit._internal.Events.OnReadyHandlers=[],Fit._internal.Events.OnDomReadyHandlers=[],Fit._internal.Events.OnRootedHandlers=[],setInterval(function(){var t=[];Fit.Array.ForEach(Fit._internal.Events.OnRootedHandlers,function(e){!0!==e.Removed?!0===Fit.Dom.IsRooted(e.Element)&&e.Parent!==e.Element.parentElement&&(e.Parent=e.Element.parentElement,e.Callback(e.Element)):Fit.Array.Add(t,e)}),Fit.Array.ForEach(t,function(t){Fit.Array.Remove(Fit._internal.Events.OnRootedHandlers,t)})},100),Fit.Events.AddHandler(document,"keydown",!0,function(t){var e=Fit.Events.GetEvent(t);Fit._internal.Events.KeysDown.Shift=e.shiftKey,Fit._internal.Events.KeysDown.Ctrl=e.ctrlKey,Fit._internal.Events.KeysDown.Alt=e.altKey,Fit._internal.Events.KeysDown.Meta=e.metaKey,Fit._internal.Events.KeysDown.KeyUp=-1,Fit._internal.Events.KeysDown.KeyDown=e.keyCode}),Fit.Events.AddHandler(document,"keyup",!0,function(t){var e=Fit.Events.GetEvent(t);Fit._internal.Events.KeysDown.Shift=e.shiftKey,Fit._internal.Events.KeysDown.Ctrl=e.ctrlKey,Fit._internal.Events.KeysDown.Alt=e.altKey,Fit._internal.Events.KeysDown.Meta=e.metaKey,Fit._internal.Events.KeysDown.KeyUp=e.keyCode,Fit._internal.Events.KeysDown.KeyDown=-1}),Fit.Events.AddHandler(document,"mousedown",!0,function(t){var e=Fit.Events.GetEvent(t);"MSIE"===Fit._internal.Events.Browser.Name&&8===Fit._internal.Events.Browser.Version&&1===e.button||0===e.button?(Fit._internal.Events.Mouse.Buttons.Primary=!0,Fit._internal.Events.Mouse.Buttons.Secondary=!1):2===e.button&&(Fit._internal.Events.Mouse.Buttons.Secondary=!0,Fit._internal.Events.Mouse.Buttons.Primary=!1),Fit._internal.Events.Mouse.Target=Fit.Events.GetTarget(e)}),Fit.Events.AddHandler(document,"mouseup",!0,function(t){setTimeout(function(){Fit._internal.Events.Mouse.Buttons.Primary=!1,Fit._internal.Events.Mouse.Buttons.Secondary=!1,Fit._internal.Events.Mouse.Target=null},0)}),Fit.Events.AddHandler(document,"mouseout",!0,function(t){Fit._internal.Events.Mouse.Buttons.Primary=!1,Fit._internal.Events.Mouse.Buttons.Secondary=!1,Fit._internal.Events.Mouse.Target=null}),Fit.Events.AddHandler(document,"mousemove",function(t){var e=Fit.Events.GetEvent(t);if(null!==document.body){Fit._internal.Events.Mouse.Coordinates.ViewPort.X=Math.floor(e.clientX),Fit._internal.Events.Mouse.Coordinates.ViewPort.Y=Math.floor(e.clientY);var n=Fit.Dom.GetScrollPosition(document.body);Fit._internal.Events.Mouse.Coordinates.Document.X=Fit._internal.Events.Mouse.Coordinates.ViewPort.X+n.X,Fit._internal.Events.Mouse.Coordinates.Document.Y=Fit._internal.Events.Mouse.Coordinates.ViewPort.Y+n.Y}}),Fit.Events.AddHandler(document,"touchstart",!0,function(t){var e=Fit.Events.GetEvent(t);Fit._internal.Events.Mouse.Buttons.Touch=!0,Fit._internal.Events.Mouse.Coordinates.ViewPort.X=Math.floor(e.touches[0].clientX),Fit._internal.Events.Mouse.Coordinates.ViewPort.Y=Math.floor(e.touches[0].clientY);var n=Fit.Dom.GetScrollPosition(document.body);Fit._internal.Events.Mouse.Coordinates.Document.X=Fit._internal.Events.Mouse.Coordinates.ViewPort.X+n.X,Fit._internal.Events.Mouse.Coordinates.Document.Y=Fit._internal.Events.Mouse.Coordinates.ViewPort.Y+n.Y}),Fit.Events.AddHandler(document,"touchend",!0,function(t){Fit.Events.GetEvent(t);Fit._internal.Events.Mouse.Buttons.Touch=!1}),Fit.Events.AddHandler(document,"touchcancel",!0,function(t){Fit.Events.GetEvent(t);Fit._internal.Events.Mouse.Buttons.Touch=!1}),Fit.Events.AddHandler(document,"touchmove",function(t){var e=Fit.Events.GetEvent(t);Fit._internal.Events.Mouse.Coordinates.ViewPort.X=Math.floor(e.touches[0].clientX),Fit._internal.Events.Mouse.Coordinates.ViewPort.Y=Math.floor(e.touches[0].clientY);var n=Fit.Dom.GetScrollPosition(document.body);Fit._internal.Events.Mouse.Coordinates.Document.X=Fit._internal.Events.Mouse.Coordinates.ViewPort.X+n.X,Fit._internal.Events.Mouse.Coordinates.Document.Y=Fit._internal.Events.Mouse.Coordinates.ViewPort.Y+n.Y}),Fit._internal.Events.MutationObservers=[],Fit._internal.Events.MutationObserverIds=-1,Fit._internal.Events.MutationObserverIntervalId=-1,Fit.Events.AddMutationObserver=function(t,e,n){Fit.Validation.ExpectDomElement(t),Fit.Validation.ExpectFunction(e),Fit.Validation.ExpectBoolean(n,!0),0===Fit._internal.Events.MutationObservers.length&&(Fit.Events.AddHandler(document,"click",Fit._internal.Events.CheckMutations),Fit.Events.AddHandler(document,"mousedown",Fit._internal.Events.CheckMutations),Fit.Events.AddHandler(document,"mouseup",Fit._internal.Events.CheckMutations),Fit.Events.AddHandler(document,"keypress",Fit._internal.Events.CheckMutations),Fit.Events.AddHandler(document,"keyup",Fit._internal.Events.CheckMutations),Fit.Events.AddHandler(document,"touchstart",Fit._internal.Events.CheckMutations),Fit.Events.AddHandler(document,"touchend",Fit._internal.Events.CheckMutations),Fit.Events.AddHandler(document,"touchcancel",Fit._internal.Events.CheckMutations),Fit._internal.Events.MutationObserverIntervalId=setInterval(Fit._internal.Events.CheckMutations,1e3));var i=0,o=t.offsetWidth+"x"+t.offsetHeight;if(!0===n)i=Fit.String.Hash(t.outerHTML+o);else{var a=t.cloneNode(!1);i=Fit.String.Hash(a.outerHTML+o)}return Fit._internal.Events.MutationObserverIds++,Fit.Array.Add(Fit._internal.Events.MutationObservers,{Element:t,Observer:e,Hash:i,Deep:!0===n,Id:Fit._internal.Events.MutationObserverIds}),Fit._internal.Events.MutationObserverIds},Fit.Events.RemoveMutationObserver=function(){var t,e,n,i=void 0;arguments.length>1?(t=arguments[0],e=arguments[1],n=arguments[2],Fit.Validation.ExpectDomElement(t),Fit.Validation.ExpectFunction(e),Fit.Validation.ExpectBoolean(n,!0)):(i=arguments[0],Fit.Validation.ExpectInteger(i));var o=null;Fit.Array.ForEach(Fit._internal.Events.MutationObservers,function(a){if(!0===Fit.Validation.IsSet(i)&&a.Id===i||a.Element===t&&a.Observer===e&&a.Deep===(!0===Fit.Validation.IsSet(n)&&n))return o=a,!1}),null!==o&&Fit.Array.Remove(Fit._internal.Events.MutationObservers,o),0===Fit._internal.Events.MutationObservers.length&&(Fit.Events.RemoveHandler(document,"click",Fit._internal.Events.CheckMutations),Fit.Events.RemoveHandler(document,"mousedown",Fit._internal.Events.CheckMutations),Fit.Events.RemoveHandler(document,"mouseup",Fit._internal.Events.CheckMutations),Fit.Events.RemoveHandler(document,"keypress",Fit._internal.Events.CheckMutations),Fit.Events.RemoveHandler(document,"keyup",Fit._internal.Events.CheckMutations),Fit.Events.RemoveHandler(document,"touchstart",Fit._internal.Events.CheckMutations),Fit.Events.RemoveHandler(document,"touchend",Fit._internal.Events.CheckMutations),Fit.Events.RemoveHandler(document,"touchcancel",Fit._internal.Events.CheckMutations),clearInterval(Fit._internal.Events.MutationObserverIntervalId))},Fit._internal.Events.CheckMutations=function(){var t=[];Fit.Array.ForEach(Fit._internal.Events.MutationObservers,function(e){var n=0,i=e.Element.offsetWidth+"x"+e.Element.offsetHeight;if(!0===e.Deep)n=Fit.String.Hash(e.Element.outerHTML+i);else{var o=e.Element.cloneNode(!1);n=Fit.String.Hash(o.outerHTML+i)}if(e.Hash!==n){e.Hash=n;var a=window.disconnect;window.disconnect=function(){Fit.Array.Add(t,e)};var r=null;try{e.Observer(e.Element)}catch(t){r=t}if(a)window.disconnect=a;else try{delete window.disconnect}catch(t){window.disconnect=void 0}null!==r&&Fit.Validation.Throw(r)}}),Fit.Array.ForEach(t,function(t){Fit.Events.RemoveMutationObserver(t.Element,t.Observer,t.Deep)})},Fit.Events.OnReady=function(t){Fit.Validation.ExpectFunction(t),!0===Fit._internal.Events.OnReadyFired?t():Fit._internal.Events.OnReadyHandlers.push(t)},Fit.Events.AddHandler(window,"load",function(){Fit._internal.Events.OnReadyFired=!0,Fit.Array.ForEach(Fit._internal.Events.OnReadyHandlers,function(t){t()}),Fit.Array.Clear(Fit._internal.Events.OnReadyHandlers)}),Fit.Events.OnDomReady=function(t){Fit.Validation.ExpectFunction(t),!0===Fit._internal.Events.OnDomReadyFired?t():Fit._internal.Events.OnDomReadyHandlers.push(t)},Fit.Events.AddHandler(document,"DOMContentLoaded",function(){Fit._internal.Events.OnDomReadyFired=!0,Fit.Array.ForEach(Fit._internal.Events.OnDomReadyHandlers,function(t){t()}),Fit.Array.Clear(Fit._internal.Events.OnDomReadyHandlers)}),Fit.Http={},Fit._internal.Http={},Fit._internal.Http.JsonpRequest={},Fit._internal.Http.JsonpRequest.Callbacks={},Fit.Http.Request=function(t){Fit.Validation.ExpectStringValue(t);var e=this,n=t,i=function(){{if(window.XMLHttpRequest)return new XMLHttpRequest;if(window.ActiveXObject)return new ActiveXObject("Microsoft.XMLHTTP")}throw new Error("Http Request object not supported")}(),o={},a={},r="",l="",d=[],u=[],s=[],c=[],F=[];i.onreadystatechange=function(){Fit.Array.ForEach(d,function(t){t(e)}),4===i.readyState&&(0===i.status?Fit.Array.ForEach(F,function(t){t(e)}):i.status>=200&&i.status<=299?Fit.Array.ForEach(s,function(t){t(e)}):Fit.Array.ForEach(c,function(t){t(e)}))},this.AddHeader=function(t,e){Fit.Validation.ExpectStringValue(t),Fit.Validation.ExpectString(e),o[t]=e},this.SetData=function(t){Fit.Validation.ExpectString(t,!0),r=!0===Fit.Validation.IsSet(t)?t:""},this.GetData=function(){return r},this.AddData=function(t,e,n){Fit.Validation.ExpectStringValue(t),Fit.Validation.ExpectString(e),Fit.Validation.ExpectBoolean(n,!0),r+=(""!==r?"&":"")+t+"="+(!1===n?e:encodeURIComponent(e).replace(/%20/g,"+"))},this.Method=function(t){return Fit.Validation.ExpectString(t,!0),!0===Fit.Validation.IsSet(t)&&(l=t),l},this.Url=function(t){return Fit.Validation.ExpectStringValue(t,!0),!0===Fit.Validation.IsSet(t)&&(n=t),n},this.Start=function(){var t=!1;if(Fit.Array.ForEach(u,function(n){!1===n(e)&&(t=!0)}),!0!==t){var F=""!==l?l:""!==r?"POST":"GET",m=d.length>0||s.length>0||c.length>0;i.open(F,n,m);var f=!1;for(var p in o)i.setRequestHeader(p,o[p]),f=!0;Fit.Array.ForEach(a,function(t){i[t]=a[t]}),"POST"!==F&&"PUT"!==F||!1!==f||i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.send(r)}},this.Abort=function(){i.abort()},this.GetResponseXml=function(){return i.responseXML},this.GetResponseText=function(){return i.responseText},this.GetResponseJson=function(){return""!==i.responseText?JSON.parse(i.responseText):null},this.GetResponse=function(){return i.responseType&&"text"!==i.responseType||"string"!=typeof i.responseText?i.response:i.responseText},this.GetCurrentState=function(){return i.readyState},this.GetHttpStatus=function(){return i.status},this.GetResponseHeaders=function(){var t=[];return""===i.getAllResponseHeaders()?t:(Fit.Array.ForEach(Fit.String.Trim(i.getAllResponseHeaders()).split("\n"),function(e){var n=e.split(":");Fit.Array.Add(t,{Key:Fit.String.Trim(n[0]),Value:Fit.String.Trim(n[1])})}),t)},this.GetResponseHeader=function(t){return Fit.Validation.ExpectString(t),i.getResponseHeader(t)},this.OnStateChange=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(d,t)},this.SetStateListener=this.OnStateChange,this.OnRequest=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(u,t)},this.OnSuccess=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(s,t)},this.OnFailure=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(c,t)},this.OnAbort=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(F,t)},this.RequestProperties=function(t){return Fit.Validation.ExpectObject(t,!0),!0===Fit.Validation.IsSet(t)&&(a=t),a}},Fit.Http.JsonRequest=function(t){Fit.Validation.ExpectStringValue(t),Fit.Core.Extend(this,Fit.Http.Request).Apply(t);var e=this,n=null;var i=e.SetData;this.SetData=function(t){Fit.Validation.ExpectIsSet(t),n=t,i(JSON.stringify(n))},this.GetData=function(t){return n},this.Start=Fit.Core.CreateOverride(this.Start,function(){i(JSON.stringify(n)),base()}),this.AddData=function(t,e,n){Fit.Validation.ThrowError("Use SetData(..) to set JSON request data for JSON WebService")};var o=e.GetResponseJson;this.GetResponseJson=function(){var e=o();return-1!==t.toLowerCase().indexOf(".asmx/")&&e&&e.d&&(e=e.d),e},e.AddHeader("Content-Type","application/json; charset=UTF-8"),e.AddHeader("X-Requested-With","XMLHttpRequest")},Fit.Http.JsonpRequest=function(t,e){Fit.Validation.ExpectStringValue(t),Fit.Validation.ExpectStringValue(e,!0);var n=this,i=t,o=!0===Fit.Validation.IsSet(e)?e:"callback",a=null,r={},l=3e4,d=-1,u=null,s=[],c=[],F=[];function m(t){var e=!1;return Fit.Array.ForEach(t,function(t){!1===t(n)&&(e=!0)}),!e}this.Url=function(t){return Fit.Validation.ExpectStringValue(t,!0),!0===Fit.Validation.IsSet(t)&&(i=t),i},this.Callback=function(t){return Fit.Validation.ExpectStringValue(t,!0),!0===Fit.Validation.IsSet(t)&&(o=t),o},this.Timeout=function(t){return Fit.Validation.ExpectInteger(t,!0),!0===Fit.Validation.IsSet(t)&&(l=t),l},this.SetParameter=function(t,e,n){Fit.Validation.ExpectStringValue(t),Fit.Validation.ExpectString(e),Fit.Validation.ExpectBoolean(n,!0),r[t]=!1===n?e:encodeURIComponent(e).replace(/%20/g,"+")},this.GetParameter=function(t){Fit.Validation.ExpectString(t);var e=r[t];return void 0!==e?e:null},this.GetParameters=function(){var t=[];return Fit.Array.ForEach(r,function(e){Fit.Array.Add(t,e)}),t},this.Start=function(){if(!1!==m(s)){u=null,-1!==d&&(clearTimeout(d),d=-1,Fit._internal.Http.JsonpRequest.Callbacks[a]=function(t){}),a="CB"+Fit.Data.CreateGuid(!1),Fit._internal.Http.JsonpRequest.Callbacks[a]=function(t){clearTimeout(d),d=-1,u=t,delete Fit._internal.Http.JsonpRequest.Callbacks[a],m(c)},d=setTimeout(function(){d=-1,Fit._internal.Http.JsonpRequest.Callbacks[a]=function(t){},m(F)},l);var t=i,e="Fit._internal.Http.JsonpRequest.Callbacks."+a;t+=(-1===t.indexOf("?")?"?":"&")+o+"="+e,Fit.Array.ForEach(r,function(e){t+="&"+e+"="+r[e]});var n=document.createElement("script");n.type="text/javascript",n.src=t,document.getElementsByTagName("head")[0].appendChild(n)}},this.GetResponse=function(){return u},this.OnRequest=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(s,t)},this.OnSuccess=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(c,t)},this.OnTimeout=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(F,t)}},Fit.Http.DotNetJsonRequest=Fit.Http.JsonRequest,Fit.Language={},Fit.Language.Translations={},Fit.Language.Translations.Required="Field is required",Fit.Language.Translations.InvalidSelection="Invalid selection",Fit.Language.Translations.SelectFile="Select file",Fit.Language.Translations.SelectFiles="Select file(s)",Fit.Language.Translations.Ok="OK",Fit.Language.Translations.Cancel="Cancel",Fit.Loader={},Fit.Loader.ExecuteScript=function(src,onSuccess,onFailure,context){Fit.Validation.ExpectStringValue(src),Fit.Validation.ExpectFunction(onSuccess,!0),Fit.Validation.ExpectFunction(onFailure,!0);var r=new Fit.Http.Request(src);r.OnSuccess(function(sender){var js=r.GetResponseText(),error=null;if(!1===Fit.Validation.IsSet(context)||context===window)try{eval(js)}catch(t){error=t}else{var args="",parms="";for(var prop in context||{})args+=(""!==args?", ":"")+prop,parms+=(""!==parms?", ":"")+"this."+prop;try{eval("(function() { (function("+args+") { "+js+" })("+parms+"); })").call(context||this)}catch(t){error=t}}null===error&&!0===Fit.Validation.IsSet(onSuccess)?onSuccess(src):null!==error&&(window.console&&(console.log(error.message),console.log(error.stack),console.log(error)),!0===Fit.Validation.IsSet(onFailure)&&onFailure(src))}),r.OnFailure(function(t){!0===Fit.Validation.IsSet(onFailure)&&onFailure(src)}),r.Start()},Fit.Loader.LoadScript=function(t,e){Fit.Validation.ExpectStringValue(t),Fit.Validation.ExpectFunction(e,!0),arguments.length>2&&Fit.Validation.ThrowError("Argument(s) do not match function signature - did you intend to use Fit.Loader.ExecuteScript instead ?");var n=document.createElement("script");n.type="text/javascript",n.charset="UTF-8",!0===Fit.Validation.IsSet(e)&&("MSIE"!==Fit.Browser.GetBrowser()||"MSIE"===Fit.Browser.GetBrowser()&&Fit.Browser.GetVersion()>=9)?(n.onload=function(){e(t)},n.onerror=function(){e(t)}):!0===Fit.Validation.IsSet(e)&&"MSIE"===Fit.Browser.GetBrowser()&&Fit.Browser.GetVersion()<=8&&(n.onreadystatechange=function(){"complete"!==this.readyState&&"loaded"!==this.readyState||e(t)}),n.src=t,document.getElementsByTagName("head")[0].appendChild(n)},Fit.Loader.LoadScripts=function(t,e,n){if(Fit.Validation.ExpectArray(t),Fit.Validation.ExpectFunction(e,!0),Fit.Validation.ExpectBoolean(n,!0),!0!==n)for(var i=0;i<t.length;i++)Fit.Validation.ExpectStringValue(t[i].source),Fit.Validation.ExpectFunction(t[i].loaded,!0);var o=null;for(i=0;i<t.length;i++)if(!0!==t[i].handled){o=t[i];break}null!==o?(o.handled=!0,Fit.Loader.LoadScript(o.source,function(){if(!0===Fit.Validation.IsSet(o.loaded))try{o.loaded(o)}catch(t){window.console&&(console.log(t.message),console.log(t.stack),console.log(t))}Fit.Loader.LoadScripts(t,e,!0)})):!0===Fit.Validation.IsSet(e)&&e(t)},Fit.Loader.LoadStyleSheet=function(t,e){Fit.Validation.ExpectStringValue(t),Fit.Validation.ExpectFunction(e,!0);var n=document.createElement("link");n.type="text/css",n.rel="stylesheet",!0===Fit.Validation.IsSet(e)&&("MSIE"!==Fit.Browser.GetBrowser()||"MSIE"===Fit.Browser.GetBrowser()&&Fit.Browser.GetVersion()>=9)?(n.onload=function(){e(t)},n.onerror=function(){e(t)}):!0===Fit.Validation.IsSet(e)&&"MSIE"===Fit.Browser.GetBrowser()&&Fit.Browser.GetVersion()<=8&&(n.onreadystatechange=function(){"complete"!==this.readyState&&"loaded"!==this.readyState||e(t)}),n.href=t,document.getElementsByTagName("head")[0].appendChild(n)},Fit.Loader.LoadStyleSheets=function(t,e){Fit.Validation.ExpectArray(t),Fit.Validation.ExpectFunction(e,!0);for(var n=0;n<t.length;n++)Fit.Validation.ExpectStringValue(t[n].source),Fit.Validation.ExpectFunction(t[n].loaded,!0);if(0!==t.length)for(n=0;n<t.length;n++)Fit.Loader.LoadStyleSheet(t[n].source,function(n){for(var i=0;i<t.length;i++)if(t[i].source===n){if(t[i].handled=!0,!0===Fit.Validation.IsSet(t[i].loaded))try{t[i].loaded(t[i])}catch(t){window.console&&(console.log(t.message),console.log(t.stack),console.log(t))}break}for(i=0;i<t.length;i++)if(!0!==t[i].handled)return;!0===Fit.Validation.IsSet(e)&&e(t)});else!0===Fit.Validation.IsSet(e)&&e(t)},Fit.Template=function(t){Fit.Validation.ExpectBoolean(t,!0);var e=this,n="",i=null,o=[],a=[];function r(t){Fit.Validation.ExpectString(t);var i={},o=l(n=t);Fit.Array.ForEach(o,function(t){i[t]=o[t]});var a=d(n);Fit.Array.ForEach(a,function(t){i[t]=a[t]}),e.Content=i}function l(t){Fit.Validation.ExpectString(t);for(var e,n=/<!-- LIST (\S+) -->[\S\s]*<!-- \/LIST \1 -->/g,i={};e=n.exec(t);)i[e[1]]=u(e[1],e[0]);return i}function d(t){Fit.Validation.ExpectString(t);t=t.replace(/<!-- LIST (\S+) -->[\S\s]*<!-- \/LIST \1 -->/g,"");for(var e,n=/\{\[(\S+?)\]\}/g,i={};e=n.exec(t);)i[e[1]]=null;return i}function u(t,e){Fit.Validation.ExpectString(t),Fit.Validation.ExpectString(e);var n={_internal:{}};return n._internal.Id=t,n._internal.Block=e,n._internal.Html=e.replace("\x3c!-- LIST "+t+" --\x3e","").replace("\x3c!-- /LIST "+t+" --\x3e",""),n._internal.Items=[],n._internal.Elements=o,n._internal.IsFitTemplate=!0,n.AddItem=function(){var t=d(n._internal.Html),e=l(n._internal.Html);return Fit.Array.ForEach(e,function(n){t[n]=e[n]}),Fit.Array.Add(n._internal.Items,t),t},n.GetItems=function(){return n._internal.Items},n.RemoveItem=function(t){Fit.Array.Remove(n._internal.Items,t)},n.Clear=function(){Fit.Array.Clear(n._internal.Items)},n.toString=function(){var t="";var e=n._internal.Html;return Fit.Array.ForEach(n._internal.Items,function(i){t+=function t(e,i){return Fit.Array.ForEach(i,function(o){var a=i[o];if(a)if(void 0!==a._internal&&!0===a._internal.IsFitTemplate){var r="";Fit.Array.ForEach(a._internal.Items,function(e){r+=t(a._internal.Html,e)}),e=e.replace(a._internal.Block,r)}else if("object"==typeof a&&(a instanceof Element||a instanceof Text)){var l=Fit.Data.CreateGuid();Fit.Array.Add(n._internal.Elements,{Id:l,Element:a}),e=e.replace("{["+o+"]}","<var class='FitTemplate' id='PH"+l+"'></var>")}else e=e.replace("{["+o+"]}",a)}),e}(e,i)}),t},n}this.Content=null,this.LoadHtml=function(t){Fit.Validation.ExpectString(t),r(t)},this.LoadUrl=function(t,n){Fit.Validation.ExpectString(t),Fit.Validation.ExpectFunction(n);var i=new Fit.Http.Request(t);i.OnSuccess(function(t){r(i.GetResponseText()),n(e,i.GetResponseText())}),i.Start()},this.Reset=function(){r(n),a=[]},this.GetHtml=function(){return e.toString()},this.Render=function(t){Fit.Validation.ExpectDomElement(t,!0);var n=e.toString(),r=Fit.Dom.CreateElement("<div>"+n+"</div>");Fit.Array.ForEach(o,function(t){var e=r.querySelector("var.FitTemplate[id='PH"+t.Id+"']");null!==e&&Fit.Dom.Replace(e,t.Element)}),Fit.Array.ForEach(a,function(t){if(null!==t){var e=r.querySelector("#"+t.ElementId);null!==e&&Fit.Events.AddHandler(e,t.EventType,t.Callback)}});var l=null!==i?i:t,d=Fit.Array.Copy(r.childNodes);if(!0===Fit.Validation.IsSet(l))Fit.Array.ForEach(d,function(t){Fit.Dom.Add(l,t)});else{var u=document.scripts[document.scripts.length-1];Fit.Array.ForEach(d,function(t){Fit.Dom.InsertBefore(u,t)})}if(null!==i)if(!0===Fit.Validation.IsSet(t))Fit.Dom.Add(t,i);else{u=document.scripts[document.scripts.length-1];Fit.Dom.InsertBefore(u,i)}},this.AddEventHandler=function(t,e,n){return Fit.Validation.ExpectStringValue(t),Fit.Validation.ExpectStringValue(e),Fit.Validation.ExpectFunction(n),Fit.Array.Add(a,{ElementId:t,EventType:e,Callback:n}),a.length-1},this.RemoveEventHandler=function(t){Fit.Validation.ExpectInteger(t),a.length-1>=t&&(a[t]=null)},this.Update=function(){if(null===i)throw"UpdateTemplateError: Template has not been configured to allow updates";var t=e.toString(),n=Fit.Dom.CreateElement("<div>"+t+"</div>");Fit.Array.ForEach(o,function(t){var e=n.querySelector("var.FitTemplate[id='PH"+t.Id+"']");null!==e&&Fit.Dom.Replace(e,t.Element)}),Fit.Array.ForEach(a,function(t){if(null!==t){var e=n.querySelector("#"+t.ElementId);null!==e&&Fit.Events.AddHandler(e,t.EventType,t.Callback)}}),i.innerHTML="";var r=Fit.Array.Copy(n.childNodes);Fit.Array.ForEach(r,function(t){Fit.Dom.Add(i,t)})},this.toString=function(){var t=n;return Fit.Array.Clear(o),Fit.Array.ForEach(e.Content,function(n){var i=e.Content[n];if(i)if(void 0!==i._internal&&!0===i._internal.IsFitTemplate)t=t.replace(i._internal.Block,i.toString());else if("object"==typeof i&&(i instanceof Element||i instanceof Text)){var a=Fit.Data.CreateGuid();Fit.Array.Add(o,{Id:a,Element:i}),t=t.replace("{["+n+"]}","<var class='FitTemplate' id='PH"+a+"'></var>")}else t=t.replace("{["+n+"]}",i)}),t=t.replace(/\{\[(\S+?)\]\}/g,"")},!0===t&&(i=document.createElement("div"))},Fit.Controls.Button=function(t){Fit.Validation.ExpectStringValue(t,!0),!0===Fit.Validation.IsSet(t)&&(void 0!==Fit._internal.ControlBase.Controls[t]&&Fit.Validation.ThrowError("Control with ID '"+t+"' has already been defined - Control IDs must be unique!"),Fit._internal.ControlBase.Controls[t]=this);var e=this,n=t||null,i=null,o=null,a=null,r=null,l={Value:-1,Unit:"px"},d={Value:-1,Unit:"px"},u=[];this.GetId=function(){return n},this.Title=function(t){return Fit.Validation.ExpectString(t,!0),!0===Fit.Validation.IsSet(t)&&(Fit.Dom.Data(i,"title",""!==t?t:null),r.innerHTML=t),null!==Fit.Dom.Data(i,"title")?Fit.Dom.Data(i,"title"):""},this.Icon=function(t){return Fit.Validation.ExpectString(t,!0),!0===Fit.Validation.IsSet(t)&&(Fit.Dom.Data(i,"icon",""!==t?t:null),a.className=""!==t?"fa "+(0!==t.indexOf("fa-")?"fa-":"")+t:""),null!==Fit.Dom.Data(i,"icon")?Fit.Dom.Data(i,"icon"):""},this.Type=function(t){return Fit.Validation.ExpectStringValue(t,!0),!0===Fit.Validation.IsSet(t)&&(!1===Fit.Validation.IsSet(Fit.Controls.ButtonType[t])&&Fit.Validation.ThrowError("Unsupported button type specified - use e.g. Fit.Controls.ButtonType.Default"),Fit.Dom.Data(i,"type",t)),Fit.Dom.Data(i,"type")},this.Enabled=function(t){return Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t)&&(Fit.Dom.Data(i,"enabled",!0===t?"true":"false"),i.tabIndex=!0===t?0:-1),"true"===Fit.Dom.Data(i,"enabled")},this.Focused=function(t){return Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t)&&(!0===t?i.focus():i.blur()),Fit.Dom.GetFocused()===i||Fit.Dom.GetFocused()&&Fit.Dom.Contained(i,Fit.Dom.GetFocused())},this.Width=function(t,e){return Fit.Validation.ExpectNumber(t,!0),Fit.Validation.ExpectStringValue(e,!0),!0===Fit.Validation.IsSet(t)&&(t>-1?(l={Value:t,Unit:!0===Fit.Validation.IsSet(e)?e:"px"},i.style.width=l.Value+l.Unit):(l={Value:-1,Unit:"px"},i.style.width="")),l},this.Height=function(t,e){return Fit.Validation.ExpectNumber(t,!0),Fit.Validation.ExpectStringValue(e,!0),!0===Fit.Validation.IsSet(t)&&(t>-1?(d={Value:t,Unit:!0===Fit.Validation.IsSet(e)?e:"px"},i.style.height=d.Value+d.Unit,o.style.position="relative"):(d={Value:-1,Unit:"px"},i.style.height="",o.style.position="")),d},this.OnClick=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(u,t)},this.Click=function(){Fit.Array.ForEach(u,function(t){t(e)})},this.GetDomElement=function(){return i},this.Render=function(t){if(Fit.Validation.ExpectDomElement(t,!0),!0===Fit.Validation.IsSet(t))Fit.Dom.Add(t,i);else{var e=document.scripts[document.scripts.length-1];Fit.Dom.InsertBefore(e,i)}},this.Dispose=function(){Fit.Dom.Remove(i),e=n=i=o=a=r=l=d=u=null,!0===Fit.Validation.IsSet(t)&&delete Fit._internal.ControlBase.Controls[t]},Fit._internal.Core.EnsureStyles(),i=document.createElement("div"),null!==n&&(i.id=n),Fit.Events.AddHandler(i,"click",function(t){!0===e.Enabled()&&e.Click()}),Fit.Events.AddHandler(i,"keydown",function(t){var n=Fit.Events.GetEvent(t);!0!==e.Enabled()||13!==n.keyCode&&32!==n.keyCode||(e.Click(),Fit.Events.PreventDefault(n))}),Fit.Dom.AddClass(i,"FitUiControl"),Fit.Dom.AddClass(i,"FitUiControlButton"),o=document.createElement("div"),Fit.Dom.Add(i,o),a=document.createElement("span"),Fit.Dom.Add(o,a),r=document.createElement("span"),Fit.Dom.Add(o,r),e.Enabled(!0),e.Type(Fit.Controls.ButtonType.Default)},Fit.Controls.ButtonType={Default:"Default",Primary:"Primary",Success:"Success",Info:"Info",Warning:"Warning",Danger:"Danger"},Fit.Controls.Button.Type=Fit.Controls.ButtonType,Fit.Controls.CheckBox=function(t){Fit.Validation.ExpectStringValue(t),Fit.Core.Extend(this,Fit.Controls.ControlBase).Apply(t);var e=this,n=null,i=null,o={Value:-1,Unit:"px"},a=!1,r="MSIE"===Fit.Browser.GetInfo().Name&&8===Fit.Browser.GetInfo().Version;this.Focused=function(t){return Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t)&&(!0===t?e.GetDomElement().focus():e.GetDomElement().blur()),Fit.Dom.GetFocused()===e.GetDomElement()||Fit.Dom.GetFocused()&&Fit.Dom.Contained(e.GetDomElement(),Fit.Dom.GetFocused())},this.Value=function(t){if(Fit.Validation.ExpectString(t,!0),!0===Fit.Validation.IsSet(t)){var n=t.toLowerCase();"true"===n?e.Checked(!0):"false"===n&&e.Checked(!1)}return!0===e.Checked()?"true":"false"},this.Checked=function(t,i){if(Fit.Validation.ExpectBoolean(t,!0),Fit.Validation.ExpectBoolean(i,!0),!0===Fit.Validation.IsSet(t)){var o="true"===Fit.Dom.Data(e.GetDomElement(),"checked");Fit.Dom.Data(e.GetDomElement(),"checked",t.toString()),!0!==i&&(a="true"===Fit.Dom.Data(e.GetDomElement(),"checked")),o!==t&&(!function(){if(!0===r){var t=Fit.Dom.GetFocused(),e=document.createElement("");Fit.Dom.Replace(n,e),Fit.Dom.Replace(e,n),Fit.Dom.GetFocused()!==t&&t.focus()}}(),e._internal.FireOnChange())}return"true"===Fit.Dom.Data(e.GetDomElement(),"checked")},this.Width=function(t,n){return Fit.Validation.ExpectNumber(t,!0),Fit.Validation.ExpectStringValue(n,!0),!0===Fit.Validation.IsSet(t)&&(t>-1?(o={Value:t,Unit:!0===Fit.Validation.IsSet(n)?n:"px"},e.GetDomElement().style.width=o.Value+o.Unit):(o={Value:-1,Unit:"px"},e.GetDomElement().style.width="")),o},this.IsDirty=function(){return a!==e.Checked()},this.Clear=function(){e.Checked(!1)},this.Dispose=Fit.Core.CreateOverride(this.Dispose,function(){e=n=i=o=a=r=null,base()}),this.IsValid=Fit.Core.CreateOverride(this.IsValid,function(){return(!0!==e.Required()||!1!==e.Checked())&&base()}),this._internal.Validate=Fit.Core.CreateOverride(this._internal.Validate,function(){!0===e.Required()&&!1===e.Checked()&&e._internal.Data("errormessage",Fit.Language.Translations.Required),base()}),this.Label=function(t){return Fit.Validation.ExpectString(t,!0),!0===Fit.Validation.IsSet(t)&&(i.innerHTML=t),i.innerHTML},this.Enabled=function(t){return Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t)&&(Fit.Dom.Data(e.GetDomElement(),"enabled",t.toString()),e.GetDomElement().tabIndex=!0===t?0:-1),"true"===Fit.Dom.Data(e.GetDomElement(),"enabled")},e.AddCssClass("FitUiControlCheckBox"),e.GetDomElement().tabIndex=0,n=document.createElement("div"),Fit.Dom.AddClass(n,"fa"),Fit.Dom.AddClass(n,"fa-check"),Fit.Events.AddHandler(e.GetDomElement(),"click",function(t){!0===e.Enabled()&&e.Checked(!e.Checked(),!0)}),Fit.Events.AddHandler(e.GetDomElement(),"keydown",function(t){var n=Fit.Events.GetEvent(t);!0===e.Enabled()&&32===n.keyCode&&(e.Checked(!e.Checked(),!0),Fit.Events.PreventDefault(n))}),i=document.createElement("span"),e._internal.AddDomElement(n),e._internal.AddDomElement(i),e.Enabled(!0),e.Checked(!1),e.Width(-1)},Fit.Controls.ContextMenu=function(){var t=this,e=new Fit.Controls.TreeView("ContextMenuTreeView_"+Fit.Data.CreateGuid()),n=null,i=!0,o=!0,a="MSIE"===Fit.Browser.GetInfo().Name&&8===Fit.Browser.GetInfo().Version,r=[],l=[],d=[],u=[];function s(e,n){var i=!1;return Fit.Array.ForEach(e,function(e){!1===e(t,n)&&(i=!0)}),!i}function c(t,e){Fit.Validation.ExpectInstanceArray(t,Fit.Controls.TreeViewNode),Fit.Validation.ExpectInstance(e,Fit.Controls.TreeViewNode);var n=null;return Fit.Array.ForEach(t,function(t){if(!0===t.Expanded()&&t!==e)return n=t,!1}),n}function F(t){if(Fit.Validation.ExpectDomElement(t),t.getElementsByTagName("ul").length>0){var e=t.getElementsByTagName("ul")[0];Fit.Dom.Data(e,"viewportcollision",null),m(function(){var t=Fit.Dom.GetPosition(e,!0);Fit.Browser.GetViewPortDimensions().Height<t.Y+e.offsetHeight&&Fit.Dom.Data(e,"viewportcollision","true")})}}function m(t){Fit.Validation.ExpectFunction(t,!0);var n=!0===Fit.Validation.IsSet(t)?t:function(){};!1===a?n():(Fit.Dom.AddClass(e.GetDomElement(),"FitUi_Non_Existing_ContextMenu_Class"),Fit.Dom.RemoveClass(e.GetDomElement(),"FitUi_Non_Existing_ContextMenu_Class"),setTimeout(function(){n(),Fit.Dom.AddClass(e.GetDomElement(),"FitUi_Non_Existing_ContextMenu_Class"),Fit.Dom.RemoveClass(e.GetDomElement(),"FitUi_Non_Existing_ContextMenu_Class")},0))}this.Show=function(n,o){if(Fit.Validation.ExpectInteger(n,!0),Fit.Validation.ExpectInteger(o,!0),!1!==s(r)){null!==Fit._internal.ContextMenu.Current&&Fit._internal.ContextMenu.Current!==t&&!0===Fit._internal.ContextMenu.Current.IsVisible()&&(Fit._internal.ContextMenu.Current.Hide(),Fit._internal.ContextMenu.Current=null);var a=Fit.Events.GetPointerState().Coordinates.Document,d=!0===Fit.Validation.IsSet(n)?n:a.X,u=!0===Fit.Validation.IsSet(o)?o:a.Y;if(e.GetDomElement().style.left=d+"px",e.GetDomElement().style.top=u+"px",e.GetDomElement().style.width="auto",!1===t.IsVisible()&&(Fit.Dom.Add(document.body,e.GetDomElement()),Fit._internal.ContextMenu.Current=t),!0===i){var c=e.GetDomElement();Fit.Dom.Data(c,"viewportcollision","false"),Fit.Browser.GetViewPortDimensions().Height<u-Fit.Dom.GetScrollPosition(document.body).Y+c.offsetHeight&&(Fit.Dom.Data(c,"viewportcollision","true"),c.style.top=u-c.offsetHeight+"px")}t.Focused(!0),s(l),Fit._internal.ContextMenu.SkipClickClose=!0,setTimeout(function(){Fit._internal.ContextMenu.SkipClickClose=!1},0)}},this.Hide=function(){!0===t.IsVisible()&&(Fit.Dom.Remove(e.GetDomElement()),s(d),Fit.Array.ForEach(e.GetChildren(),function(t){t.Expanded(!1)}),o=!0,Fit.Dom.Data(e.GetDomElement(),"keynav","false"),Fit.Dom.Data(e.GetDomElement(),"viewportcollision","false"),Fit.Dom.Data(e.GetDomElement(),"sticky","false"),Fit.Array.ForEach(e.GetDomElement().getElementsByTagName("ul"),function(t){Fit.Dom.Data(t,"viewportcollision",null)}))},this.DetectBoundaries=function(t){return Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t)&&(!1===t&&(Fit.Dom.Data(e.GetDomElement(),"viewportcollision","false"),Fit.Array.ForEach(e.GetDomElement().getElementsByTagName("ul"),function(t){Fit.Dom.Data(t,"viewportcollision",null)})),i=t),i},this.IsVisible=function(){return null!==e.GetDomElement().parentElement},this.GetDomElement=function(){return e.GetDomElement()},this.AddChild=function(t){Fit.Validation.ExpectInstance(t,Fit.Controls.ContextMenuItem);var n=t.GetDomElement()._internal.Node;e.AddChild(n)},this.RemoveChild=function(t){Fit.Validation.ExpectInstance(t,Fit.Controls.ContextMenuItem);var n=e.GetChild(t.Value());null!==n&&e.RemoveChild(n)},this.RemoveAllChildren=function(t){Fit.Validation.ExpectBoolean(t,!0),e.RemoveAllChildren(t)},this.GetChild=function(t,n){Fit.Validation.ExpectString(t),Fit.Validation.ExpectBoolean(n,!0);var i=e.GetChild(t,n);return null===i?null:i.GetDomElement()._internal.ContextMenuItem},this.GetChildren=function(){var t=[];return Fit.Array.ForEach(e.GetChildren(),function(e){Fit.Array.Add(t,e.GetDomElement()._internal.ContextMenuItem)}),t},this.GetAllChildren=function(){var t=[];return Fit.Array.ForEach(e.GetAllNodes(),function(e){Fit.Array.Add(t,e.GetDomElement()._internal.ContextMenuItem)}),t},this.Focused=function(t){return Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t)&&(n=Fit.Dom.GetFocused()),e.Focused(t)},this.Dispose=function(){t===Fit._internal.ContextMenu.Current&&(Fit._internal.ContextMenu.Current=null),e.Dispose(),t=e=n=i=o=a=r=l=d=u=null},this.OnShowing=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(r,t)},this.OnShown=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(l,t)},this.OnHide=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(d,t)},this.OnSelect=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(u,t)},this._internal=this._internal?this._internal:{},this._internal.FireOnShowing=function(){return s(r)},this._internal.FireOnShown=function(){s(l)},this._internal.FireOnHide=function(){s(d)},this._internal.FireOnSelect=function(){s(u)},Fit._internal.Core.EnsureStyles(),Fit.Dom.Data(e.GetDomElement(),"keynav","false"),Fit.Dom.Data(e.GetDomElement(),"sticky","false"),Fit.Dom.Data(e.GetDomElement(),"viewportcollision","false"),e.AddCssClass("FitUiControlContextMenu"),e.Selectable(!0),e.KeyboardNavigation(!1),Fit.Events.AddHandler(e.GetDomElement(),"keydown",function(i){var a=Fit.Events.GetEvent(i);if(27===a.keyCode)return t.Hide(),void(null!==n&&(n.focus(),n=null));var r=e.GetNodeFocused();if(null!==r){if(!0===o&&(o=!1,Fit.Dom.Data(e.GetDomElement(),"keynav","true"),m(),40===a.keyCode&&e.GetChildren().length>0))return e.GetChildren()[0].Focused(!0),void Fit.Events.PreventDefault(a);if(37===a.keyCode)return!0===r.Expanded()?r.Expanded(!1):null!==r.GetParent()&&r.GetParent().Focused(!0),void Fit.Events.PreventDefault(a);if(39===a.keyCode)return r.GetChildren().length>0&&(r.Expanded(!0),r.GetChildren()[0].Focused(!0)),void Fit.Events.PreventDefault(a);var l;if(38===a.keyCode)return null!==(l=e.GetNodeAbove(r))&&l.Focused(!0),void Fit.Events.PreventDefault(a);if(40===a.keyCode)return null!==(l=e.GetNodeBelow(r))&&l.Focused(!0),void Fit.Events.PreventDefault(a);13!==a.keyCode||!0===r.Selectable()&&r.Selected(!0)}}),e.OnSelected(function(e,n){if(!0===n.Selected()){n.Selected(!1),n.Expanded(!n.Expanded());var i=n.GetDomElement().getElementsByTagName("a");1===i.length&&Fit.Dom.GetParentOfType(i[0],"li")===n.GetDomElement()?(i[0]!==Fit.Events.GetPointerState().Target&&i[0].click(),t.Hide()):s(u,n.GetDomElement()._internal.ContextMenuItem)}}),e.OnToggled(function(t,n){if(!1===n.Expanded())Fit.Array.ForEach(n.GetChildren(),function(t){t.Expanded(!1)});else{if(!0===n.Focused()){Fit.Dom.Data(e.GetDomElement(),"sticky","true"),o=!1;for(var a=null,r=n;null!==r;){if(null!==(a=null!==r.GetParent()?c(r.GetParent().GetChildren(),r):c(e.GetChildren(),r))){a.Expanded(!1);break}r=r.GetParent()}}null!==n.GetParent()&&n.GetParent().Expanded(!0),!0===i&&F(n.GetDomElement())}}),Fit.Events.AddHandler(e.GetDomElement(),"mouseover",function(t){if(!0===i&&"false"===Fit.Dom.Data(e.GetDomElement(),"sticky")){var n=Fit.Events.GetTarget(t);null!==(n="LI"===n.tagName?n:Fit.Dom.GetParentOfType(n,"li"))&&F(n)}}),Fit.Events.AddHandler(e.GetDomElement(),"click",function(t){Fit.Events.StopPropagation(t)})},Fit.Controls.ContextMenuItem=function(t,e){Fit.Validation.ExpectString(t),Fit.Validation.ExpectString(e);var n=this,i=new Fit.Controls.TreeViewNode(t,e);this.Title=function(t){return Fit.Validation.ExpectStringValue(t,!0),i.Title(t)},this.Value=function(){return i.Value()},this.Selectable=function(t){return Fit.Validation.ExpectBoolean(t,!0),i.Selectable(t)},this.GetDomElement=function(){return i.GetDomElement()},this.AddChild=function(t){Fit.Validation.ExpectInstance(t,Fit.Controls.ContextMenuItem);var e=t.GetDomElement()._internal.Node;i.AddChild(e)},this.RemoveChild=function(t){Fit.Validation.ExpectInstance(t,Fit.Controls.ContextMenuItem);var e=i.GetChild(t.Value());null!==e&&i.RemoveChild(e)},this.GetChild=function(t,e){Fit.Validation.ExpectString(t),Fit.Validation.ExpectBoolean(e,!0);var n=i.GetChild(t,e);return null===n?null:n.GetDomElement()._internal.ContextMenuItem},this.GetChildren=function(){var t=[];return Fit.Array.ForEach(i.GetChildren(),function(e){Fit.Array.Add(t,e.GetDomElement()._internal.ContextMenuItem)}),t},this.GetParent=function(){var t=i.GetParent();return null!==t?t.GetDomElement()._internal.ContextMenuItem:null},this.Dispose=function(){i.Dispose(),i=null},i.GetDomElement()._internal.ContextMenuItem=n},Fit.Controls.ContextMenu.Item=Fit.Controls.ContextMenuItem,Fit._internal.ContextMenu={},Fit._internal.ContextMenu.SkipClickClose=!1,Fit._internal.ContextMenu.Current=null,Fit.Events.OnReady(function(){Fit.Events.AddHandler(document,"click",function(t){if(!0!==Fit._internal.ContextMenu.SkipClickClose){var e=Fit.Events.GetTarget(t),n=Fit._internal.ContextMenu.Current;null!==n&&e!==n.GetDomElement()&&!0!==Fit.Dom.Contained(n.GetDomElement(),e)&&n.Hide()}})}),Fit.Controls.WSContextMenu=function(){Fit.Core.Extend(this,Fit.Controls.ContextMenu).Apply();var t=this,e=null,n=null,i=[],o=[],a=[];function r(e,n){var i=!1;return Fit.Array.ForEach(e,function(e){!1===e(t,n)&&(i=!0)}),!i}this.Show=function(l,d){Fit.Validation.ExpectInteger(l,!0),Fit.Validation.ExpectInteger(d,!0),!1!==t._internal.FireOnShowing()&&(null!==Fit._internal.ContextMenu.Current&&Fit._internal.ContextMenu.Current!==t&&!0===Fit._internal.ContextMenu.Current.IsVisible()&&(Fit._internal.ContextMenu.Current.Hide(),Fit._internal.ContextMenu.Current=null),function(l){Fit.Validation.ExpectFunction(l),null===e&&Fit.Validation.ThrowError("Unable to get data, no WebService URL has been specified");var d=null;d=null!==n?new Fit.Http.JsonpRequest(e,n):new Fit.Http.JsonRequest(e);var u={Sender:null,Request:null,Children:null};if(u.Sender=t,u.Request=d,!1===r(i,u))return;var s=function(t){u.Children=t instanceof Array?t:[],r(o,u),l(u),r(a,u)},c=function(t){Fit.Validation.ThrowError("Unable to load data for context menu - request failed with HTTP Status Code "+t)};!1===Fit.Core.InstanceOf(d,Fit.Http.JsonpRequest)?(d.OnSuccess(function(t){var e=d.GetResponseJson();s(e)}),d.OnFailure(function(t){c(d.GetHttpStatus())})):(d.OnSuccess(function(t){var e=t.GetResponse();s(e)}),d.OnTimeout(function(){c("UNKNOWN (JSONP)")}));d.Start()}(function(e){t.RemoveAllChildren(),Fit.Array.ForEach(e.Children,function(e){t.AddChild(function t(e){Fit.Validation.ExpectIsSet(e);var n=new Fit.Controls.ContextMenuItem(e.Title?e.Title:e.Value,e.Value);void 0!==e.Selectable&&n.Selectable(!0===e.Selectable);e.Children instanceof Array&&Fit.Array.ForEach(e.Children,function(e){n.AddChild(t(e))});return n}(e))});var n=Fit.Events.GetPointerState().Coordinates.Document,i=!0===Fit.Validation.IsSet(l)?l:n.X,o=!0===Fit.Validation.IsSet(d)?d:n.Y;if(t.GetDomElement().style.left=i+"px",t.GetDomElement().style.top=o+"px",t.GetDomElement().style.width="auto",!1===t.IsVisible()&&(Fit.Dom.Add(document.body,t.GetDomElement()),Fit._internal.ContextMenu.Current=t),!0===t.DetectBoundaries()){var a=t.GetDomElement();Fit.Dom.Data(a,"viewportcollision","false"),Fit.Browser.GetViewPortDimensions().Height<o-Fit.Dom.GetScrollPosition(document.body).Y+a.offsetHeight&&(Fit.Dom.Data(a,"viewportcollision","true"),a.style.top=o-a.offsetHeight+"px")}t.Focused(!0),t._internal.FireOnShown()}))},this.Url=function(t){return Fit.Validation.ExpectString(t,!0),!0===Fit.Validation.IsSet(t)&&(e=t),e},this.JsonpCallback=function(t){return Fit.Validation.ExpectString(t,!0),!0!==Fit.Validation.IsSet(t)&&null!==t||(n=t),n},this.OnRequest=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(i,t)},this.OnResponse=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(o,t)},this.OnPopulated=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(a,t)}},Fit.Controls.DatePicker=function(t){Fit.Validation.ExpectStringValue(t),Fit.Core.Extend(this,Fit.Controls.ControlBase).Apply(t);var e=this,n=null,i=null,o=null,a="",r="",l="en",d="MM/DD/YYYY",u=!1,s=void 0,c=null,F=null,m=!1,f=!1,p=!1,E=!0,h=Fit.Browser.GetInfo().IsMobile,v=null,D=null;function y(){var t=s;(c=t(n).datepicker({showOn:"none",showAnim:!1,showWeek:u,changeMonth:!0,changeYear:!0,dateFormat:g(e.Format()),defaultDate:null,onChangeMonthYear:function(t,e,n){if(!0===m)try{F=Fit.Date.Parse(t+"-"+e+"-01","YYYY-MM-DD")}catch(t){}},onSelect:function(t,i){F=null,e.Focused(!0),n.onchange()},beforeShow:function(t,n){if(null===c.jq.datepicker.regional[l])return!1;if(void 0===c.jq.datepicker.regional[l])return c.jq.datepicker.regional[l]=null,Fit.Loader.ExecuteScript(Fit.GetUrl()+"/Resources/JqueryUI-1.11.4.custom/i18n/datepicker-"+l+".js",function(t){c.jq.datepicker.regional[l]&&e.Show()},null,{jQuery:c.jq,$:c.jq}),!1;var i=e.Value();!0===E&&(E=!1,c.datepicker("option",c.jq.datepicker.regional[l]),c.datepicker("option","dateFormat",g(e.Format())),c.datepicker("option","showWeek",u)),null!==F&&!0===p&&setTimeout(function(){var t=Fit.Date.Format(F,"YYYY"),e=Fit.Date.Format(F,"M"),n=document.querySelector("select.fitui-datepicker-year");n.value=t,c.jq(n).trigger("change");var i=document.querySelector("select.fitui-datepicker-month");i.value=(parseInt(e)-1).toString(),c.jq(i).trigger("change")},0),m=!0,i!==e.Value()&&e._internal.ExecuteWithNoOnChange(function(){e.Value(i)})},onClose:function(t,e){m=!1,n.onblur()}})).jq=t}function g(){return e.Format().replace(/D/g,"d").replace(/M/g,"m").replace(/YY/g,"y")}this.Focused=function(t){if(Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t)){var i=null===v?n:v;!0===t?i.focus():(i.blur(),!1===h&&e.Hide())}return f},this.Value=function(t){if(Fit.Validation.ExpectString(t,!0),!0===Fit.Validation.IsSet(t)){var l=e.Value()!==t,d=m;if(!0===d&&(p=!0,e.Hide()),""!==t){-1===t.indexOf(":")&&(t+=" 00:00");var u=Fit.Date.Parse(t,"YYYY-MM-DD hh:mm");u.setSeconds(0),u.setMilliseconds(0),n.value=Fit.Date.Format(u,e.Format()),a=n.value,o=u,null!==i&&(i.value=Fit.Date.Format(u,"hh:mm"),r=i.value),null!==v&&(v.valueAsDate=new Date(Date.UTC(u.getFullYear(),u.getMonth(),u.getDate()))),null!==D&&(D.value=i.value)}else n.value="",a="",o=null,null!==i&&(i.value="",r="00:00"),null!==v&&(v.valueAsDate=null),null!==D&&(D.value="");!0===d&&(e.Show(),p=!1),!0===l&&e._internal.FireOnChange()}if(""===n.value)return"";try{var s=n.value+(null!==i?" "+(""!==i.value?i.value:"00:00"):""),c=e.Format()+(s.indexOf(":")>-1?" hh:mm":""),F=Fit.Date.Parse(s,c);return Fit.Date.Format(F,"YYYY-MM-DD"+(s.indexOf(":")>-1?" hh:mm":""))}catch(t){}return""},this.IsDirty=function(){if(null!==i)return!1===Fit.Core.IsEqual(o,e.Date());var t=e.Date();return null===o&&null!==t||null!==o&&null===t||(null!==o||null!==t)&&Fit.Date.Format(o,"YYYY-MM-DD")!==Fit.Date.Format(e.Date(),"YYYY-MM-DD")},this.Clear=function(){e.Value("")},this.Dispose=Fit.Core.CreateOverride(this.Dispose,function(){null!==c&&(e.Hide(),c.datepicker("destroy")),e=n=i=o=a=r=l=d=u=s=c=F=m=f=p=h=v=D=null,base()}),this.Date=function(t){Fit.Validation.ExpectDate(t,!0),void 0!==t&&(null!==t?e.Value(t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()):e.Clear());var n=e.Value(),o=null;if(""!==n)try{o=Fit.Date.Parse(n,"YYYY-MM-DD"+(null!==i?" hh:mm":""))}catch(t){}return null!==o&&(null===i&&(o.setHours(0),o.setMinutes(0)),o.setSeconds(0),o.setMilliseconds(0)),o},this.GetText=function(){var t=e.Date();return null!==t?Fit.Date.Format(t,e.Format()+(null!==i?" hh:mm":"")):""},this.Locale=function(t){if(Fit.Validation.ExpectString(t,!0),!0===Fit.Validation.IsSet(t)){var n=function(t){Fit.Validation.ExpectString(t);var e={"":"mm/dd/yy",en:"mm/dd/yy","en-US":"mm/dd/yy",da:"dd-mm-yy",af:"dd/mm/yy","ar-DZ":"dd/mm/yy",ar:"dd/mm/yy",az:"dd.mm.yy",be:"dd.mm.yy",bg:"dd.mm.yy",bs:"dd.mm.yy",ca:"dd/mm/yy",cs:"dd.mm.yy","cy-GB":"dd/mm/yy",de:"dd.mm.yy",el:"dd/mm/yy","en-AU":"dd/mm/yy","en-GB":"dd/mm/yy","en-NZ":"dd/mm/yy",eo:"dd/mm/yy",es:"dd/mm/yy",et:"dd.mm.yy",eu:"yy-mm-dd",fa:"yy/mm/dd",fi:"d.m.yy",fo:"dd-mm-yy","fr-CA":"yy-mm-dd","fr-CH":"dd.mm.yy",fr:"dd/mm/yy",gl:"dd/mm/yy",he:"dd/mm/yy",hi:"dd/mm/yy",hr:"dd.mm.yy.",hu:"yy.mm.dd.",hy:"dd.mm.yy",id:"dd/mm/yy",is:"dd.mm.yy","it-CH":"dd.mm.yy",it:"dd/mm/yy",ja:"yy/mm/dd",ka:"dd-mm-yy",kk:"dd.mm.yy",km:"dd-mm-yy",ko:"yy. m. d.",ky:"dd.mm.yy",lb:"dd.mm.yy",lt:"yy-mm-dd",lv:"dd.mm.yy",mk:"dd.mm.yy",ml:"dd/mm/yy",ms:"dd/mm/yy",nb:"dd.mm.yy","nl-BE":"dd/mm/yy",nl:"dd-mm-yy",nn:"dd.mm.yy",no:"dd.mm.yy",pl:"dd.mm.yy","pt-BR":"dd/mm/yy",pt:"dd/mm/yy",rm:"dd/mm/yy",ro:"dd.mm.yy",ru:"dd.mm.yy",sk:"dd.mm.yy",sl:"dd.mm.yy",sq:"dd.mm.yy",sr:"dd.mm.yy","sr-SR":"dd.mm.yy",sv:"yy-mm-dd",ta:"dd/mm/yy",th:"dd/mm/yy",tj:"dd.mm.yy",tr:"dd.mm.yy",uk:"dd.mm.yy",vi:"dd/mm/yy","zh-CN":"yy-mm-dd","zh-HK":"dd-mm-yy","zh-TW":"yy/mm/dd"};return void 0!==e[t]?e[t]:null}(t);null===n&&Fit.Validation.ThrowError("Unknown locale '"+t+"'");var i=m;!0===i&&(p=!0,e.Hide()),l=t,E=!0,e.Format((o=n,Fit.Validation.ExpectString(o),o.replace(/d/g,"D").replace(/m/g,"M").replace(/y/g,"YY"))),!0===i&&(e.Show(),p=!1)}var o;return l},this.Format=function(t){if(Fit.Validation.ExpectString(t,!0),!0===Fit.Validation.IsSet(t)){try{var a=Fit.Date.Parse("2016-06-24 00:00:00","YYYY-MM-DD hh:mm:ss"),r=Fit.Date.Format(a,t+" hh:mm:ss"),l=Fit.Date.Parse(r,t+" hh:mm:ss");if(a.getTime()!==l.getTime())throw"Invalid"}catch(e){Fit.Validation.ThrowError("Invalid date format '"+t+"'")}var u=m;!0===u&&(p=!0,e.Hide());var s=e.Value();d=t,E=!0,n.placeholder=Fit.Date.Format(new Date,d),e._internal.ExecuteWithNoOnChange(function(){var t=o,n=null!==i?i.value:"";e.Value(s),o=t,null!==i&&(i.value=n)}),!0===u&&(e.Show(),p=!1)}return d},this.WeekNumbers=function(t){if(Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t)){var n=m;!0===n&&(p=!0,e.Hide()),u=t,E=!0,!0===n&&(e.Show(),p=!1),e._internal.Data("weeks",t.toString())}return u},this.Time=function(t){return Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t)&&(!0===t&&null===i?(r="00:00",(i=document.createElement("input")).type="text",i.autocomplete="off",i.spellcheck=!1,i.placeholder=Fit.Date.Format(new Date,"hh:mm"),i.value=null!==e.Date()?"00:00":"",i.tabIndex=!0===h?-1:0,null!==e.Date()&&null!==o&&(i.value=Fit.Date.Format(o,"hh:mm"),r=i.value),i.onkeydown=function(t){var e=Fit.Events.GetEvent(t),n=Fit.Events.GetModifierKeys();if(9!==e.keyCode&&8!==e.keyCode&&37!==e.keyCode&&39!==e.keyCode&&46!==e.keyCode&&!0!==n.Ctrl&&!0!==n.Meta){var o=i.value,a=186===e.keyCode||!0===n.Shift&&190===e.keyCode,r=!0===a||e.keyCode>=48&&e.keyCode<=58||e.keyCode>=96&&e.keyCode<=105;!0!==a||0!==o.length&&":"!==o.substring(o.length-1)||(r=!1),!1!==r||Fit.Events.PreventDefault(e)}},i.onkeyup=function(t){if(null!==t){var o=Fit.Events.GetEvent(t);if(2===i.value.length&&":"!==i.value.substring(1)&&8!==o.keyCode&&46!==o.keyCode)return void(i.value+=":")}var a=null;try{a=Fit.Date.Parse(""!==i.value?i.value:"00:00","hh:mm")}catch(t){}if(null!==a){var l=Fit.Date.Format(a,"hh:mm");l!==r&&(r=l,""!==n.value&&e._internal.FireOnChange())}},i.onchange=function(){i.onkeyup(null)},i.onpaste=function(){setTimeout(function(){i.onkeyup(null)},0)},i.onblur=function(){""===i.value?(i.value=""!==n.value?"00:00":"",r="00:00"):i.value=r},Fit.Dom.InsertAfter(n,i),!0===h&&((D=document.createElement("input")).type="time",D.onchange=function(){""===D.value&&""!==v.value&&(D.value="00:00"),i.value=D.value,i.onchange()},e._internal.AddDomElement(D)),e._internal.FireOnChange()):!1===t&&null!==i&&(Fit.Dom.Remove(i),!0===h&&Fit.Dom.Remove(D),i=null,r="",e._internal.FireOnChange()),e._internal.Data("time",(null!==i).toString())),null!==i},this.Show=function(){!1===h?function(t){if(Fit.Validation.ExpectFunction(t),null!==c)return void t();void 0===(s=Fit._internal.Controls.DatePicker.jQuery)?(s=null,Fit._internal.Controls.DatePicker.jQuery=null,Fit.Loader.ExecuteScript(Fit.GetUrl()+"/Resources/JqueryUI-1.11.4.custom/external/jquery/jquery.js",function(e){s=$,Fit._internal.Controls.DatePicker.jQuery=$,$.noConflict(!0),Fit.Loader.ExecuteScript(Fit.GetUrl()+"/Resources/JqueryUI-1.11.4.custom/jquery-ui.js",function(e){y(),t()},null,{jQuery:s,$:s})})):s&&s.datepicker&&(y(),t())}(function(){var t=Fit.Dom.GetFocused();c.datepicker("show"),t===i&&i.focus()}):(e.Focused(!1),e.Focused(!0))},this.Hide=function(){!1===h?null!==c&&c.datepicker("hide"):e.Focused(!1)},this.GetLocales=function(){var t=[];return Fit.Array.ForEach({"":"mm/dd/yy",en:"mm/dd/yy","en-US":"mm/dd/yy",da:"dd-mm-yy",af:"dd/mm/yy","ar-DZ":"dd/mm/yy",ar:"dd/mm/yy",az:"dd.mm.yy",be:"dd.mm.yy",bg:"dd.mm.yy",bs:"dd.mm.yy",ca:"dd/mm/yy",cs:"dd.mm.yy","cy-GB":"dd/mm/yy",de:"dd.mm.yy",el:"dd/mm/yy","en-AU":"dd/mm/yy","en-GB":"dd/mm/yy","en-NZ":"dd/mm/yy",eo:"dd/mm/yy",es:"dd/mm/yy",et:"dd.mm.yy",eu:"yy-mm-dd",fa:"yy/mm/dd",fi:"d.m.yy",fo:"dd-mm-yy","fr-CA":"yy-mm-dd","fr-CH":"dd.mm.yy",fr:"dd/mm/yy",gl:"dd/mm/yy",he:"dd/mm/yy",hi:"dd/mm/yy",hr:"dd.mm.yy.",hu:"yy.mm.dd.",hy:"dd.mm.yy",id:"dd/mm/yy",is:"dd.mm.yy","it-CH":"dd.mm.yy",it:"dd/mm/yy",ja:"yy/mm/dd",ka:"dd-mm-yy",kk:"dd.mm.yy",km:"dd-mm-yy",ko:"yy. m. d.",ky:"dd.mm.yy",lb:"dd.mm.yy",lt:"yy-mm-dd",lv:"dd.mm.yy",mk:"dd.mm.yy",ml:"dd/mm/yy",ms:"dd/mm/yy",nb:"dd.mm.yy","nl-BE":"dd/mm/yy",nl:"dd-mm-yy",nn:"dd.mm.yy",no:"dd.mm.yy",pl:"dd.mm.yy","pt-BR":"dd/mm/yy",pt:"dd/mm/yy",rm:"dd/mm/yy",ro:"dd.mm.yy",ru:"dd.mm.yy",sk:"dd.mm.yy",sl:"dd.mm.yy",sq:"dd.mm.yy",sr:"dd.mm.yy","sr-SR":"dd.mm.yy",sv:"yy-mm-dd",ta:"dd/mm/yy",th:"dd/mm/yy",tj:"dd.mm.yy",tr:"dd.mm.yy",uk:"dd.mm.yy",vi:"dd/mm/yy","zh-CN":"yy-mm-dd","zh-HK":"dd-mm-yy","zh-TW":"yy/mm/dd"},function(e){""!==e&&Fit.Array.Add(t,e)}),t},(n=document.createElement("input")).type="text",n.autocomplete="off",n.spellcheck=!1,n.placeholder=Fit.Date.Format(new Date,d),n.tabIndex=!0===h?-1:0,n.onkeydown=function(t){40===Fit.Events.GetEvent(t).keyCode&&e.Show()},n.onkeyup=function(){var t=e.Date();if(""===n.value||null!==t){var i=null!==t?Fit.Date.Format(t,e.Format()):"";i!==a&&(""===n.value&&!0===m&&(p=!0,e.Hide(),e.Show(),p=!1),a=i,e._internal.FireOnChange())}},n.onchange=function(){n.onkeyup()},n.onpaste=function(){setTimeout(function(){n.onkeyup(),!0===m&&(e.Hide(),e.Show()),F=null},0)},n.onclick=function(){e.Show()},e._internal.FireOnFocus=Fit.Core.CreateOverride(e._internal.FireOnFocus,function(){!1===f&&(f=!0,base())}),e._internal.FireOnBlur=Fit.Core.CreateOverride(e._internal.FireOnBlur,function(){!1===m&&(f=!1,base())}),n.onblur=function(){!0!==m&&""!==n.value&&(n.value=a)},e.OnBlur(function(t){""===n.value&&null!==i&&(i.value="",r="00:00"),""!==n.value&&null!==i&&""===i.value&&(i.value="00:00",r="00:00")}),e._internal.AddDomElement(n),e.AddCssClass("FitUiControlDatePicker"),e._internal.Data("weeks","false"),e._internal.Data("time","false"),!0===h&&((v=document.createElement("input")).type="date",v.onchange=function(){null!==v.valueAsDate?n.value=Fit.Date.Format(v.valueAsDate,e.Format()):n.value="",n.onchange()},e._internal.AddDomElement(v))},Fit._internal.Controls.DatePicker={},Fit.Controls.Dialog=function(){var t=this,e=null,n=null,i=null,o=!1,a=null;this.Modal=function(t){return Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t)&&(o=t),o},this.Content=function(t){return Fit.Validation.ExpectString(t,!0),!0===Fit.Validation.IsSet(t)&&(n.innerHTML=t),n.innerHTML},this.AddButton=function(t){Fit.Validation.ExpectInstance(t,Fit.Controls.Button),Fit.Dom.Add(i,t.GetDomElement())},this.Open=function(){Fit.Dom.Add(document.body,e),!0===o&&Fit.Dom.Add(document.body,a)},this.Close=function(){Fit.Dom.Remove(e),null!==a&&Fit.Dom.Remove(a)},this.GetDomElement=function(){return e},this.Dispose=function(){Fit.Dom.Remove(e),null!==a&&Fit.Dom.Remove(a),Fit.Array.ForEach(Fit.Array.Copy(i.children),function(t){Fit.Controls.Find(t.id).Dispose()}),t=e=n=i=o=a=null},Fit._internal.Core.EnsureStyles(),e=document.createElement("div"),Fit.Dom.AddClass(e,"FitUiControl"),Fit.Dom.AddClass(e,"FitUiControlDialog"),n=document.createElement("div"),Fit.Dom.Add(e,n),i=document.createElement("div"),Fit.Dom.Add(e,i),a=document.createElement("div"),Fit.Dom.AddClass(a,"FitUiControlDialogModalLayer"),Fit.Events.AddHandler(e,"keydown",function(t){var e=Fit.Events.GetEvent(t);if(Fit.Events.GetModifierKeys(),!0===o&&i.children.length>0&&9===e.keyCode){var n=Fit.Dom.GetFocused();!1===e.shiftKey?n===i.children[i.children.length-1]&&(i.children[0].focus(),Fit.Events.PreventDefault(e)):n===i.children[0]&&(i.children[i.children.length-1].focus(),Fit.Events.PreventDefault(e))}}),Fit.Events.AddHandler(e,"click",function(n){null!==t&&i.children.length>0&&(null===Fit.Dom.GetFocused()||!1===Fit.Dom.Contained(e,Fit.Dom.GetFocused()))&&i.children[0].focus()}),Fit.Events.AddHandler(a,"click",function(t){i.children.length>0&&(null===Fit.Dom.GetFocused()||!1===Fit.Dom.Contained(e,Fit.Dom.GetFocused()))&&i.children[0].focus()})},Fit.Controls.Dialog._internal={},Fit.Controls.Dialog._internal.BaseDialog=function(t,e,n){Fit.Validation.ExpectString(t),Fit.Validation.ExpectBoolean(e),Fit.Validation.ExpectFunction(n,!0);var i=new Fit.Controls.Dialog;i.Content(t),i.Modal(!0),Fit.Dom.AddClass(i.GetDomElement(),"FitUiControlDialogBase");var o=new Fit.Controls.Button(Fit.Data.CreateGuid());if(o.Title(Fit.Language.Translations.Ok),o.Icon("check"),o.Type(Fit.Controls.ButtonType.Success),o.OnClick(function(t){i.Close(),!0===Fit.Validation.IsSet(n)&&n(!0)}),i.AddButton(o),!0===e){var a=new Fit.Controls.Button(Fit.Data.CreateGuid());a.Title(Fit.Language.Translations.Cancel),a.Icon("ban"),a.Type(Fit.Controls.ButtonType.Danger),a.OnClick(function(t){i.Close(),!0===Fit.Validation.IsSet(n)&&n(!1)}),i.AddButton(a)}i.Open(),o.Focused(!0)},Fit.Controls.Dialog.Alert=function(t,e){Fit.Validation.ExpectString(t),Fit.Validation.ExpectFunction(e,!0),Fit.Controls.Dialog._internal.BaseDialog(t,!1,function(t){!0===Fit.Validation.IsSet(e)&&e()})},Fit.Controls.Dialog.Confirm=function(t,e){Fit.Validation.ExpectString(t),Fit.Validation.ExpectFunction(e),Fit.Controls.Dialog._internal.BaseDialog(t,!0,e)},Fit.Controls.DropDown=function(t){Fit.Validation.ExpectStringValue(t),Fit.Core.Extend(this,Fit.Controls.ControlBase).Apply(t);var e=this,n=null,i=null,o=null,a=null,r=null,l=-1,d=null,u=!1,s=null,c=null,F=[],m="Invalid selection",f=!0,p={Value:150,Unit:"px"},E="",h=!1,v=-1,D=-1,y=-1,g=null,V=[],C=null,S=!1,x=!1,w=[],I=[],A=[],_=[];this.InvalidSelectionMessage=function(t){return Fit.Validation.ExpectString(t,!0),!0===Fit.Validation.IsSet(t)&&(m=t,Fit.Array.ForEach(O(),function(t){!0===Fit.Dom.HasClass(t,"FitUiControlDropDownInvalid")&&Fit.Dom.Attribute(t,"title",m)})),m},this.Width=Fit.Core.CreateOverride(this.Width,function(t,n){Fit.Validation.ExpectNumber(t,!0),Fit.Validation.ExpectStringValue(n,!0);var i=base(t,n);if(!0===Fit.Validation.IsSet(t)){if("%"!==i.Unit&&"em"!==i.Unit&&"rem"!==i.Unit||-1!==D)-1!==D&&(Fit.Events.RemoveMutationObserver(D),D=-1);else{var o=e.GetDomElement().offsetWidth,a=null;D=Fit.Events.AddMutationObserver(e.GetDomElement(),function(t){var n=e.GetDomElement().offsetWidth;o!==n&&(o=n,null!==a&&clearTimeout(a),a=setTimeout(function(){a=null,H()},250))})}H()}return i}),this.DropDownMaxHeight=function(t,e){return Fit.Validation.ExpectNumber(t,!0),Fit.Validation.ExpectStringValue(e,!0),!0===Fit.Validation.IsSet(t)&&(p={Value:t,Unit:!0===Fit.Validation.IsSet(e)?e:"px"},null!==c&&c.MaxHeight(p.Value,p.Unit)),p},this.DropDownMaxWidth=function(t,e){Fit.Validation.ExpectNumber(t,!0),Fit.Validation.ExpectStringValue(e,!0),!0===Fit.Validation.IsSet(t)&&(-1!==t?(s.style.width="auto",s.style.maxWidth=t+(!0===Fit.Validation.IsSet(e)?e:"px")):(s.style.width="",s.style.maxWidth=""));var n={Value:-1,Unit:"px"};return""!==s.style.maxWidth&&(n.Value=parseFloat(s.style.maxWidth),n.Unit=s.style.maxWidth.replace(n.Value,"")),n},this.Value=function(t){if(Fit.Validation.ExpectString(t,!0),!0===Fit.Validation.IsSet(t)){F=[];var n=O().length>0||""!==t;e._internal.ExecuteWithNoOnChange(function(){e.Clear(),""!==t&&Fit.Array.ForEach(t.split(";"),function(t){var n=t.split("=");2===n.length?e.AddSelection(Y(n[0]),Y(n[1])):e.AddSelection(Y(n[0]),Y(n[0]))})}),F=e.GetSelections(),!0===n&&j()}var i=e.GetSelections(),o="";return Fit.Array.ForEach(i,function(t){o+=(""!==o?";":"")+q(t.Title)+"="+q(t.Value)}),o},this.IsDirty=function(){return!1===Fit.Core.IsEqual(F,e.GetSelections())},this.Clear=function(){e.ClearSelections()},this.Focused=function(t){if(Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t))if(!0===t){var n=r,i=n.value;n.focus(),n.value="",n.value=i}else!1===t&&!0===Fit.Dom.Contained(e.GetDomElement(),Fit.Dom.GetFocused())&&(e.CloseDropDown(),Fit.Dom.GetFocused().blur());return d===Fit.Dom.GetFocused()},this.Dispose=Fit.Core.CreateOverride(this.Dispose,function(){null!==c&&c.Destroy(),Fit._internal.DropDown.Current===e&&(Fit._internal.DropDown.Current=null),-1!==D&&Fit.Events.RemoveMutationObserver(D),Fit.Array.ForEach(V,function(t){Fit.Events.RemoveHandler(document,t)}),e=n=i=o=a=r=l=d=u=s=c=F=m=f=p=E=h=v=D=g=V=C=S=x=w=I=A=_=null,base()}),this.MultiSelectionMode=function(t){return Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t)&&e.MultiSelectionMode()!==t&&(e.ClearSelections(),e._internal.Data("multiselect",t.toString()),H()),"true"===e._internal.Data("multiselect")};var G=!1,T=!1;function b(){var t=document.createElement("input");t.autocomplete="off",t.onpaste=function(n){var i=t.value;setTimeout(function(){var n=t.value;!0===function(t){Fit.Validation.ExpectString(t);var n=!0;return Fit.Array.ForEach(I,function(i){!1===i(e,t)&&(n=!1)}),n}(t.value)?(M(t),X(t.value)):t.value===n&&(t.value=i)},0)},t.onfocus=function(n){h=!0,!0===f&&(f=!1,e.ClearInput(r)),E=(d=t).value,R()},t.onblur=function(t){h=!1};var n=null;return t.onkeydown=function(i){var o=Fit.Events.GetEvent(i);if((d=t,R(),null!==c)&&(!0===e.IsDropDownOpen()&&!1===c.HandleEvent(o)))return;if(9===o.keyCode){if(!0===o.shiftKey){if(0===e.GetSelections().length)return void e.CloseDropDown();if(t!==r&&null===t.parentElement.previousSibling)return void e.CloseDropDown();k("Prev")}else{if(!1===e.MultiSelectionMode()&&null!==g)return void e.CloseDropDown();if(t===r)return void e.CloseDropDown();k("Next")}return!1}if(38===o.keyCode)e.OpenDropDown();else if(40===o.keyCode)e.OpenDropDown();else if(37===o.keyCode)k("Prev");else if(39===o.keyCode){if(!1===e.MultiSelectionMode()&&null!==g)return;k("Next")}else if(27===o.keyCode)"MSIE"===Fit.Browser.GetInfo().Name&&Fit.Events.PreventDefault(o),e.CloseDropDown();else if(8===o.keyCode)if(0===t.value.length){"MSIE"===Fit.Browser.GetInfo().Name&&Fit.Events.PreventDefault(o);var a=null;t!==r&&2===Fit.Dom.GetIndex(t)?a=t.parentElement:t!==r&&0===Fit.Dom.GetIndex(t)&&null!==t.parentElement.previousSibling?a=t.parentElement.previousSibling:null!==t.previousSibling&&(a=t.previousSibling),null!==a&&e.RemoveSelection(K(Fit.Dom.Data(a.children[1],"value")))}else null!==n&&clearTimeout(n),n=setTimeout(function(){M(t),n=null},50);else if(46===o.keyCode)if(0===t.value.length){a=null;t!==r&&0===Fit.Dom.GetIndex(t)?a=t.parentElement:t!==r&&2===Fit.Dom.GetIndex(t)&&"SPAN"===t.parentElement.nextSibling.tagName&&(a=t.parentElement.nextSibling),null!==a&&e.RemoveSelection(K(Fit.Dom.Data(a.children[1],"value")))}else null!==n&&clearTimeout(n),n=setTimeout(function(){M(t),n=null},50);else if(13===o.keyCode)Fit.Events.PreventDefault(i);else{if(!1===u)return void Fit.Events.PreventDefault(o);null!==n&&clearTimeout(n);var l=Fit.Events.GetModifierKeys();!0===l.Ctrl||!0===l.Meta?n=setTimeout(function(){M(t),n=null},0):M(t,t.value+String.fromCharCode(o.keyCode|o.charCode))}},t.onkeyup=function(e){var n=Fit.Events.GetEvent(e);37!==n.keyCode&&38!==n.keyCode&&39!==n.keyCode&&40!==n.keyCode&&27!==n.keyCode&&9!==n.keyCode&&16!==n.keyCode&&!1===n.ctrlKey&&17!==n.keyCode&&t.value!==E&&(E=t.value,X(t.value))},t.onclick=function(t){x=!0,Fit.Events.StopPropagation(t)},t}function O(){return n.querySelectorAll("span[data-value]")}function M(t,e){Fit.Validation.ExpectInstance(t,HTMLInputElement),Fit.Validation.ExpectString(e,!0);var i=!0===Fit.Validation.IsSet(e)?e:t.value;l<=0&&(l=r.offsetWidth),a.innerHTML=i;var o=(""!==i?a.offsetWidth:0)+l,d=t.offsetLeft,u=Fit.Dom.GetInnerWidth(n);o=d+o>u?u-d:o,t.style.width=o+"px"}function k(t){Fit.Validation.ExpectString(t);var e=null;if("Prev"===t)d!==r&&0===Fit.Dom.GetIndex(d)&&null!==d.parentElement.previousSibling?e=d.parentElement.previousSibling.children[0]:d!==r&&2===Fit.Dom.GetIndex(d)?e=d.parentElement.children[0]:null!==d.previousSibling&&(e=d.previousSibling.children[0]);else{var n=null;d!==r&&0===Fit.Dom.GetIndex(d)?n=d.parentElement:d!==r&&2===Fit.Dom.GetIndex(d)&&"SPAN"===d.parentElement.nextSibling.tagName&&(n=d.parentElement.nextSibling),null!==n&&(e=-1!==n.children[2].tabIndex?n.children[2]:"SPAN"===n.nextSibling.tagName?n.nextSibling.children[0]:r),null!==e&&e.parentElement.nextSibling===r&&2===Fit.Dom.GetIndex(e)&&(e=r)}null!==e&&B(e)}function B(t){Fit.Validation.ExpectInstance(t,HTMLInputElement),d=t,!0===h&&d.focus()}function R(){var t=n.getElementsByTagName("input");Fit.Array.ForEach(t,function(t){t!==d&&e.ClearInput(t)})}function H(t){if(Fit.Validation.ExpectDomElement(t,!0),!0!==Fit.Validation.IsSet(t))if(!1===e.MultiSelectionMode()){var i=O();g=i.length>0&&i[0].parentElement.offsetWidth+1>Fit.Dom.GetInnerWidth(n)?i[0]:null;var o=n.querySelectorAll("input");Fit.Array.ForEach(o,function(t){t.tabIndex=null!==g?-1:0}),null!==g&&(o[0].tabIndex=0)}else g=null,Fit.Array.ForEach(O(),function(t){t.parentElement.offsetWidth+1>Fit.Dom.GetInnerWidth(n)?t.nextSibling.tabIndex=-1:t.nextSibling.tabIndex=0});else t.parentElement.offsetWidth+1>Fit.Dom.GetInnerWidth(n)&&(t.nextSibling.tabIndex=-1)}function P(t){t.Reset()}function N(t){if(null!==C){var n=Fit.Events.GetPointerState().Coordinates.ViewPort;Fit.Dom.GetPosition(C.GetDomElement(),!0).X+C.GetDomElement().offsetWidth/2<n.X?Fit.Dom.Data(C.GetDomElement(),"dropping","right"):Fit.Dom.Data(C.GetDomElement(),"dropping","left"),e._internal.Repaint()}}function L(t,n){var i=!1;"right"===Fit.Dom.Data(t.GetDomElement(),"dropping")&&t.GetDomElement()!==n.GetDomElement().previousSibling?(h=!0,B(r),Fit.Dom.InsertAfter(t.GetDomElement(),n.GetDomElement()),i=!0):"left"===Fit.Dom.Data(t.GetDomElement(),"dropping")&&t.GetDomElement().previousSibling!==n.GetDomElement()&&(h=!0,B(r),Fit.Dom.InsertBefore(t.GetDomElement(),n.GetDomElement()),i=!0),Fit.Dom.Data(C.GetDomElement(),"dropping",null),C=null,e._internal.Repaint(),!0===i&&j()}function U(t){C=t}function W(t){Fit.Dom.Data(t.GetDomElement(),"dropping",null),C=null,e._internal.Repaint()}function Y(t){return Fit.Validation.ExpectString(t),t.replace(/%3B/g,";").replace(/%3D/g,"=")}function q(t){return Fit.Validation.ExpectString(t),t.replace(/;/g,"%3B").replace(/=/g,"%3D")}function K(t){return Fit.Validation.ExpectString(t),decodeURIComponent(t)}function X(t){Fit.Validation.ExpectString(t),Fit.Array.ForEach(w,function(n){n(e,t)})}function j(){e._internal.FireOnChange()}this.GetPicker=function(){return c},this.SetPicker=function(t){if(Fit.Validation.ExpectInstance(t,Fit.Controls.PickerBase,!0),null!==c&&Fit.Dom.Remove(c.GetDomElement()),t){if(t._internal.InitializePicker(),c=t,Fit.Dom.Add(s,c.GetDomElement()),T=!0,c.SetSelections(e.GetSelections()),T=!1,c.MaxHeight(p.Value,p.Unit),c._internal||(c._internal={}),!c._internal.HostControl){c._internal.HostControl=e;var n=!1;c.OnItemSelectionChanged(function(t,i){if(!0!==T){var o=null;G=!0,!0===i.Selected&&null===e.GetSelectionByValue(i.Value)?(n=!0,e._internal.ExecuteWithNoOnChange(function(){e.AddSelection(i.Title,i.Value)}),!1===e.MultiSelectionMode()&&e.CloseDropDown()):!1===i.Selected&&null!==e.GetSelectionByValue(i.Value)&&(n=!0,o=d,e._internal.ExecuteWithNoOnChange(function(){e.RemoveSelection(i.Value)}),null===o.parentElement.parentElement&&(o=r)),!1!==S&&!0!==x||(h=!0,B(null!==o?o:d)),G=!1}}),c.OnItemSelectionComplete(function(t){!0!==T&&!0===n&&(e._internal.FireOnChange(),n=!1)})}}else c=null},this.AddSelection=function(t,o,a){if(Fit.Validation.ExpectString(t),Fit.Validation.ExpectString(o),Fit.Validation.ExpectBoolean(a,!0),null===e.GetSelectionByValue(o)){if(null!==c&&!1===G){T=!0;var l=!0,u=null;try{l=c.UpdateItemSelection(o,!0)}catch(t){u=t}if(T=!1,null!==u&&Fit.Validation.ThrowError(u),!1===l)return}if(!1===e.MultiSelectionMode()){u=null;T=!0;try{e._internal.ExecuteWithNoOnChange(function(){e.ClearSelections()})}catch(t){u=t}if(T=!1,null!==u&&Fit.Validation.ThrowError(u),O().length>0)return}var s=document.createElement("i");Fit.Dom.AddClass(s,"fa"),Fit.Dom.AddClass(s,"fa-times"),s.tabIndex=0,s.onclick=function(t){e.RemoveSelection(K(Fit.Dom.Data(s.parentElement,"value"))),!1===S||!0===x?(h=!0,B(r)):i.focus(),Fit.Events.StopPropagation(t)},s.onmouseup=function(){!1===S||!0===x?(h=!0,B(r)):i.focus()};var F=document.createElement("span");F.onmousedown=function(t){F.tabIndex=0},F.onmouseup=function(t){F.tabIndex=-1},F.onclick=function(t){h=!0,B(null!==g?g.previousSibling:r)};var f,p=b(),E=b(),v=document.createElement("span");Fit.Dom.Data(v,"value",(f=o,Fit.Validation.ExpectString(f),encodeURIComponent(f))),!1===a&&(Fit.Dom.Attribute(v,"title",m),Fit.Dom.AddClass(v,"FitUiControlDropDownInvalid")),Fit.Dom.Add(v,document.createTextNode(Fit.String.StripHtml(t))),Fit.Dom.Add(v,s),Fit.Dom.Add(F,p),Fit.Dom.Add(F,v),Fit.Dom.Add(F,E);var D=null;D=d!==r&&!0===e.MultiSelectionMode()&&0===Fit.Dom.GetIndex(d)?d.parentElement:d!==r&&!0===e.MultiSelectionMode()&&2===Fit.Dom.GetIndex(d)?d.parentElement.nextSibling:r,n.insertBefore(F,D),e.ClearInput(),!0===Fit.Dom.IsVisible(e.GetDomElement())?!0===e.MultiSelectionMode()?H(v):H():-1===y&&(y=Fit.Events.AddMutationObserver(e.GetDomElement(),function(t){!0===Fit.Dom.IsVisible(e.GetDomElement())&&(H(),disconnect(),y=-1)}));var V=new Fit.DragDrop.Draggable(F,v);V.OnDragStop(P),V.OnDragging(N);var C=new Fit.DragDrop.DropZone(F);C.OnDrop(L),C.OnEnter(U),C.OnLeave(W),!0===e.MultiSelectionMode()?d!==r&&2===Fit.Dom.GetIndex(d)&&(-1!==E.tabIndex?B(E):"SPAN"===F.nextSibling.tagName&&B(F.nextSibling.children[0])):B(null!==g?g.previousSibling:r),j()}},this.GetSelections=function(t){Fit.Validation.ExpectBoolean(t,!0);var e=Fit.Array.ToArray(n.children);Fit.Array.RemoveAt(e,e.length-1),Fit.Array.RemoveAt(e,e.length-1);var i=[];return Fit.Array.ForEach(e,function(e){!0!==t&&!1!==Fit.Dom.HasClass(e.children[1],"FitUiControlDropDownInvalid")||Fit.Array.Add(i,{Title:Fit.Dom.Text(e.children[1]),Value:K(Fit.Dom.Data(e.children[1],"value")),Valid:!Fit.Dom.HasClass(e.children[1],"FitUiControlDropDownInvalid")})}),i},this.GetSelectionByValue=function(t){Fit.Validation.ExpectString(t);var n=null;return Fit.Array.ForEach(e.GetSelections(),function(e){if(e.Value===t)return n=e,!1}),n},this.ClearSelections=function(){O();var t=!1,n=h;e._internal.ExecuteWithNoOnChange(function(){Fit.Array.ForEach(O(),function(e){if(null!==c){var n=c.UpdateItemSelection(K(Fit.Dom.Data(e,"value")),!1);!1!==n&&null!==e.parentElement.parentElement&&Fit.Dom.Remove(e.parentElement),!1!==n&&(t=!0)}else Fit.Dom.Remove(e.parentElement),t=!0})}),h=n,H(),B(r),!0===t&&j()},this.RemoveSelection=function(t){if(Fit.Validation.ExpectString(t),null!==c&&!1===G){T=!0;var n=!1,i=null;try{n=c.UpdateItemSelection(t,!1)}catch(t){i=t}if(T=!1,null!==i&&Fit.Validation.ThrowError(i),!1===n)return}var o=null,a=null;Fit.Array.ForEach(O(),function(n){if(K(Fit.Dom.Data(n,"value"))===t)return!0===e.MultiSelectionMode()&&null!==n.parentElement.nextSibling&&n.parentElement.nextSibling!==r&&(a=n.parentElement.nextSibling.children[0]),o=n.parentElement,!1}),null!==o&&(!1===e.MultiSelectionMode()?B(r):B(null!==a?a:r),Fit.Dom.Remove(o),!1===e.MultiSelectionMode()?H():0===O().length&&H(),j())},this.ClearInput=function(t){Fit.Validation.ExpectInstance(t,HTMLInputElement,!0);var e=!0===Fit.Validation.IsSet(t)?t:d;""!==e.value&&(e.value="",e.style.width="",X(""))},this.SetInputValue=function(t){if(Fit.Validation.ExpectString(t),d.value!==t){d.value="",d.style.width="";var e=!0===h?d:r;if(null!==g&&(e=g.previousSibling),e.value=t,d=e,M(e),X(e.value),-1!==v&&(Fit.Events.RemoveMutationObserver(v),v=-1),t.length>0&&0===e.offsetWidth){var n=null;null!==(n=!1===Fit.Dom.IsRooted(e)?e:Fit.Dom.GetConcealer(e))&&(v=Fit.Events.AddMutationObserver(n,function(t){!0===Fit.Dom.IsVisible(e)&&(M(e),disconnect(),v=-1)}))}}},this.GetInputValue=function(){return d.value},this.InputEnabled=function(t){return Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t)&&(u=t),u},this.OpenDropDown=function(){"block"!==s.style.display&&(null!==Fit._internal.DropDown.Current&&Fit._internal.DropDown.Current!==e&&Fit._internal.DropDown.Current.CloseDropDown(),s.style.minWidth=e.GetDomElement().offsetWidth+"px",s.style.display="block",Fit._internal.DropDown.Current=e,Fit.Array.ForEach(A,function(t){t(e)}),null!==c&&c._internal.FireOnShow())},this.CloseDropDown=function(){"none"!==s.style.display&&(s.style.display="none",Fit._internal.DropDown.Current=null,Fit.Array.ForEach(_,function(t){t(e)}),null!==c&&c._internal.FireOnHide())},this.IsDropDownOpen=function(){return"block"===s.style.display},this.OnInputChanged=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(w,t)},this.OnPaste=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(I,t)},this.OnOpen=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(A,t)},this.OnClose=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(_,t)},function(){if(m=Fit.Language.Translations.InvalidSelection,e._internal.Data("multiselect","false"),!0===Fit.Browser.GetInfo().IsMobile&&(S=!0),(n=document.createElement("div")).onmousedown=function(t){n.tabIndex=0},n.onmouseup=function(t){n.tabIndex=-1},n.onclick=function(t){Fit.Events.GetTarget(t)===n&&(x=!0,h=!0,B(null!==g?g.previousSibling:r)),e.OpenDropDown()},Fit.Dom.AddClass(n,"FitUiControlDropDownItems"),i=document.createElement("i"),Fit.Dom.AddClass(i,"fa"),Fit.Dom.AddClass(i,"fa-chevron-down"),i.tabIndex=!0===S?0:-1,i.onmousedown=function(t){!1===S&&(i.tabIndex=0)},i.onmouseup=function(t){!1===S&&(i.tabIndex=-1,h=!0,B(null!==g?g.previousSibling:r))},i.onclick=function(t){x=!1,!0===e.IsDropDownOpen()&&(e.CloseDropDown(),Fit.Events.StopPropagation(t),!0===S&&e.Focused(!1))},r=b(),d=r,s=document.createElement("div"),("MSIE"!==Fit.Browser.GetBrowser()||Fit.Browser.GetVersion()>=9)&&(s.onmousewheel=function(t){var e=Fit.Events.GetEvent(t);s.firstChild.scrollTop-=void 0!==e.wheelDeltaY?e.wheelDeltaY:e.wheelDelta,Fit.Events.PreventDefault(e)}),Fit.Dom.AddClass(s,"FitUiControlDropDownPicker"),s.style.display="none",o=document.createElement("div"),Fit.Dom.AddClass(o,"FitUiControlDropDownHidden"),a=document.createElement("span"),!1===S){var t=Fit.Events.AddHandler(document,"click",function(t){var n=Fit.Events.GetTarget(t);!0===e.IsDropDownOpen()&&n!==e.GetDomElement()&&!1===Fit.Dom.Contained(e.GetDomElement(),n)&&e.CloseDropDown()});Fit.Array.Add(V,t)}else{var l=null;t=-1,t=Fit.Events.AddHandler(document,"touchstart",function(t){var n=Fit.Events.GetTarget(t);l=null,!0===e.IsDropDownOpen()&&n!==e.GetDomElement()&&!1===Fit.Dom.Contained(e.GetDomElement(),n)&&(l=Fit.Events.GetPointerState().Coordinates.Document)}),Fit.Array.Add(V,t),t=Fit.Events.AddHandler(document,"touchend",function(t){if(null!==l){var n=Fit.Events.GetPointerState().Coordinates.Document;!1==(Math.abs(l.X-n.X)>10||Math.abs(l.Y-n.Y)>10)&&(e.CloseDropDown(),e.Focused(!1))}}),Fit.Array.Add(V,t)}e.OnBlur(function(){!0===S&&(x=!1,e.CloseDropDown())}),Fit.Events.AddHandler(e.GetDomElement(),"contextmenu",function(t){if("INPUT"!==Fit.Events.GetTarget(t).tagName)return Fit.Events.PreventDefault(t)}),Fit.Dom.Add(o,a),Fit.Dom.Add(n,r),Fit.Dom.Add(n,i),e._internal.AddDomElement(n),e._internal.AddDomElement(s),e._internal.AddDomElement(o),e.AddCssClass("FitUiControlDropDown")}()},Fit._internal.DropDown={},Fit._internal.DropDown.Current=null,Fit.Controls.PickerBase=function(t){Fit.Validation.ExpectStringValue(t,!0),!0===Fit.Validation.IsSet(t)&&(void 0!==Fit._internal.ControlBase.Controls[t]&&Fit.Validation.ThrowError("Control with ID '"+t+"' has already been defined - Control IDs must be unique!"),Fit._internal.ControlBase.Controls[t]=this);var e=this,n=t||null,i=[],o=[],a=[],r=[],l=[];this.GetId=function(){return n},this.MaxHeight=function(t,n){Fit.Validation.ExpectNumber(t,!0),Fit.Validation.ExpectStringValue(n,!0);var i=e.GetDomElement();!0===Fit.Validation.IsSet(t)&&(i.style.maxHeight=-1!==t?t+(!0===Fit.Validation.IsSet(n)?n:"px"):"");var o={Value:-1,Unit:"px"};return""!==i.style.maxHeight&&(o.Value=parseFloat(i.style.maxHeight),o.Unit=i.style.maxHeight.replace(o.Value,"")),o},this.OnShow=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(i,t)},this.OnHide=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(o,t)},this.OnItemSelectionChanging=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(a,t)},this.OnItemSelectionChanged=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(r,t)},this.OnItemSelectionComplete=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(l,t)},this.GetDomElement=function(){Fit.Validation.ThrowError("Function not implemented")},this.UpdateItemSelection=function(t,n){if(Fit.Validation.ExpectString(t),Fit.Validation.ExpectBoolean(n),!1===e._internal.FireOnItemSelectionChanging("",t,!n))return!1;e._internal.FireOnItemSelectionChanged("",t,n)},this.SetSelections=function(t){Fit.Validation.ExpectArray(t),Fit.Array.ForEach(t,function(t){Fit.Validation.ExpectString(t.Title),Fit.Validation.ExpectString(t.Value)})},this.HandleEvent=function(t){Fit.Validation.ExpectEvent(t,!0)},this.Destroy=function(){e=n=i=o=a=r=l=null,!0===Fit.Validation.IsSet(t)&&delete Fit._internal.ControlBase.Controls[t]},this._internal=this._internal?this._internal:{},this._internal.InitializePicker=function(){},this._internal.FireOnShow=function(){Fit.Array.ForEach(i,function(t){t(e)})},this._internal.FireOnHide=function(){Fit.Array.ForEach(o,function(t){t(e)})},this._internal.FireOnItemSelectionChanging=function(t,n,i){Fit.Validation.ExpectString(t),Fit.Validation.ExpectString(n),Fit.Validation.ExpectBoolean(i);var o=!1;return Fit.Array.ForEach(a,function(a){!1===a(e,{Title:t,Value:n,Selected:i})&&(o=!0)}),!o},this._internal.FireOnItemSelectionChanged=function(t,n,i){Fit.Validation.ExpectString(t),Fit.Validation.ExpectString(n),Fit.Validation.ExpectBoolean(i),Fit.Array.ForEach(r,function(o){o(e,{Title:t,Value:n,Selected:i})})},this._internal.FireOnItemSelectionComplete=function(){Fit.Array.ForEach(l,function(t){t(e)})}},Fit.Controls.WSDropDown=function(t){Fit.Validation.ExpectStringValue(t),Fit.Core.Extend(this,Fit.Controls.DropDown).Apply(t);var e=this,n=null,i=null,o="",a=!1,r=!1,l=null,d=null,u=null,s=[],c=[],F=[];function m(t){null!==l&&(clearTimeout(l),l=null),null===d?""!==(o=t)&&(n.RemoveItems(),e.SetPicker(n),l=setTimeout(function(){!1===e.IsDropDownOpen()&&(r=!0,e.OpenDropDown()),n.Reload(),l=null},500)):a=!0}function f(t,n,i){var a=!1;return Fit.Array.ForEach(t,function(t){var r=null;i.Children?r=i.Children:i.Items&&(r=i.Items);var l={Sender:e,Picker:n,Node:i.Node?i.Node:null,SelectAll:i.SelectAll,Search:o,Data:r,Request:i.Request};!1===t(e,l)&&(a=!0),i.Children?i.Children=l.Data:i.Items&&(i.Items=l.Data)}),!a}this.Url=function(t){return Fit.Validation.ExpectString(t,!0),!0===Fit.Validation.IsSet(t)&&(n.Url(t),i.Url(t)),n.Url()},this.JsonpCallback=function(t){return Fit.Validation.ExpectString(t,!0),!0!==Fit.Validation.IsSet(t)&&null!==t||(n.JsonpCallback(t),i.JsonpCallback(t)),n.JsonpCallback()},this.MultiSelectionMode=Fit.Core.CreateOverride(this.MultiSelectionMode,function(t){return Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t)&&i.Selectable(!0,t),base(t)}),this.GetListView=function(){return n},this.GetTreeView=function(){return i},this.Dispose=Fit.Core.CreateOverride(this.Dispose,function(){e.SetPicker(null),n.Destroy(),i.Destroy(),e=n=i=o=a=r=l=d=u=s=c=null,base()}),this.OnRequest=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(s,t)},this.OnResponse=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(c,t)},this.OnAbort=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(F,t)},function(){e.OnInputChanged(function(t,n){!0===e.Focused()&&m(n)});var o=e.GetDomElement().firstChild.children[e.GetDomElement().firstChild.children.length-1];u=o.className,(n=new Fit.Controls.WSListView(t+"__WSListView")).OnRequest(function(t,e){if(!1===f(s,n,e))return!1;d=e.Request,o.className="fa fa-refresh fa-spin"}),n.OnResponse(function(t,i){f(c,n,i),o.className=u,d=null,!0===a&&(a=!1,i.Items=[],m(e.GetInputValue()))}),n.OnItemSelectionChanging(function(t,e){var n=i.GetChild(e.Value,!0);if(null!==n&&!1===n.Selectable())return!1}),n.OnItemSelectionChanged(function(t,n){!0===n.Selected&&e.CloseDropDown()});var l=!0;(i=new Fit.Controls.WSTreeView(t+"__WSTreeView")).Selectable(!0),i.Width(100,"%"),i.OnRequest(function(t,e){if(!1===f(s,i,e))return!1;null===e.Node&&(o.className="fa fa-refresh fa-spin")}),i.OnResponse(function(t,e){f(c,i,e),o.className=u}),i.OnAbort(function(t,e){f(F,i,e),o.className=u}),i.OnPopulated(function(t,e){if(!0===l){var n=!1;Fit.Array.ForEach(i.GetChildren(),function(t){if(t.GetChildren().length>0)return n=!0,!1}),!1===n&&i.Lines(!1),l=!1}}),i.OnSelectAll(function(t,n){e.Focused(!1),e.GetPicker()!==i&&e.SetPicker(i)}),e.OnOpen(function(){if(!0!==r){if(e.SetPicker(i),0===i.GetChildren().length){var t=i.Selected();i.Reload(),i.Selected(t)}}else r=!1})}()},Fit.Controls.FilePicker=function(t){Fit.Validation.ExpectStringValue(t),Fit.Core.Extend(this,Fit.Controls.ControlBase).Apply(t);var e=this,n=null,i=null,o={Value:-1,Unit:"px"},a=null,r=[],l=[],d=[],u=[],s=[],c=[],F=[];function m(){var t=document.createElement("input");t.type="file",t.onchange=function(n){0===l.length?(r=[],Fit.Array.ForEach(t.files,function(e){Fit.Array.Add(r,{Filename:e.name,Type:e.type,Size:e.size,Id:Fit.Data.CreateGuid(),Processed:!1,Input:t,FileObject:e,GetImagePreview:function(){return function(t){if(l.length>0)return null;if("image/png"===t.type||"image/jpg"===t.type||"image/jpeg"===t.type||"image/svg"===t.type||"image/gif"===t.type){var e=new Image;return setTimeout(function(){var n=new FileReader;n.onload=function(t){var n=Fit.Events.GetEvent(t);e.src=n.target.result},n.readAsDataURL(t)},0),e}return null}(e)},ServerResponse:null})})):(r=[],Fit.Array.ForEach(Fit.Array.Copy(l),function(t){if(""!==t.value){var n=null;n=!0===e.MultiSelectionMode()&&void 0!==t._file&&!0===t._file.Processed?t._file:{Filename:t.value,Type:"Unknown",Size:-1,Id:Fit.Data.CreateGuid(),Processed:!1,Input:t,FileObject:null,GetImagePreview:function(){return null},ServerResponse:null},t._file=n,Fit.Array.Add(r,n)}else!0===e.MultiSelectionMode()&&(Fit.Dom.Remove(t),Fit.Array.Remove(l,t))}),!0===e.MultiSelectionMode()&&m()),e._internal.FireOnChange(),!0===e.AutoPostBack()&&e.Upload()},t.files&&!Fit.Controls.FilePicker.ForceLegacyMode?((i=t).tabIndex=-1,Fit.Events.AddHandler(i,"click",function(t){Fit.Events.StopPropagation(t)})):(t.name="SelectedFile",Fit.Array.Add(l,t),e._internal.AddDomElement(t))}function f(t,n,i){var o=!1;return Fit.Array.ForEach(t,function(t){if(!0===Fit.Validation.IsSet(n)){var a=n;a.Progress=100,!0===Fit.Validation.IsSet(i)&&(a.Progress=i),!1===t(e,a)&&(o=!0)}else!1===t(e)&&(o=!0)}),!o}this.Focused=function(t){return Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t)&&(0===l.length?!0===t?i.focus():i.blur():!0===t?l[0].focus():l[0].blur()),Fit.Dom.GetFocused()===i},this.Value=function(t){Fit.Validation.ExpectString(t,!0),!0===Fit.Validation.IsSet(t)&&Fit.Validation.ThrowError("SecurityError: Due to security restrictions, the value of an upload control cannot be set");var e="";return Fit.Array.ForEach(r,function(t){e+=(""!==e?";":"")+t.Filename}),e},this.IsDirty=function(){return r.length>0},this.Clear=function(){0!==r.length&&(0===l.length?(i.value="",i.onchange(null)):(Fit.Array.ForEach(Fit.Array.Copy(l),function(t){Fit.Dom.Remove(t),Fit.Array.Remove(l,t)}),m(),l[0].onchange(null)))},this.Dispose=Fit.Core.CreateOverride(this.Dispose,function(){e=n=i=o=a=r=l=d=u=s=c=F=null,base()}),this.Width=Fit.Core.CreateOverride(this.Width,function(t,i){return Fit.Validation.ExpectNumber(t,!0),Fit.Validation.ExpectStringValue(i,!0),!0===Fit.Validation.IsSet(t)&&(t>-1?(o=base(t,i),0===l.length&&n.Width(100,"%")):(o={Value:-1,Unit:"px"},e.GetDomElement().style.width="auto",0===l.length&&n.Width(-1))),o}),this.Height=Fit.Core.CreateOverride(this.Height,function(t,e){return Fit.Validation.ExpectNumber(t,!0),Fit.Validation.ExpectStringValue(e,!0),!0===Fit.Validation.IsSet(t)&&0===l.length&&(base(t,e),t>-1?n.Height(100,"%"):n.Height(-1)),base()}),this.Url=function(t){return Fit.Validation.ExpectStringValue(t,!0),!0===Fit.Validation.IsSet(t)&&(a=t),a},this.Title=function(t){return Fit.Validation.ExpectString(t,!0),null===n?"":(!0===Fit.Validation.IsSet(t)&&(n.Title(t),Fit.Dom.Add(n.GetDomElement(),i)),n.Title())},this.GetFiles=function(){return r},this.MultiSelectionMode=function(t){return Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t)&&(0===l.length?!0===t&&!1===e.MultiSelectionMode()?(i.multiple="multiple",e.Title()===Fit.Language.Translations.SelectFile&&e.Title(Fit.Language.Translations.SelectFiles)):!1===t&&!0===e.MultiSelectionMode()&&(r.length>1&&e.Clear(),i.multiple="",e.Title()===Fit.Language.Translations.SelectFiles&&e.Title(Fit.Language.Translations.SelectFile)):e.Clear(),e._internal.Data("multiple",t.toString())),"true"===e._internal.Data("multiple")},this.Enabled=function(t){return Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t)&&(e._internal.Data("enabled",t.toString()),0===l.length?(i.disabled=!t,n.Enabled(t)):Fit.Array.ForEach(l,function(n){n.disabled=!t,!0===e.MultiSelectionMode()&&!0===t&&void 0!==n._file&&!0===n._file.Processed&&(n.disabled=!0)})),"true"===e._internal.Data("enabled")},this.IsLegacyModeEnabled=function(){return l.length>0},this.Upload=function(t){if(Fit.Validation.ExpectTypeArray(t,Fit.Validation.ExpectStringValue,!0),null===a&&Fit.Validation.ThrowError("Unable to upload file(s), no URL has been specified"),!1!==e.Enabled()){var n=[];if(Fit.Array.ForEach(r,function(e){if(!1===Fit.Validation.IsSet(t)||!1===Fit.Array.Contains(t,e.Filename)){if(!0===e.Processed)return;Fit.Array.Add(n,e)}}),0!==n.length&&!1!==f(d)){var i=[];Fit.Array.ForEach(n,function(t){if(t.Processed=!0,0===l.length){var o=new FormData;o.append("SelectedFile",t.FileObject);var r=new XMLHttpRequest;Fit.Events.AddHandler(r.upload,"progress",function(e){var n=Fit.Events.GetEvent(e);f(u,t,n.loaded>0&&n.total>0?Math.floor(n.loaded/n.total*100):0)}),Fit.Events.AddHandler(r,"readystatechange",function(e){4===r.readyState&&(200===r.status?(t.ServerResponse=r.responseText,Fit.Array.Add(i,t),f(s,t)):(Fit.Array.Add(i,t),f(c,t)),i.length===n.length&&f(F))}),r.open("POST",a),r.send(o)}else{var d="MSIE"!==Fit.Browser.GetInfo().Name||Fit.Browser.GetInfo().Version>8,m=t.Input,p=null,E=null,h=0,v=null;(p=document.createElement("iframe")).name="iFrame"+Fit.Data.CreateGuid(),p.style.display="none",!0===d&&Fit.Dom.InsertAfter(m,p),Fit.Events.AddHandler(p,"load",function(e){try{t.ServerResponse=p.contentDocument.body.innerHTML}catch(t){Fit.Browser.Log("Unable to read server response, most likely due to violation of Same-Origin Policy")}Fit.Dom.Remove(p),clearInterval(v),Fit.Array.Add(i,t),f(u,t,100),f(s,t),i.length===n.length&&f(F)}),!1===d&&Fit.Dom.InsertAfter(m,p),(E=document.createElement("form")).action=a,E.method="POST",E.setAttribute("enctype","multipart/form-data"),E.target=p.name,Fit.Dom.InsertAfter(m,E),E.appendChild(m),E.submit(),Fit.Dom.InsertBefore(p,m),Fit.Dom.Remove(E),v=setInterval(function(){f(u,t,h+=5),90===h&&clearInterval(v)},1e3),!0===e.MultiSelectionMode()&&(m.disabled=!0)}})}}},this.OnUpload=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(d,t)},this.OnProgress=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(u,t)},this.OnSuccess=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(s,t)},this.OnFailure=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(c,t)},this.OnCompleted=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(F,t)},m(),0===l.length&&((n=new Fit.Controls.Button("Button"+e.GetId())).Title(Fit.Language.Translations.SelectFile),n.Icon("upload"),n.OnClick(function(t){i.click()}),Fit.Dom.Add(n.GetDomElement(),i),e._internal.AddDomElement(n.GetDomElement())),e.AddCssClass("FitUiControlFilePicker"),e.Width(-1),e.Enabled(!0),e._internal.Data("legacy",(l.length>0).toString())},Fit.Controls.Input=function(t){Fit.Validation.ExpectStringValue(t),Fit.Core.Extend(this,Fit.Controls.ControlBase).Apply(t);var e=this,n="",i="",o=null,a=null,r=null,l=!1,d=-1,u=-1,s=null,c=-1,F="MSIE"===Fit.Browser.GetInfo().Name&&8===Fit.Browser.GetInfo().Version;this.Focused=function(t){Fit.Validation.ExpectBoolean(t,!0);var e=null!==r?r:o;return!0===Fit.Validation.IsSet(t)&&(!0===t?e.focus():e!==r&&e.blur()),Fit.Dom.GetFocused()===e},this.Value=function(t){if(Fit.Validation.ExpectString(t,!0),!0===Fit.Validation.IsSet(t)){var a=e.Value()!==t;n=t,i=t,null!==r?CKEDITOR.instances[e.GetId()+"_DesignMode"].setData(t):o.value=t,!0===a&&e._internal.FireOnChange()}return null!==r?CKEDITOR.instances[e.GetId()+"_DesignMode"].getData():o.value},this.IsDirty=function(){return n!==e.Value()},this.Clear=function(){e.Value("")};var m=e.Dispose;this.Dispose=function(){null!==r&&r.destroy(),e=n=i=o=a=r=l=d=u=s=c=F=null,m()};var f=e.Width;this.Width=function(t,e){return Fit.Validation.ExpectNumber(t,!0),Fit.Validation.ExpectStringValue(e,!0),!0===Fit.Validation.IsSet(t)&&(f(t,e),h()),f()};var p=e.Height;function E(){!0!==CKEDITOR._loading?(CKEDITOR._loading=!0,CKEDITOR.on("instanceLoaded",function(){CKEDITOR._loading=!1}),!1===Fit.Dom.IsRooted(e.GetDomElement())&&(CKEDITOR._loading=!1,Fit.Validation.ThrowError("Control must be appended/rendered to DOM before DesignMode can be initialized")),r=CKEDITOR.replace(e.GetId()+"_DesignMode",{skin:!0===Fit.Validation.IsSet(Fit._internal.Controls.Input.DefaultSkin)?Fit._internal.Controls.Input.DefaultSkin:"moono",language:"da"===Fit.Browser.GetInfo().Language?"da":"en",extraPlugins:"justify,pastefromword",toolbar:[{name:"BasicFormatting",items:["Bold","Italic","Underline"]},{name:"Justify",items:["JustifyLeft","JustifyCenter","JustifyRight"]},{name:"Lists",items:["NumberedList","BulletedList","Indent","Outdent"]},{name:"Links",items:["Link","Unlink"]}],removeButtons:"",on:{instanceReady:function(){var t=e.Height();e.Height(t.Value>=150&&"px"===t.Unit?t.Value:150)},change:function(){o.onkeyup()},focus:function(){e._internal.FireOnFocus()},blur:function(){e._internal.FireOnBlur()}}})):setTimeout(E,100)}function h(){if(null!==r){var t=e.Width(),n=e.Height();if("px"!==t.Unit||"px"!==n.Unit)throw new Error("DesignMode does not support resizing in units different from px");r.resize(t.Value>-1?t.Value:200,n.Value>-1?n.Value:150),-1!==c&&(Fit.Events.RemoveMutationObserver(c),c=-1);var i=Fit.Dom.GetConcealer(e.GetDomElement());null!==i&&(c=Fit.Events.AddMutationObserver(i,function(i){!0===Fit.Dom.IsVisible(e.GetDomElement())&&(r.resize(t.Value>-1?t.Value:200,n.Value>-1?n.Value:150),disconnect())}))}}function v(){!0===F&&(e.AddCssClass("FitUi_Non_Existing_Input_Class"),e.RemoveCssClass("FitUi_Non_Existing_Input_Class"))}this.Height=function(t,n,i){if(Fit.Validation.ExpectNumber(t,!0),Fit.Validation.ExpectStringValue(n,!0),Fit.Validation.ExpectBoolean(i,!0),!0===Fit.Validation.IsSet(t)){var o=p(t,n);h(),!0===e.Maximizable()&&!0!==i&&(d=o.Value,u=u>o.Value&&o.Unit===s?u:2*o.Value,s=o.Unit,e.Maximized(!1))}return p()},this.Placeholder=function(t){return Fit.Validation.ExpectString(t,!0),!0===Fit.Validation.IsSet(t)&&(o.placeholder=t),o.placeholder?o.placeholder:""},this.CheckSpelling=function(t){return Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t)&&(o.spellcheck=t),o.spellcheck},this.Type=function(t){return Fit.Validation.ExpectStringValue(t,!0),!0===Fit.Validation.IsSet(t)&&(!1!==Fit.Validation.IsSet(Fit.Controls.InputType[t])&&t!==Fit.Controls.InputType.Unknown||Fit.Validation.ThrowError("Unsupported input type specified - use e.g. Fit.Controls.InputType.Text"),t===Fit.Controls.InputType.Textarea?e.MultiLine(!0):(e.MultiLine(!1),t===Fit.Controls.InputType.Color?o.type="color":t===Fit.Controls.InputType.Date?o.type="date":t===Fit.Controls.InputType.DateTime?o.type="datetime":t===Fit.Controls.InputType.Email?o.type="email":t===Fit.Controls.InputType.Month?o.type="month":t===Fit.Controls.InputType.Number?o.type="number":t===Fit.Controls.InputType.Password?o.type="password":t===Fit.Controls.InputType.PhoneNumber?o.type="tel":t===Fit.Controls.InputType.Text?o.type="text":t===Fit.Controls.InputType.Time?o.type="time":t===Fit.Controls.InputType.Week&&(o.type="week"))),!0===e.MultiLine()||!0===e.DesignMode()?Fit.Controls.InputType.Textarea:"color"===o.type?Fit.Controls.InputType.Color:"date"===o.type?Fit.Controls.InputType.Date:"datetime"===o.type?Fit.Controls.InputType.DateTime:"email"===o.type?Fit.Controls.InputType.Email:"month"===o.type?Fit.Controls.InputType.Month:"number"===o.type?Fit.Controls.InputType.Number:"password"===o.type?Fit.Controls.InputType.Password:"tel"===o.type?Fit.Controls.InputType.PhoneNumber:"text"===o.type?Fit.Controls.InputType.Text:"time"===o.type?Fit.Controls.InputType.Time:"week"===o.type?Fit.Controls.InputType.Week:Fit.Controls.InputType.Unknown},this.MultiLine=function(t){if(Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t))if(!0===e.DesignMode()&&e.DesignMode(!1),!0===t&&"INPUT"===o.tagName){var n=o;e._internal.RemoveDomElement(n),(o=document.createElement("textarea")).value=n.value,o.spellcheck=n.spellcheck,o.onkeyup=n.onkeyup,o.onchange=n.onchange,e._internal.AddDomElement(o),-1===e.Height().Value&&e.Height(150),e._internal.Data("multiline","true"),v()}else if(!1===t&&"TEXTAREA"===o.tagName){n=o;e._internal.RemoveDomElement(n),null!==a&&(e._internal.RemoveDomElement(a),a=null,e._internal.Data("maximized","false"),e._internal.Data("maximizable","false"),v()),(o=document.createElement("input")).autocomplete="off",o.type="text",o.value=n.value,o.spellcheck=n.spellcheck,o.onkeyup=n.onkeyup,o.onchange=n.onchange,e._internal.AddDomElement(o),e.Height(-1),l=!1,e._internal.Data("multiline","false"),v()}return"TEXTAREA"===o.tagName&&null===r},this.Maximizable=function(t,n){if(Fit.Validation.ExpectBoolean(t,!0),Fit.Validation.ExpectNumber(n,!0),!0===Fit.Validation.IsSet(t))if(!0===t&&null===a){!0===e.MultiLine()&&(l=!0),!1===e.MultiLine()&&null===r&&e.MultiLine(!0);var i=e.Height();null===r?(d=i.Value,u=!0===Fit.Validation.IsSet(n)?n:-1!==d?2*d:150,s=i.Unit):(d=i.Value,u=!0===Fit.Validation.IsSet(n)?n:-1!==d?2*d:300,s="px"),(a=document.createElement("span")).onclick=function(){e.Maximized(!e.Maximized())},Fit.Dom.AddClass(a,"fa"),Fit.Dom.AddClass(a,"fa-chevron-down"),e._internal.AddDomElement(a),e._internal.Data("maximizable","true"),v()}else!1===t&&null!==a&&(e._internal.RemoveDomElement(a),a=null,!0===l?e.Height(d,s):e.MultiLine(!1),e._internal.Data("maximizable","false"),v());return null!==a},this.Maximized=function(t){return Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t)&&null!==a&&(!0===t&&!1===Fit.Dom.HasClass(a,"fa-chevron-up")?(e.Height(u,s,!0),Fit.Dom.RemoveClass(a,"fa-chevron-down"),Fit.Dom.AddClass(a,"fa-chevron-up"),e._internal.Data("maximized","true"),v()):!1===t&&!1===Fit.Dom.HasClass(a,"fa-chevron-down")&&(e.Height(d,s,!0),Fit.Dom.RemoveClass(a,"fa-chevron-up"),Fit.Dom.AddClass(a,"fa-chevron-down"),e._internal.Data("maximized","false"),v())),null!==a&&!0===Fit.Dom.HasClass(a,"fa-chevron-up")},this.DesignMode=function(t){if(Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t)){var n="true"===e._internal.Data("designmode");if(!0===t&&!1===n){if(!0===e.MultiLine()?l=!0:e.MultiLine(!0),o.id=e.GetId()+"_DesignMode",void 0===window.CKEDITOR)window.CKEDITOR=null,Fit.Loader.LoadScript(Fit.GetUrl()+"/Resources/CKEditor/ckeditor.js",function(t){E()});else if(null===window.CKEDITOR)var i=setInterval(function(){null!==window.CKEDITOR&&(clearInterval(i),E())},500);else E();e._internal.Data("designmode","true"),v()}else!1===t&&!0===n&&(r.destroy(),r=null,!1===l&&e.MultiLine(!1),e._internal.Data("designmode","false"),v())}return"true"===e._internal.Data("designmode")},(o=document.createElement("input")).type="text",o.autocomplete="off",o.spellcheck=!0,o.onkeyup=function(){e.Value()!==i&&(i=e.Value(),e._internal.FireOnChange())},o.onchange=function(){o.onkeyup()},e._internal.AddDomElement(o),e.AddCssClass("FitUiControlInput"),e._internal.Data("multiline","false"),e._internal.Data("maximizable","false"),e._internal.Data("maximized","false"),e._internal.Data("designmode","false")},Fit.Controls.InputType={Textarea:"Textarea",Color:"Color",Date:"Date",DateTime:"DateTime",Email:"Email",Month:"Month",Number:"Number",Password:"Password",PhoneNumber:"PhoneNumber",Text:"Text",Time:"Time",Week:"Week",Unknown:"Unknown"},Fit.Controls.Input.Type=Fit.Controls.InputType,Fit._internal.Controls.Input={},Fit._internal.Controls.Input.DefaultSkin=null,Fit.Controls.ListView=function(t){Fit.Validation.ExpectStringValue(t,!0),Fit.Core.Extend(this,Fit.Controls.PickerBase).Apply(t);var e=this,n=null,i=null,o="MSIE"===Fit.Browser.GetInfo().Name&&8===Fit.Browser.GetInfo().Version;function a(t){Fit.Validation.ExpectDomElement(t,!0),null!==i&&Fit.Dom.Data(i,"active","false"),null!==(i=t||null)&&(Fit.Dom.Data(i,"active","true"),n.scrollTop=i.offsetHeight*Fit.Dom.GetIndex(i),!0===o&&(Fit.Dom.AddClass(n,"FitUi_Non_Existing_ListView_Class"),Fit.Dom.RemoveClass(n,"FitUi_Non_Existing_ListView_Class")))}function r(){0!==n.children.length&&(null===i?a(n.firstChild):null!==i.previousSibling&&a(i.previousSibling))}function l(){0!==n.children.length&&(null===i?a(n.firstChild):null!==i.nextSibling&&a(i.nextSibling))}function d(t){return Fit.Validation.ExpectString(t),decodeURIComponent(t)}this.AddItem=function(t,e){Fit.Validation.ExpectString(t),Fit.Validation.ExpectString(e);var i,o=document.createElement("div");o.innerHTML=t,Fit.Dom.Data(o,"value",(i=e,Fit.Validation.ExpectString(i),encodeURIComponent(i))),Fit.Dom.Data(o,"active","false"),n.appendChild(o)},this.HasItem=function(t){Fit.Validation.ExpectString(t);var e=!1;return Fit.Array.ForEach(n.children,function(n){if(d(Fit.Dom.Data(n,"value"))===t)return e=!0,!1}),e},this.RemoveItem=function(t){Fit.Validation.ExpectString(t),Fit.Array.ForEach(Fit.Array.Copy(n.children),function(e){if(d(Fit.Dom.Data(e,"value"))===t)return Fit.Dom.Remove(e),!1})},this.RemoveItems=function(){n.innerHTML="",a(null)},this.GetDomElement=function(){return n},this.HandleEvent=function(t){Fit.Validation.ExpectEvent(t,!0);var o=Fit.Events.GetEvent(t);"keydown"===o.type&&(38===o.keyCode?(r(),Fit.Events.PreventDefault(o)):40===o.keyCode?(l(),Fit.Events.PreventDefault(o)):13===o.keyCode&&(null===i&&1===n.children.length&&l(),null!==i&&!0===e._internal.FireOnItemSelectionChanging(Fit.Dom.Text(i),d(Fit.Dom.Data(i,"value")),!1)&&(e._internal.FireOnItemSelectionChanged(Fit.Dom.Text(i),d(Fit.Dom.Data(i,"value")),!0),e._internal.FireOnItemSelectionComplete()),Fit.Events.PreventDefault(o)))},this.Destroy=Fit.Core.CreateOverride(this.Destroy,function(){Fit.Dom.Remove(n),e=n=i=o=null,base()}),Fit._internal.Core.EnsureStyles(),(n=document.createElement("div")).tabIndex="0",Fit.Dom.AddClass(n,"FitUiControlListView"),e.OnShow(function(){n.scrollTop=0,a(null)}),n.onclick=function(t){Fit.Events.GetEvent(t);var i=Fit.Events.GetTarget(t);if(i!==n){for(;i.parentElement!==n;)i=i.parentElement;a(i),!0===e._internal.FireOnItemSelectionChanging(Fit.Dom.Text(i),d(Fit.Dom.Data(i,"value")),!1)&&(e._internal.FireOnItemSelectionChanged(Fit.Dom.Text(i),d(Fit.Dom.Data(i,"value")),!0),e._internal.FireOnItemSelectionComplete())}},n.onfocus=function(t){Fit.Events.GetEvent(t),!0!==Fit.Events.GetPointerState().Buttons.Primary&&(!0===Fit.Events.GetModifierKeys().Shift?n.children.length>0&&a(n.children[n.children.length-1]):n.children.length>0&&a(n.children[0]))},n.onkeydown=function(t){var o=Fit.Events.GetEvent(t);if(9===o.keyCode&&!1===o.shiftKey){if(i!==n.children[n.children.length-1])return l(),Fit.Events.PreventDefault(o),!1}else if(9===o.keyCode&&!0===o.shiftKey){if(i!==n.firstChild)return r(),Fit.Events.PreventDefault(o),!1}else e.HandleEvent(o)}},Fit.Controls.WSListView=function(t){Fit.Validation.ExpectStringValue(t,!0),Fit.Core.Extend(this,Fit.Controls.ListView).Apply(t);var e=this,n=null,i=null,o=[],a=[],r=[],l=[];function d(t,n){var i=!1;return Fit.Array.ForEach(t,function(t){!1===t(e,n)&&(i=!0)}),!i}this.Url=function(t){return Fit.Validation.ExpectString(t,!0),!0===Fit.Validation.IsSet(t)&&(n=t),n},this.JsonpCallback=function(t){return Fit.Validation.ExpectString(t,!0),!0!==Fit.Validation.IsSet(t)&&null!==t||(i=t),i},this.Reload=function(){!function(){null===n&&Fit.Validation.ThrowError("Unable to get data, no WebService URL has been specified");var t=null;t=null!==i?new Fit.Http.JsonpRequest(n,i):new Fit.Http.JsonRequest(n);var u={Sender:e,Request:t,Items:null};if(!1===d(o,u))return;var s=function(t){u.Items=t instanceof Array?t:[],d(a,u),e.RemoveItems(),Fit.Array.ForEach(u.Items,function(t){!function t(n){Fit.Validation.ExpectIsSet(n);Fit.Validation.ExpectString(n.Value);Fit.Validation.ExpectString(n.Title,!0);Fit.Validation.ExpectBoolean(n.Selectable,!0);Fit.Validation.ExpectArray(n.Children,!0);!1!==n.Selectable&&e.AddItem(n.Title?n.Title:n.Value,n.Value);n.Children&&Fit.Array.ForEach(n.Children,function(e){t(e)})}(t)}),d(l,u)},c=function(t){Fit.Validation.ThrowError("Unable to get data - request failed with HTTP Status code "+t)};!1===Fit.Core.InstanceOf(t,Fit.Http.JsonpRequest)?(t.OnSuccess(function(e){var n=t.GetResponseJson();s(n)}),t.OnFailure(function(e){c(t.GetHttpStatus())}),t.OnAbort(function(t){d(r,u)})):(t.OnSuccess(function(t){var e=t.GetResponse();s(e)}),t.OnTimeout(function(){c("UNKNOWN (JSONP)")}));t.Start()}()},this.Destroy=Fit.Core.CreateOverride(this.Destroy,function(){e=n=i=o=a=r=l=null,base()}),this.OnRequest=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(o,t)},this.OnResponse=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(a,t)},this.OnAbort=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(r,t)},this.OnPopulated=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(l,t)}},Fit.Controls.ProgressBar=function(t){Fit.Validation.ExpectStringValue(t,!0),!0===Fit.Validation.IsSet(t)&&(void 0!==Fit._internal.ControlBase.Controls[t]&&Fit.Validation.ThrowError("Control with ID '"+t+"' has already been defined - Control IDs must be unique!"),Fit._internal.ControlBase.Controls[t]=this);var e=this,n=t||null,i=null,o=null,a="",r={Value:200,Unit:"px"},l=[];this.GetId=function(){return n},this.Title=function(t){return Fit.Validation.ExpectString(t,!0),!0===Fit.Validation.IsSet(t)&&(a.innerHTML=t),a.innerHTML},this.Width=function(t,e){return Fit.Validation.ExpectNumber(t,!0),Fit.Validation.ExpectStringValue(e,!0),!0===Fit.Validation.IsSet(t)&&(t>-1?(r={Value:t,Unit:!0===Fit.Validation.IsSet(e)?e:"px"},i.style.width=r.Value+r.Unit):(r={Value:200,Unit:"px"},i.style.width="")),r},this.GetDomElement=function(){return i},this.Render=function(t){if(Fit.Validation.ExpectDomElement(t,!0),!0===Fit.Validation.IsSet(t))Fit.Dom.Add(t,i);else{var e=document.scripts[document.scripts.length-1];Fit.Dom.InsertBefore(e,i)}},this.Progress=function(t){return Fit.Validation.ExpectInteger(t,!0),!0===Fit.Validation.IsSet(t)&&t>=0&&t<=100&&o.style.width!==t+"%"&&(o.style.width=t+"%",Fit.Array.ForEach(l,function(t){t(e)})),parseInt(o.style.width)},this.OnProgress=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(l,t)},this.Dispose=function(){Fit.Dom.Remove(i),e=n=i=o=a=r=l=null,!0===Fit.Validation.IsSet(t)&&delete Fit._internal.ControlBase.Controls[t]},Fit._internal.Core.EnsureStyles(),i=document.createElement("div"),null!==n&&(i.id=n),Fit.Dom.AddClass(i,"FitUiControl"),Fit.Dom.AddClass(i,"FitUiControlProgressBar"),(o=document.createElement("div")).style.width="0%",Fit.Dom.AddClass(o,"FitUiControlProgressBarStatus"),Fit.Dom.Add(i,o),a=document.createElement("span"),Fit.Dom.Add(o,a)},Fit.Controls.TreeView=function(t){Fit.Validation.ExpectStringValue(t),Fit.Core.Extend(this,Fit.Controls.PickerBase).Apply(),Fit.Core.Extend(this,Fit.Controls.ControlBase).Apply(t);var e=this,n=null,i=null,o=!0,a=!1,r=!1,l=!1,d=!0,u=x(),s=[],c=null,F=[],m=[],f=[],p=[],E=[],h=[],v=!1,D="MSIE"===Fit.Browser.GetInfo().Name&&8===Fit.Browser.GetInfo().Version;this.WordWrap=function(t){return Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t)&&(e._internal.Data("wordwrap",t.toString()),w()),"true"===e._internal.Data("wordwrap")},this.Selectable=function(t,n,o){if(Fit.Validation.ExpectBoolean(t,!0),Fit.Validation.ExpectBoolean(n,!0),Fit.Validation.ExpectBoolean(o,!0),!0===Fit.Validation.IsSet(t)){a=t,r=!0===n,l=!0===o,e._internal.Data("selectable",a.toString()),e._internal.Data("multiselect",r.toString());var d=u.length>0;u=x(),C(function(){S(i,function(t){t!==i&&(t.Selectable(a,r,l),t.Selected(!1))})}),w(),!0===d&&e._internal.FireOnChange()}return a},this.Selected=function(t){if(Fit.Validation.ExpectArray(t,!0),!0===Fit.Validation.IsSet(t)){s=[];var n=u.length>0;C(function(){e.Clear(),Fit.Array.ForEach(t,function(t){Fit.Validation.ExpectInstance(t,Fit.Controls.TreeViewNode);var i=t.GetTreeView()===e?t:e.GetChild(t.Value(),!0);null===i&&Fit.Validation.ThrowError("Node is not assiciated with this TreeView, unable to change selection"),Fit.Array.Add(s,i),i.Selected(!0),n=!0})}),!0===n&&e._internal.FireOnChange()}return Fit.Array.Copy(u)},this.SelectAll=function(t,n){Fit.Validation.ExpectBoolean(t),Fit.Validation.ExpectInstance(n,Fit.Controls.TreeViewNode,!0);var o=n||null;if(!1!==O(E,{Node:o,Selected:t})){var a=!1;C(function(){var e=null!==o?[o]:i.GetChildren();Fit.Array.Recurse(e,"GetChildren",function(e){!0===e.Selectable()&&e.Selected()!==t&&(a=!0,e.Selected(t)),e.Expanded(!0)})}),!0===a&&e._internal.FireOnChange()}},this.AllowDeselect=function(t){return Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t)&&(d=t),d},this.Value=function(t){if(Fit.Validation.ExpectString(t,!0),!0===Fit.Validation.IsSet(t)){s=[];var n=u.length>0;C(function(){e.Clear();var i=t.split(";");Fit.Array.ForEach(i,function(t){var i,o=(i=-1===t.indexOf("=")?t:t.split("=")[1],Fit.Validation.ExpectString(i),i.replace(/%3B/g,";").replace(/%3D/g,"=")),a=e.GetChild(o,!0);null!==a&&(Fit.Array.Add(s,a),a.Selected(!0),n=!0)})}),!0===n&&e._internal.FireOnChange()}var i=e.Selected(),o="";return Fit.Array.ForEach(i,function(t){o+=(""!==o?";":"")+M(t.Title())+"="+M(t.Value())}),o},this.IsDirty=function(){if(u.length!==s.length)return!0;var t=!1;return Fit.Array.ForEach(s,function(e){if(!1===Fit.Array.Contains(u,e))return t=!0,!1}),t},this.Focused=function(t){if(Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t)){var e=_();if(!0===t&&null===e){var n=i.GetChildren();n.length>0&&n[0].Focused(!0)}else!1===t&&null!==e&&e.Focused(!1)}return null!==_()},this.Lines=function(t){return Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t)&&(!0===t?(e.AddCssClass("FitUiControlTreeViewLines"),e.AddCssClass("FitUiControlTreeViewDotLines")):(e.RemoveCssClass("FitUiControlTreeViewLines"),e.RemoveCssClass("FitUiControlTreeViewDotLines")),w()),e.HasCssClass("FitUiControlTreeViewLines")},this.ContextMenu=function(t){return Fit.Validation.ExpectInstance(t,Fit.Controls.ContextMenu,!0),void 0!==t&&(c=t),c},this.Clear=function(t){if(0!==u.length){v=!0!==t;var n=Fit.Array.Copy(u);C(function(){Fit.Array.ForEach(n,function(e){!0===t&&!0!==e.Selectable()||e.Selected(!1)})}),v=!1,e._internal.FireOnChange()}},this.AddChild=function(t){Fit.Validation.ExpectInstance(t,Fit.Controls.TreeViewNode),i.AddChild(t)},this.RemoveChild=function(t){Fit.Validation.ExpectInstance(t,Fit.Controls.TreeViewNode),i.RemoveChild(t)},this.RemoveAllChildren=function(t){Fit.Validation.ExpectBoolean(t,!0);var n=u.length>0;u=x(),C(function(){var e=i.GetChildren();Fit.Array.ForEach(e,function(e){!0===t?e.Dispose():i.RemoveChild(e)})}),!0===n&&e._internal.FireOnChange()},this.GetChild=function(t,e){return Fit.Validation.ExpectString(t),Fit.Validation.ExpectBoolean(e,!0),i.GetChild(t,e)},this.GetChildren=function(){return i.GetChildren()},this.GetAllNodes=function(){var t=[];return S(i,function(e){e!==i&&Fit.Array.Add(t,e)}),t},this.GetNodeFocused=function(){return _()},this.GetNodeAbove=function(t){return G(t,!0)},this.GetNodeBelow=function(t){return T(t,!0,!0)},this.KeyboardNavigation=function(t){return Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t)&&(o=t),o};var y=e.Dispose;this.Dispose=function(){e._internal.ExecuteWithNoOnChange(function(){i.Dispose()}),e=n=i=a=r=l=u=s=c=h=F=m=f=p=g=V=D=null,y()},this.OnSelect=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(F,t)},this.OnSelected=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(m,t)},this.OnToggle=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(f,t)},this.OnToggled=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(p,t)},this.OnSelectAll=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(E,t)},this.OnContextMenu=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(h,t)};var g=!1,V=null;function C(t){Fit.Validation.ExpectFunction(t),e._internal.ExecuteWithNoOnChange(t)}function S(t,e){if(Fit.Validation.ExpectInstance(t,Fit.Controls.TreeViewNode),Fit.Validation.ExpectFunction(e),!1===e(t))return!1;Fit.Array.ForEach(t.GetChildren(),function(t){if(!1===S(t,e))return!1})}function x(){return[]}function w(){!0===D&&(e.AddCssClass("FitUi_Non_Existing_TreeView_Class"),e.RemoveCssClass("FitUi_Non_Existing_TreeView_Class"))}function I(t){Fit.Validation.ExpectInstance(t,Fit.Controls.TreeViewNode),!0===t.Selected()&&!1===d||t.Selected(!t.Selected())}function A(t){if(Fit.Validation.ExpectInstance(t,Fit.Controls.TreeViewNode),!0===g){null!==V&&Fit.Dom.Data(V.GetDomElement(),"active",null),V=t,Fit.Dom.Data(V.GetDomElement(),"active","true");for(var n={X:V.GetDomElement().offsetLeft,Y:V.GetDomElement().offsetTop},i=V.GetDomElement().offsetParent;i!==e.GetDomElement();)n.X+=i.offsetLeft,n.Y+=i.offsetTop,i=i.offsetParent;var o,a=V.GetChildren().length>0?V.GetChildren()[0].GetDomElement().parentElement:null;null!==a&&(a.style.display="none"),o=V.GetDomElement().offsetHeight,null!==a&&(a.style.display=""),(n.Y>e.GetDomElement().scrollTop+e.GetDomElement().clientHeight-o||n.Y<e.GetDomElement().scrollTop)&&(e.GetDomElement().scrollTop=Math.ceil(n.Y-e.GetDomElement().clientHeight/2)),V.GetLevel()>2?e.GetDomElement().scrollLeft=Math.ceil(n.X):e.GetDomElement().scrollLeft=0,w()}else t.Focused(!0)}function _(){return Fit.Dom.GetFocused()&&"LI"===Fit.Dom.GetFocused().tagName&&Fit.Dom.GetFocused()._internal&&!0===Fit.Dom.Contained(n,Fit.Dom.GetFocused())?Fit.Dom.GetFocused()._internal.Node:null}function G(t,e){Fit.Validation.ExpectInstance(t,Fit.Controls.TreeViewNode),Fit.Validation.ExpectBoolean(e,!0);var n=t.GetParent(),o=(n=null!==n?n:i).GetChildren(),a=Fit.Array.GetIndex(o,t),r=a>0?o[a-1]:null;if(!0===e)return r;if(null!==r)for(;!0===r.Expanded();)r=(o=r.GetChildren())[o.length-1];else r=t.GetParent();return r}function T(t,e,n){if(Fit.Validation.ExpectInstance(t,Fit.Controls.TreeViewNode),Fit.Validation.ExpectBoolean(e,!0),Fit.Validation.ExpectBoolean(n,!0),!0===t.Expanded()&&!0!==e)return(a=t.GetChildren())[0];var o=t.GetParent(),a=(o=null!==o?o:i).GetChildren(),r=Fit.Array.GetIndex(a,t),l=a.length-1>=r+1?a[r+1]:null;return!0===n||null!==l||null===t.GetParent()?l:T(o,!0)}function b(t,e){Fit.Validation.ExpectInstance(t,Fit.Controls.TreeViewNode),null!==c&&!1!==O(h,t)&&(!0===Fit.Validation.IsSet(e)?c.Show(e.X,e.Y):c.Show())}function O(t,n){var i=!1;return Fit.Array.ForEach(t,function(t){!1===t(e,n)&&(i=!0)}),!i}function M(t){return Fit.Validation.ExpectString(t),t.replace(/;/g,"%3B").replace(/=/g,"%3D")}this.OnShow(function(t){e.GetDomElement().scrollTop=0,e.GetDomElement().scrollLeft=0}),this.OnSelect(function(t,n){return e._internal.FireOnItemSelectionChanging(n.Title(),n.Value(),n.Selected())}),this.OnSelected(function(t,n){e._internal.FireOnItemSelectionChanged(n.Title(),n.Value(),n.Selected())}),this.OnChange(function(t){e._internal.FireOnItemSelectionComplete()}),this.SetSelections=function(t){Fit.Validation.ExpectArray(t);var n=[],i=!1;Fit.Array.ForEach(t,function(t){Fit.Array.Add(n,t.Value)}),C(function(){Fit.Array.ForEach(Fit.Array.Copy(u),function(t){!1===Fit.Array.Contains(n,t.Value())&&!0===t.Selectable()&&(t.Selected(!1),i=!0)}),Fit.Array.ForEach(n,function(t){var n=e.GetChild(t,!0);null!==n&&!1===n.Selected()&&(n.Selected(!0),i=!0)})}),!0===i&&e._internal.FireOnChange()},this.UpdateItemSelection=function(t,n){Fit.Validation.ExpectString(t),Fit.Validation.ExpectBoolean(n);var i=e.GetChild(t,!0);if(null!==i&&i.Selected()!==n){if(!1===i.Selectable())return!1;if(i.Selected(n),i.Selected()!==n)return!1}},this._internal.InitializePicker=function(){g=!0},this.HandleEvent=function(t){Fit.Validation.ExpectEvent(t,!0);var e=Fit.Events.GetEvent(t);if("keydown"===e.type){if(i.GetDomElement().onkeydown(t),37===e.keyCode||39===e.keyCode)return!1;if(32===e.keyCode)return!1}},this.Destroy=Fit.Core.CreateOverride(this.Destroy,function(){e.Dispose(),base()}),function(){e.AddCssClass("FitUiControlTreeView"),e._internal.Data("selectable","false"),e._internal.Data("multiselect","false"),e._internal.Data("wordwrap","false"),n=document.createElement("ul"),e._internal.AddDomElement(n),(i=new Fit.Controls.TreeViewNode(" ","TREEVIEW_ROOT_NODE")).GetDomElement().tabIndex=-1,n.appendChild(i.GetDomElement());var t={Select:function(t){Fit.Validation.ExpectInstance(t,Fit.Controls.TreeViewNode),!1===r&&u.length>0&&C(function(){u[0].Selected(!1)}),Fit.Array.Add(u,t)},Deselect:function(t){Fit.Validation.ExpectInstance(t,Fit.Controls.TreeViewNode),Fit.Array.Remove(u,t)},Selected:function(t){return Fit.Validation.ExpectArray(t,!0),e.Selected(t)},IsSelectable:function(){return a},IsMultiSelect:function(){return r},ShowSelectAll:function(){return l},Repaint:function(){w()},FireToggle:function(t){return Fit.Validation.ExpectInstance(t,Fit.Controls.TreeViewNode),O(f,t)},FireToggled:function(t){return Fit.Validation.ExpectInstance(t,Fit.Controls.TreeViewNode),O(p,t)},FireSelect:function(t){return Fit.Validation.ExpectInstance(t,Fit.Controls.TreeViewNode),!(!1===v&&!1===r&&u.length>0&&!1===u[0].Selectable())&&O(F,t)},FireSelected:function(t){Fit.Validation.ExpectInstance(t,Fit.Controls.TreeViewNode),O(m,t)},FireOnChange:function(){e._internal.FireOnChange()},GetTreeView:function(){return e}};i.GetDomElement()._internal.TreeView=t,i.GetDomElement().onkeydown=function(t){var e=Fit.Events.GetEvent(t),n=Fit.Events.GetTarget(t);if(!1!==o)if(!0===g&&null===V&&i.GetChildren().length>0)A(i.GetChildren()[0]);else if("LI"!==n.tagName&&!0===g&&null!==V&&(n=V.GetDomElement()),"LI"===n.tagName){if(n===i.GetDomElement())return i.GetChildren().length>0&&A(i.GetChildren()[0]),void Fit.Events.PreventDefault(e);var a=n._internal.Node;if(93===e.keyCode||!0===Fit.Events.GetModifierKeys().Shift&&121===e.keyCode){var r=a.GetDomElement().querySelector("span"),l=Fit.Dom.GetPosition(r),d=Fit.Dom.GetScrollPosition(r),u=Fit.Dom.GetScrollPosition(document.body);return l.X=l.X-d.X+u.X+r.offsetWidth-10,l.Y=l.Y-d.Y+u.Y+r.offsetHeight-5,b(a,l),void Fit.Events.PreventDefault(e)}if(13!==e.keyCode){if(32===e.keyCode)return!0===a.Selectable()&&I(a),void Fit.Events.PreventDefault(e);var s=null;37===e.keyCode?(!0===a.Expanded()?a.Expanded(!1):s=a.GetParent(),Fit.Events.PreventDefault(e)):39===e.keyCode?(!1===a.Expanded()&&a.GetChildren().length>0&&a.Expanded(!0),Fit.Events.PreventDefault(e)):38===e.keyCode?(s=G(a),Fit.Events.PreventDefault(e)):40===e.keyCode&&(s=T(a),Fit.Events.PreventDefault(e)),null!==s&&A(s)}else{if(!0===a.Selectable())a.Selected(!0);else{var c=a.GetDomElement().getElementsByTagName("a");1===c.length&&c[0].click()}Fit.Events.PreventDefault(e)}}},i.GetDomElement().onclick=function(t){var e=Fit.Events.GetTarget(t);"INPUT"===e.tagName&&"LI"===e.parentElement.tagName&&(e.checked=!e.checked);var n=("LI"===e.tagName?e:Fit.Dom.GetParentOfType(e,"LI"))._internal.Node;A(n),e===n.GetDomElement().children[0]&&n.Expanded(!n.Expanded()),e!==n.GetDomElement().children[0]&&!0===n.Selectable()&&I(n)},Fit.Events.AddHandler(e.GetDomElement(),"contextmenu",function(t){return Fit.Events.PreventDefault(t)}),Fit.Events.AddHandler(e.GetDomElement(),"mouseup",function(t){if(!0===Fit.Events.GetPointerState().Buttons.Secondary){var n=Fit.Events.GetTarget(t);return n!==e.GetDomElement()&&b("LI"===n.tagName?n._internal.Node:Fit.Dom.GetParentOfType(n,"li")._internal.Node),Fit.Events.PreventDefault(t)}});var d=null;Fit.Events.AddHandler(e.GetDomElement(),"touchstart",function(t){var n=Fit.Events.GetTarget(t);n!==e.GetDomElement()&&(d=setTimeout(function(){b("LI"===n.tagName?n._internal.Node:Fit.Dom.GetParentOfType(n,"li")._internal.Node),d=null},500))}),Fit.Events.AddHandler(e.GetDomElement(),"touchend",function(t){Fit.Events.GetTarget(t),null!==d&&(clearTimeout(d),d=null)})}()},Fit.Controls.TreeViewNode=function(t,e){Fit.Validation.ExpectString(t),Fit.Validation.ExpectString(e);var n,i=this,o=null,a=null,r=null,l=null,d=null,u={},s=[],c=null;function F(t,e){if(Fit.Validation.ExpectInstance(t,Fit.Controls.TreeViewNode),Fit.Validation.ExpectFunction(e),!1===e(t))return!1;Fit.Array.ForEach(t.GetChildren(),function(t){if(!1===F(t,e))return!1})}this.Title=function(t){return Fit.Validation.ExpectStringValue(t,!0),!0===Fit.Validation.IsSet(t)&&(d.innerHTML=t,Fit.Array.ForEach(d.getElementsByTagName("a"),function(t){t.tabIndex=-1})),Fit.Dom.Text(d)},this.Value=function(){return t=Fit.Dom.Data(o,"value"),Fit.Validation.ExpectString(t),decodeURIComponent(t);var t},this.Expanded=function(t){if(Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t)&&"static"!==Fit.Dom.Data(o,"state")&&i.Expanded()!==t){var e=o._internal.TreeView;if(null!==e&&!1===e.FireToggle(i))return"expanded"===Fit.Dom.Data(o,"state");Fit.Dom.Data(o,"state",!0===t?"expanded":"collapsed"),null!==e&&(e.Repaint(),e.FireToggled(i))}return"expanded"===Fit.Dom.Data(o,"state")},this.Selectable=function(t,e,n){return Fit.Validation.ExpectBoolean(t,!0),Fit.Validation.ExpectBoolean(e,!0),Fit.Validation.ExpectBoolean(n,!0),!0===Fit.Validation.IsSet(t)&&(o._internal.TreeViewConfigOverrides.Selectable=t,o._internal.TreeViewConfigOverrides.ShowCheckbox=e,o._internal.TreeViewConfigOverrides.ShowSelectAll=n,Fit.Dom.Data(o,"selectable",t.toString()),!0===e&&null===l?((l=document.createElement("input")).type="checkbox",l.tabIndex="-1",l.checked=i.Selected(),Fit.Dom.InsertBefore(d,l)):!1===e&&null!==l&&(Fit.Dom.Remove(l),l=null),null!==l&&(l.disabled=!1===t)),"true"===Fit.Dom.Data(o,"selectable")},this.HasCheckbox=function(){return null!==l},this.Selected=function(t){if(Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t)&&i.Selected()!==t){var e=o._internal.TreeView;if(null!==e&&!1===e.FireSelect(i))return"true"===Fit.Dom.Data(o,"selected");var n=i.Selected();Fit.Dom.Data(o,"selected",t.toString()),null!==l&&(l.checked=t),null!==e&&e.Repaint(),null!==e&&(!0===t&&!1===n?(e.Select(i),e.FireSelected(i),e.FireOnChange()):!1===t&&!0===n&&(e.Deselect(i),e.FireSelected(i),e.FireOnChange()))}return"true"===Fit.Dom.Data(o,"selected")},this.Focused=function(t){return Fit.Validation.ExpectBoolean(t,!0),!0===Fit.Validation.IsSet(t)&&(!0===t?o.focus():Fit.Dom.GetFocused()===o&&o.blur()),Fit.Dom.GetFocused()===o},this.GetParent=function(){return o.parentElement&&o.parentElement.parentElement._internal&&o.parentElement.parentElement._internal.TreeView?"TREEVIEW_ROOT_NODE"===o.parentElement.parentElement._internal.Node.Value()?null:o.parentElement.parentElement._internal.Node:null},this.GetTreeView=function(){return null!==o._internal.TreeView?o._internal.TreeView.GetTreeView():null},this.GetLevel=function(){for(var t=0,e=i;null!==(e=e.GetParent());)t++;return t},this.AddChild=function(t){Fit.Validation.ExpectInstance(t,Fit.Controls.TreeViewNode),null!==t.GetParent()&&t.GetParent().RemoveChild(t),null!==t.GetTreeView()&&t.GetTreeView().RemoveChild(t),null===a&&(a=document.createElement("ul"),o.appendChild(a),Fit.Dom.Data(o,"state","collapsed")),null!==c&&Fit.Dom.Data(c.GetDomElement(),"last","false"),Fit.Dom.Data(t.GetDomElement(),"last","true"),c=t,a.appendChild(t.GetDomElement()),u[t.Value()]=t,Fit.Array.Add(s,t),null!==o._internal.TreeView&&o._internal.TreeView.Repaint();var e=o._internal.TreeView;if(null!==e){var n=[],i=!1;F(t,function(t){!0===t.Selected()&&(Fit.Array.Add(n,t),t.Selected(!1)),t.GetDomElement()._internal.TreeView=e;var i=t.GetDomElement()._internal.TreeViewConfigOverrides;t.Selectable(!0===Fit.Validation.IsSet(i.Selectable)?i.Selectable:e.IsSelectable(),!0===Fit.Validation.IsSet(i.ShowCheckbox)?i.ShowCheckbox:e.IsMultiSelect(),!0===Fit.Validation.IsSet(i.ShowSelectAll)?i.ShowSelectAll:e.ShowSelectAll())}),Fit.Array.ForEach(n,function(t){t.GetDomElement()._internal.TreeView=null,!0===e.FireSelect(t)&&(t.Selected(!0),e.Select(t),e.FireSelected(t),i=!0),t.GetDomElement()._internal.TreeView=e}),!0===i&&e.FireOnChange()}},this.RemoveChild=function(t){if(Fit.Validation.ExpectInstance(t,Fit.Controls.TreeViewNode),t.GetParent()===i||"TREEVIEW_ROOT_NODE"===i.Value()&&null!==i.GetTreeView().GetChild(t.Value())){var e=t.GetDomElement()._internal.TreeView;if(null!==e){var n=!1;F(t,function(t){!0===t.Selected()&&(e.Deselect(t),n=!0),t.GetDomElement()._internal.TreeView=null}),!0===n&&e.FireOnChange()}a.removeChild(t.GetDomElement()),delete u[t.Value()],Fit.Array.Remove(s,t),0===s.length&&(o.removeChild(a),a=null,Fit.Dom.Data(o,"state","static")),t===c&&(c=null,Fit.Dom.Data(t.GetDomElement(),"last","false"),s.length>0&&(c=s[s.length-1],Fit.Dom.Data(c.GetDomElement(),"last","true"))),null!==o._internal.TreeView&&o._internal.TreeView.Repaint()}},this.GetChild=function(t,e){Fit.Validation.ExpectString(t),Fit.Validation.ExpectBoolean(e,!0);var n=u[t];if(void 0===n&&!0===e){var i=null;return Fit.Array.ForEach(s,function(n){if(null!==(i=n.GetChild(t,e)))return!1}),i}return void 0!==n?n:null},this.GetChildren=function(){return Fit.Array.Copy(s)},this.Dispose=function(){Fit.Array.ForEach(Fit.Array.Copy(s),function(t){t.Dispose()});var t=i.GetParent();null!==t?t.RemoveChild(i):null!==i.GetTreeView()?i.GetTreeView().RemoveChild(i):Fit.Dom.Remove(o),i=o=a=r=l=d=u=s=c=null},this.GetDomElement=function(){return o},o=document.createElement("li"),r=document.createElement("div"),d=document.createElement("span"),i.Title(t),Fit.Dom.Data(o,"value",(n=e,Fit.Validation.ExpectString(n),encodeURIComponent(n))),Fit.Dom.Data(o,"state","static"),Fit.Dom.Data(o,"selectable","false"),Fit.Dom.Data(o,"selected","false"),Fit.Dom.Data(o,"last","false"),o.tabIndex=0,o.appendChild(r),o.appendChild(d),o._internal={Node:i,TreeView:null,TreeViewConfigOverrides:{Selectable:void 0,ShowCheckbox:void 0,ShowSelectAll:void 0}}},Fit.Controls.TreeView.Node=Fit.Controls.TreeViewNode,Fit.Controls.WSTreeView=function(t){Fit.Validation.ExpectStringValue(t),Fit.Core.Extend(this,Fit.Controls.TreeView).Apply(t);var e=this,n=null,i=null,o=null,a={},r=[],l=!0,d=Fit.Controls.WSTreeViewSelectAllMode.Progressively,u=[],s=[],c=[],F=[];this.Url=function(t){return Fit.Validation.ExpectString(t,!0),!0===Fit.Validation.IsSet(t)&&(n=t),n},this.JsonpCallback=function(t){return Fit.Validation.ExpectString(t,!0),!0!==Fit.Validation.IsSet(t)&&null!==t||(i=t),i},this.SelectAllMode=function(t){return Fit.Validation.ExpectString(t,!0),!0===Fit.Validation.IsSet(t)&&(t!==Fit.Controls.WSTreeViewSelectAllMode.Progressively&&t!==Fit.Controls.WSTreeViewSelectAllMode.Instantly||(d=t)),d},this.RemoveAllChildren=Fit.Core.CreateOverride(this.RemoveAllChildren,function(){a={},base()}),this.Selectable=Fit.Core.CreateOverride(this.Selectable,function(t,e,n){return Fit.Validation.ExpectBoolean(t,!0),Fit.Validation.ExpectBoolean(e,!0),Fit.Validation.ExpectBoolean(n,!0),a={},base(t,e,n)}),this.Clear=Fit.Core.CreateOverride(this.Clear,function(){var t=e.Selected().length>0;a={},e._internal.ExecuteWithNoOnChange(function(){base()}),!0===t&&e._internal.FireOnChange()}),this.Reload=function(t){Fit.Validation.ExpectFunction(t,!0),e.RemoveAllChildren(!0),a={},f(null,function(n,i){Fit.Array.ForEach(i.Children,function(t){e.AddChild(p(t))}),!0===Fit.Validation.IsSet(t)&&t(e)}),l=!1},this.Value=Fit.Core.CreateOverride(this.Value,function(t){if(Fit.Validation.ExpectString(t,!0),!0===Fit.Validation.IsSet(t)){r=[],a={};var n=e.Selected().length>0;e._internal.ExecuteWithNoOnChange(function(){base(t);var i=m();i.length>0&&(n=!0),Fit.Array.ForEach(i,function(t){Fit.Array.Add(r,t.Value())});var o=t.split(";");Fit.Array.ForEach(o,function(t){var i=t.split("="),o={Title:null,Value:null};1===i.length?(o.Title="[pre-selection]",o.Value=h(i[0])):(o.Title=h(i[0]),o.Value=h(i[1])),null===e.GetChild(o.Value,!0)&&(a[o.Value]=o,Fit.Array.Add(r,o.Value),n=!0)})}),!0===n&&e._internal.FireOnChange()}var i=e.Selected(),o="";return Fit.Array.ForEach(i,function(t){o+=(""!==o?";":"")+v(t.Title())+"="+v(t.Value())}),o});var m=e.Selected;function f(t,o){Fit.Validation.ExpectInstance(t,Fit.Controls.TreeViewNode,!0),Fit.Validation.ExpectFunction(o),null===n&&Fit.Validation.ThrowError("Unable to get data, no WebService URL has been specified");var r=null;r=null!==i?new Fit.Http.JsonpRequest(n,i):new Fit.Http.JsonRequest(n);var l={Sender:null,Node:null,Request:null,Children:null};if(l.Sender=e,l.Node=t,l.Request=r,l.SelectAll=null!==t&&!0===t.GetDomElement()._internal.WSSelectAll,!1===E(u,l))return!1;var d=function(n){l.Children=n instanceof Array?n:[],E(s,l),o(t,l),void 0!==r._loadingIndicator&&(Fit.Dom.Remove(r._loadingIndicator),delete r._loadingIndicator),!1===Fit.Core.IsEqual(a,{})&&e._internal.ExecuteWithNoOnChange(function(){Fit.Array.Recurse(null!==t?t.GetChildren():e.GetChildren(),"GetChildren",function(t){void 0!==a[t.Value()]&&(delete a[t.Value()],t.Selected(!0))})}),E(F,l)},m=function(e){Fit.Validation.ThrowError("Unable to get children for "+(null!==t?"node '"+t.Title()+"'":"root level")+" - request failed with HTTP Status code "+e)};if(!1===Fit.Core.InstanceOf(r,Fit.Http.JsonpRequest)?(r.OnSuccess(function(t){var e=r.GetResponseJson();d(e)}),r.OnFailure(function(t){m(r.GetHttpStatus())}),r.OnAbort(function(e){void 0!==r._loadingIndicator&&(Fit.Dom.Remove(r._loadingIndicator),delete r._loadingIndicator),null!==t&&delete t.GetDomElement()._internal.WSLoading,E(c,l)})):(r.OnSuccess(function(t){var e=t.GetResponse();d(e)}),r.OnTimeout(function(){m("UNKNOWN (JSONP)")})),null!==t){var f=t.GetDomElement();r._loadingIndicator=document.createElement("i"),Fit.Dom.AddClass(r._loadingIndicator,"FitUiControlLoadingIndicator"),Fit.Dom.Add(f,r._loadingIndicator)}return r.Start(),!0}function p(t){Fit.Validation.ExpectIsSet(t);var e=new Fit.Controls.TreeViewNode(t.Title?t.Title:t.Value,t.Value);if(void 0!==t.Selectable&&e.Selectable(!0===t.Selectable),void 0!==t.Selected&&e.Selected(!0===t.Selected),t.Children instanceof Array&&Fit.Array.ForEach(t.Children,function(t){e.AddChild(p(t))}),void 0!==t.Expanded&&e.Expanded(!0===t.Expanded),e.GetDomElement()._internal.WSHasChildren=!0===t.HasChildren,!0===t.HasChildren&&0===e.GetChildren().length){var n=new Fit.Controls.TreeViewNode("__","__");n.Selectable(!1),e.AddChild(n)}e.Supplementary={};var i=new Array("Title","Value","Children","HasChildren","Selected","Selectable","Expanded");return Fit.Array.ForEach(t,function(n){!1===Fit.Array.Contains(i,n)&&(e.Supplementary[n]=t[n])}),e}function E(t,n){var i=!1;return Fit.Array.ForEach(t,function(t){!1===t(e,n)&&(i=!0)}),!i}function h(t){return Fit.Validation.ExpectString(t),t.replace(/%3B/g,";").replace(/%3D/g,"=")}function v(t){return Fit.Validation.ExpectString(t),t.replace(/;/g,"%3B").replace(/=/g,"%3D")}this.Selected=function(t){if(Fit.Validation.ExpectArray(t,!0),!0===Fit.Validation.IsSet(t)){var n=[];Fit.Array.ForEach(t,function(t){Fit.Validation.ExpectInstance(t,Fit.Controls.TreeViewNode);var i=t.GetTreeView()===e?t:e.GetChild(t.Value(),!0);null!==i&&Fit.Array.Add(n,i)}),r=[],a={};e.Selected().length;var i=null;e._internal.ExecuteWithNoOnChange(function(){i=m(n)}),i.length>0&&!0,Fit.Array.ForEach(i,function(t){Fit.Array.Add(r,t.Value())}),Fit.Array.ForEach(t,function(t){null===e.GetChild(t.Value(),!0)&&(a[t.Value()]={Title:t.Title(),Value:t.Value()},Fit.Array.Add(r,t.Value()),!0)})}var o=m();return Fit.Array.ForEach(a,function(t){var e=a[t];Fit.Array.Add(o,new Fit.Controls.TreeViewNode(e.Title,e.Value))}),o},this.IsDirty=Fit.Core.CreateOverride(this.IsDirty,function(){var t=[];if(Fit.Array.ForEach(e.Selected(),function(e){Fit.Array.Add(t,e.Value())}),t.length!==r.length)return!0;var n=!1;return Fit.Array.ForEach(r,function(e){if(!1===Fit.Array.Contains(t,e))return n=!0,!1}),n}),this.Dispose=Fit.Core.CreateOverride(this.Dispose,function(){e=n=i=a=r=l=u=s=F=baseRender=m=null,base()}),this.SetSelections=Fit.Core.CreateOverride(this.SetSelections,function(t){Fit.Validation.ExpectArray(t);var n=e.Selected().length>0;a={},e._internal.ExecuteWithNoOnChange(function(){base(t)}),e.Selected().length>0&&(n=!0),Fit.Array.ForEach(t,function(t){Fit.Validation.ExpectString(t.Title),Fit.Validation.ExpectString(t.Value),a[t.Value]={Title:t.Title,Value:t.Value}}),Fit.Array.ForEach(m(),function(t){delete a[t.Value()]}),!1===Fit.Core.IsEqual(a,{})&&(n=!0),!0===n&&e._internal.FireOnChange()}),this.UpdateItemSelection=Fit.Core.CreateOverride(this.UpdateItemSelection,function(t,n){if(Fit.Validation.ExpectString(t),Fit.Validation.ExpectBoolean(n),null===e.GetChild(t,!0))!0===n&&void 0===a[t]?(a[t]={Title:"[pre-selection]",Value:t},e._internal.FireOnChange()):!1===n&&void 0!==a[t]&&(delete a[t],e._internal.FireOnChange());else if(!1===base(t,n))return!1}),this.OnRequest=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(u,t)},this.OnResponse=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(s,t)},this.OnAbort=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(c,t)},this.OnPopulated=function(t){Fit.Validation.ExpectFunction(t),Fit.Array.Add(F,t)},function(){(o=e.GetDomElement().firstChild.firstChild._internal.Node).GetDomElement()._internal.WSHasChildren=!0;var t=-1;t=Fit.Events.AddHandler(e.GetDomElement(),"#rooted",function(n){if(!0===l){var i=e.Selected();e.Reload(),e.Selected(i)}Fit.Events.RemoveHandler(e.GetDomElement(),t)}),e.OnToggle(function(t,e){if(!0!==e.Expanded()&&!0!==e.GetDomElement()._internal.WSDone){if(!0===e.GetDomElement()._internal.WSLoading)return!1;if(!1!==e.GetDomElement()._internal.WSHasChildren)return e.GetDomElement()._internal.WSLoading=!0,f(e,function(t,n){var i=e.GetChild("__");null!==i&&e.RemoveChild(i),Fit.Array.ForEach(n.Children,function(t){e.AddChild(p(t))}),e.GetDomElement()._internal.WSDone=!0,e.Expanded(!0)}),!1}}),e.OnSelectAll(function(t,n){if(d===Fit.Controls.WSTreeViewSelectAllMode.Progressively){var i=null!==n.Node?n.Node:o;if(i.GetDomElement()._internal.WSSelectAll=!0,i.GetDomElement()._internal.WSCheckedState=n.Selected,!0===l)return setTimeout(function(){var t=e.Selected();e.Reload(),e.Selected(t)},0),!1;Fit.Array.Recurse(i.GetChildren(),"GetChildren",function(t){var e=t.GetDomElement()._internal;!0===e.WSHasChildren&&!0!==e.WSDone&&(e.WSSelectAll=!0,e.WSCheckedState=n.Selected)})}}),e.OnPopulated(function(t,n){if(d===Fit.Controls.WSTreeViewSelectAllMode.Progressively){var i=null!==n.Node?n.Node:o,a=i.GetDomElement()._internal.WSCheckedState;if(!0===i.GetDomElement()._internal.WSSelectAll){var r=!1;e._internal.ExecuteWithNoOnChange(function(){Fit.Array.Recurse(i.GetChildren(),"GetChildren",function(t){var e=t.GetDomElement()._internal;!0===e.WSHasChildren&&!0!==e.WSDone&&(e.WSSelectAll=!0,e.WSCheckedState=a),!0===t.Selectable()&&t.Selected()!==a&&(t.Selected(a),r=!0),t.Expanded(!0)})}),!0===r&&e._internal.FireOnChange()}}}),e.OnSelectAll(function(t,n){if(d===Fit.Controls.WSTreeViewSelectAllMode.Instantly){var i=null!==n.Node?n.Node:o,a=i.GetDomElement()._internal;if(!0!==function(t){if(!0===t.GetDomElement()._internal.WSSelectAll)return!0;for(var e=t.GetParent();null!==e;){if(!0===e.GetDomElement()._internal.WSSelectAll)return!0;e=e.GetParent()}var n=!0;return Fit.Array.Recurse([t],"GetChildren",function(t){var e=t.GetDomElement()._internal;if(!0===e.WSHasChildren&&!0!==e.WSDone)return n=!1,!1}),n}(i))return a.WSSelectAll=!0,a.WSCheckedState=n.Selected,i===o?setTimeout(function(){var t=e.Selected();e.Reload(),e.Selected(t)},0):(delete a.WSDone,delete a.WSLoading,i.Expanded(!1),setTimeout(function(){i.Expanded(!0)},0)),!1}}),e.OnResponse(function(t,n){if(d===Fit.Controls.WSTreeViewSelectAllMode.Instantly){var i=null!==n.Node?n.Node:o;i.GetDomElement()._internal.WSCheckedState,!0===i.GetDomElement()._internal.WSSelectAll&&e._internal.ExecuteWithNoOnChange(function(){Fit.Array.Recurse(i.GetChildren(),"GetChildren",function(t){t.Selected(!1)}),Fit.Array.ForEach(i.GetChildren(),function(t){i.RemoveChild(t)})})}}),e.OnPopulated(function(t,n){if(d===Fit.Controls.WSTreeViewSelectAllMode.Instantly){var i=null!==n.Node?n.Node:o,a=i.GetDomElement()._internal.WSCheckedState;if(!0===i.GetDomElement()._internal.WSSelectAll){var r=!1;e._internal.ExecuteWithNoOnChange(function(){i!==o&&!0===i.Selectable()&&i.Selected()!==a&&(i.Selected(a),r=!0),Fit.Array.Recurse(i.GetChildren(),"GetChildren",function(t){var e=t.GetDomElement()._internal;!0===e.WSHasChildren&&!0!==e.WSDone&&(Fit.Browser.Log("NOTICE: WebService did not provide all data in one single HTTP request - an additional request is required to load data for node with value '"+t.Value()+"'"),e.WSSelectAll=!0,e.WSCheckedState=a),!0===t.Selectable()&&t.Selected()!==a&&(t.Selected(a),r=!0),t.Expanded(!0)})}),!0===r&&e._internal.FireOnChange()}}})}()},Fit.Controls.WSTreeViewSelectAllMode={Progressively:"Progressively",Instantly:"Instantly"},Fit.Controls.WSTreeView.SelectAllMode=Fit.Controls.WSTreeViewSelectAllMode,Fit}();return fitInstance});